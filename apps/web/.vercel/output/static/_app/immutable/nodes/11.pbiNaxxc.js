const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["../chunks/DhSYb-d6.js","../chunks/Cpj98o6Y.js","../chunks/CDUSxSYR.js","../chunks/CKx7fsl1.js","../chunks/BMDA9hg8.js","../chunks/BhPu-S6K.js","../chunks/Dyjw1x4N.js"])))=>i.map(i=>d[i]);
import{V as ue,X as me,Y as fe,_ as W,s as l,W as d,b as e,x as _e,a0 as s,Z as i,$ as ge,a1 as r,a2 as C}from"../chunks/cnc2SBSL.js";import{f as b,a as m,e as be,s as X,t as J}from"../chunks/Caf-0pf-.js";import{i as Z,b as we}from"../chunks/Coh7MiEg.js";import{h as he,e as Q,i as ee}from"../chunks/ClOXSIRR.js";import{r as N}from"../chunks/L9orpk0O.js";import{b as U}from"../chunks/_dvcZOuR.js";import{b as te}from"../chunks/OTSxomT-.js";import{g as ye}from"../chunks/BJEHMrWO.js";import{M as xe,I as Se}from"../chunks/BhPu-S6K.js";import{h as Ae}from"../chunks/Dyjw1x4N.js";var Ee=b('<div class="upgrade-notice svelte-1wnp16c"><h2 class="svelte-1wnp16c">Upgrade Required</h2> <p class="svelte-1wnp16c">Creating songs requires a Basic subscription or higher.</p> <a href="/account" class="btn btn-primary">View Plans</a></div>'),Te=b('<div class="error-message svelte-1wnp16c"> </div>'),ke=b("<option> </option>"),Re=b("<option> </option>"),De=b('<form class="song-form svelte-1wnp16c"><!> <div class="form-group svelte-1wnp16c"><label for="title" class="svelte-1wnp16c">Title *</label> <input type="text" id="title" placeholder="Enter song title" required class="svelte-1wnp16c"/></div> <div class="form-group svelte-1wnp16c"><label for="artist" class="svelte-1wnp16c">Artist</label> <input type="text" id="artist" placeholder="Enter artist name" class="svelte-1wnp16c"/></div> <div class="form-row svelte-1wnp16c"><div class="form-group svelte-1wnp16c"><label for="key" class="svelte-1wnp16c">Key</label> <select id="key" class="svelte-1wnp16c"><option>Select key</option><!></select></div> <div class="form-group svelte-1wnp16c"><label for="tempo" class="svelte-1wnp16c">Tempo (BPM)</label> <input type="number" id="tempo" placeholder="120" min="20" max="300" class="svelte-1wnp16c"/></div></div> <div class="form-group svelte-1wnp16c"><label for="instrument" class="svelte-1wnp16c">Primary Instrument</label> <select id="instrument" class="svelte-1wnp16c"></select></div> <div class="form-group svelte-1wnp16c"><label for="tags" class="svelte-1wnp16c">Tags</label> <input type="text" id="tags" placeholder="rock, classic, favorite (comma-separated)" class="svelte-1wnp16c"/></div> <div class="form-actions svelte-1wnp16c"><a href="/songs" class="btn btn-secondary">Cancel</a> <button type="submit" class="btn btn-primary svelte-1wnp16c"><!></button></div></form>'),Ie=b('<main class="container"><header class="page-header svelte-1wnp16c"><div class="header-left svelte-1wnp16c"><a href="/songs" class="back-link svelte-1wnp16c">‚Üê Back to Songs</a> <h1>New Song</h1></div></header> <!></main>');function $e(ae,se){ue(se,!0);let R=d(""),L=d(""),V=d(""),D=d(""),q=d("guitar"),M=d(""),v=d(!1),w=d(null),B=d(null),j=d(!1),z=!1;me(()=>{!we||z||(z=!0,re())});async function re(){const{getDatabase:c}=await W(async()=>{const{getDatabase:h}=await import("../chunks/DhSYb-d6.js");return{getDatabase:h}},__vite__mapDeps([0,1,2,3]),import.meta.url),f=await c().users.toArray();f.length>0&&(l(B,f[0],!0),l(j,Ae(e(B),"create_songs"),!0))}async function ie(c){if(c.preventDefault(),!e(R).trim()){l(w,"Title is required");return}l(v,!0),l(w,null);try{const{createSong:o,createArrangement:f}=await W(async()=>{const{createSong:u,createArrangement:g}=await import("../chunks/BMDA9hg8.js");return{createSong:u,createArrangement:g}},__vite__mapDeps([4,5,2,3,6]),import.meta.url),{SongRepository:h,ArrangementRepository:y,getDatabase:x}=await W(async()=>{const{SongRepository:u,ArrangementRepository:g,getDatabase:T}=await import("../chunks/DhSYb-d6.js");return{SongRepository:u,ArrangementRepository:g,getDatabase:T}},__vite__mapDeps([0,1,2,3]),import.meta.url),_=await x().users.toArray();if(_.length===0)throw new Error("No user found");const S=_[0].id,A=e(M).split(",").map(u=>u.trim()).filter(u=>u.length>0),p=o(S,e(R).trim(),{artist:e(L).trim()||void 0,key:e(V)||void 0,tempo:e(D)?Number(e(D)):void 0,tags:A,visibility:"private"}),E=f(p.id,e(q),{content:`{title: ${p.title}}
{artist: ${p.artist||"Unknown"}}

`});await h.create(p),await y.create(E),ye(`/songs/${p.id}`)}catch(o){console.error("Failed to create song:",o),l(w,o instanceof Error?o.message:"Failed to create song",!0),l(v,!1)}}var O=Ie();he("1wnp16c",c=>{_e(()=>{ge.title="New Song - Gigwidget"})});var oe=s(i(O),2);{var ne=c=>{var o=Ee();m(c,o)},le=c=>{var o=De(),f=i(o);{var h=t=>{var a=Te(),n=i(a,!0);r(a),C(()=>X(n,e(w))),m(t,a)};Z(f,t=>{e(w)&&t(h)})}var y=s(f,2),x=s(i(y),2);N(x),r(y);var I=s(y,2),_=s(i(I),2);N(_),r(I);var S=s(I,2),A=i(S),p=s(i(A),2),E=i(p);E.value=E.__value="";var u=s(E);Q(u,17,()=>xe,ee,(t,a)=>{var n=ke(),G=i(n,!0);r(n);var k={};C(()=>{X(G,e(a)),k!==(k=e(a))&&(n.value=(n.__value=e(a))??"")}),m(t,n)}),r(p),r(A);var g=s(A,2),T=s(i(g),2);N(T),r(g),r(S);var $=s(S,2),P=s(i($),2);Q(P,21,()=>Se,ee,(t,a)=>{var n=Re(),G=i(n,!0);r(n);var k={};C(de=>{X(G,de),k!==(k=e(a))&&(n.value=(n.__value=e(a))??"")},[()=>e(a).charAt(0).toUpperCase()+e(a).slice(1)]),m(t,n)}),r(P),r($);var F=s($,2),K=s(i(F),2);N(K),r(F);var H=s(F,2),Y=s(i(H),2),ce=i(Y);{var ve=t=>{var a=J("Creating...");m(t,a)},pe=t=>{var a=J("Create Song");m(t,a)};Z(ce,t=>{e(v)?t(ve):t(pe,!1)})}r(Y),r(H),r(o),C(()=>{x.disabled=e(v),_.disabled=e(v),p.disabled=e(v),T.disabled=e(v),P.disabled=e(v),K.disabled=e(v),Y.disabled=e(v)}),be("submit",o,ie),U(x,()=>e(R),t=>l(R,t)),U(_,()=>e(L),t=>l(L,t)),te(p,()=>e(V),t=>l(V,t)),U(T,()=>e(D),t=>l(D,t)),te(P,()=>e(q),t=>l(q,t)),U(K,()=>e(M),t=>l(M,t)),m(c,o)};Z(oe,c=>{!e(j)&&e(B)?c(ne):c(le,!1)})}r(O),m(ae,O),fe()}export{$e as component};
//# sourceMappingURL=11.pbiNaxxc.js.map
