import{D as i,Y as y,e as D,b as h,m as w}from"./CKx7fsl1.js";function T(e){return new i({guid:`song-${e}`})}const N={getMetadata(e){return e.getMap("metadata")},getArrangements(e){return e.getArray("arrangements")},getContents(e){return e.getMap("contents")},getArrangementContent(e,t){const n=this.getContents(e);let r=n.get(t);return r||(r=new y,n.set(t,r)),r},getTags(e){return e.getArray("tags")}};function G(e){return new i({guid:`library-${e}`})}const P={getSongs(e){return e.getMap("songs")},getSpaces(e){return e.getArray("spaces")},getSyncState(e){return e.getMap("syncState")}};function _(e){return new i({guid:`space-${e}`})}const B={getMetadata(e){return e.getMap("metadata")},getMembers(e){return e.getMap("members")},getSongIds(e){return e.getArray("songIds")},getSettings(e){return e.getMap("settings")}};function L(e){return new i({guid:`session-${e}`})}const V={getMetadata(e){return e.getMap("metadata")},getParticipants(e){return e.getMap("participants")},getSharedSongIds(e){return e.getArray("sharedSongIds")},getPresence(e){return e.getMap("presence")}};function u(e){let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t=(t<<5)-t+r,t=t&t}return t.toString(16)}function k(e){return D(e)}function O(e,t,n){h(e,t,n)}function F(e,t){return w([e,t])}const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function I(e,t=0){return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}let d;const U=new Uint8Array(16);function C(){if(!d){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");d=crypto.getRandomValues.bind(crypto)}return d(U)}const M=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),p={randomUUID:M};function m(e,t,n){if(p.randomUUID&&!e)return p.randomUUID();e=e||{};const r=e.random??e.rng?.()??C();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=r[6]&15|64,r[8]=r[8]&63|128,I(r)}function c(){return m()}function x(){return`local-${m()}`}function j(e){return{id:x(),displayName:e??`User ${Math.random().toString(36).substring(2,6)}`,instruments:[],subscriptionTier:"free",createdAt:new Date}}function q(e,t){return{...e,supabaseId:t,id:e.id}}function z(e,t,n){const r=c();return{id:r,ownerId:e,title:t,artist:n?.artist,key:n?.key,tempo:n?.tempo,timeSignature:n?.timeSignature,tags:n?.tags??[],visibility:n?.visibility??"private",spaceIds:[],createdAt:new Date,updatedAt:new Date,yjsDocId:`song-${r}`}}function Y(e,t,n){const r=n?.content??"";return{id:c(),songId:e,instrument:t,tuning:n?.tuning,capo:n?.capo,content:r,version:1,baseVersionHash:u(r),createdAt:new Date,updatedAt:new Date}}const l=10;function K(e,t){return{id:c(),songId:e.songId,arrangementId:e.id,content:e.content,versionHash:u(e.content),createdAt:new Date,note:t}}function X(e){return e.length<=l?e:e.sort((t,n)=>n.createdAt.getTime()-t.createdAt.getTime()).slice(0,l)}function J(e,t){const n=u(t.content);return e.baseVersionHash===n||u(e.content)===e.baseVersionHash?null:{id:c(),songId:e.songId,arrangementId:e.id,localContent:e.content,remoteContent:t.content,localUpdatedAt:e.updatedAt,remoteUpdatedAt:t.updatedAt,remoteUserId:t.userId,remoteUserName:t.userName,detectedAt:new Date,resolved:!1}}function Q(e,t){return{...e,resolved:!0,resolution:t}}function W(e,t,n,r){const s=c();return{id:s,name:t,description:r?.description,type:n,ownerId:e,cloudEnabled:r?.cloudEnabled??!1,yjsDocId:`space-${s}`,createdAt:new Date,updatedAt:new Date}}function Z(e,t,n){const r=Date.now(),s=n?.expiresInMs?new Date(r+n.expiresInMs):void 0,o=c(),S=$(t,o);return{id:o,hostId:e,type:t,connectionInfo:S,libraryScope:n?.libraryScope??"full",selectedSongIds:n?.selectedSongIds,createdAt:new Date(r),expiresAt:s}}function $(e,t){switch(e){case"webrtc":return{type:"webrtc",signalingServer:"",roomId:t,password:void 0};case"bluetooth":return{type:"bluetooth",serviceUUID:"",characteristicUUID:"",deviceName:""};case"local-network":return{type:"local-network",addresses:[],port:0,token:c()}}}function ee(e){return e.expiresAt?new Date>e.expiresAt:!1}const b=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],v={Db:"C#",Eb:"D#",Fb:"E",Gb:"F#",Ab:"G#",Bb:"A#",Cb:"B"},A={"C#":"Db","D#":"Eb","F#":"Gb","G#":"Ab","A#":"Bb"};function E(e){const t=e.match(/^([A-G][#b]?)([^/]*)?(?:\/([A-G][#b]?))?$/);return t?{root:t[1],quality:t[2]||"",bass:t[3]}:null}function g(e){const t=v[e]??e,n=b.indexOf(t);return n>=0?n:-1}function f(e,t,n=!1){const r=g(e);if(r<0)return e;const s=((r+t)%12+12)%12,o=b[s];return n&&A[o]?A[o]:o}function R(e,t,n=!1){const r=E(e);if(!r)return e;const s=f(r.root,t,n),o=r.bass?f(r.bass,t,n):void 0;return s+r.quality+(o?`/${o}`:"")}function te(e,t){const n=e.replace(/m$/,""),r=t.replace(/m$/,""),s=g(n),o=g(r);return s<0||o<0?0:((o-s)%12+12)%12}function ne(e,t,n=!1){return t===0?e:e.replace(/\[([^\]]+)\]/g,(r,s)=>`[${R(s,t,n)}]`)}function re(e){return e===0?"Original":`${e>0?"+":""}${e} semitone${Math.abs(e)!==1?"s":""}`}export{R as A,te as B,ne as C,re as D,P as L,N as S,G as a,_ as b,T as c,B as d,L as e,V as f,u as g,k as h,O as i,c as j,x as k,j as l,F as m,z as n,Y as o,K as p,X as q,J as r,Q as s,W as t,q as u,Z as v,ee as w,E as x,g as y,f as z};
//# sourceMappingURL=CDUSxSYR.js.map
