import{c as ha,g as da}from"./Cpj98o6Y.js";import{l as pa,t as va,j as ya}from"./CDUSxSYR.js";var jt={exports:{}},ma=jt.exports,Pr;function ga(){return Pr||(Pr=1,(function(x,C){(function(L,J){x.exports=J()})(ma,(function(){/*! *****************************************************************************
Copyright (c) Microsoft Corporation.
Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.
THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var L=function(e,t){return L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},L(e,t)};function J(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");L(e,t);function n(){this.constructor=e}e.prototype=t===null?Object.create(t):(n.prototype=t.prototype,new n)}var T=function(){return T=Object.assign||function(t){for(var n,r=1,i=arguments.length;r<i;r++){n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t},T.apply(this,arguments)};function de(e,t,n){for(var r=0,i=t.length,a;r<i;r++)(a||!(r in t))&&(a||(a=Array.prototype.slice.call(t,0,r)),a[r]=t[r]);return e.concat(a||Array.prototype.slice.call(t))}var $=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:ha,Q=Object.keys,W=Array.isArray;typeof Promise<"u"&&!$.Promise&&($.Promise=Promise);function te(e,t){return typeof t!="object"||Q(t).forEach(function(n){e[n]=t[n]}),e}var Be=Object.getPrototypeOf,Dr={}.hasOwnProperty;function Z(e,t){return Dr.call(e,t)}function Me(e,t){typeof t=="function"&&(t=t(Be(e))),(typeof Reflect>"u"?Q:Reflect.ownKeys)(t).forEach(function(n){pe(e,n,t[n])})}var Tn=Object.defineProperty;function pe(e,t,n,r){Tn(e,t,te(n&&Z(n,"get")&&typeof n.get=="function"?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Fe(e){return{from:function(t){return e.prototype=Object.create(t.prototype),pe(e.prototype,"constructor",e),{extend:Me.bind(null,e.prototype)}}}}var Or=Object.getOwnPropertyDescriptor;function Rn(e,t){var n=Or(e,t),r;return n||(r=Be(e))&&Rn(r,t)}var Cr=[].slice;function ct(e,t,n){return Cr.call(e,t,n)}function Bn(e,t){return t(e)}function Qe(e){if(!e)throw new Error("Assertion Failed")}function Mn(e){$.setImmediate?setImmediate(e):setTimeout(e,0)}function Tr(e,t){return e.reduce(function(n,r,i){var a=t(r,i);return a&&(n[a[0]]=a[1]),n},{})}function ce(e,t){if(typeof t=="string"&&Z(e,t))return e[t];if(!t)return e;if(typeof t!="string"){for(var n=[],r=0,i=t.length;r<i;++r){var a=ce(e,t[r]);n.push(a)}return n}var u=t.indexOf(".");if(u!==-1){var o=e[t.substr(0,u)];return o==null?void 0:ce(o,t.substr(u+1))}}function q(e,t,n){if(!(!e||t===void 0)&&!("isFrozen"in Object&&Object.isFrozen(e)))if(typeof t!="string"&&"length"in t){Qe(typeof n!="string"&&"length"in n);for(var r=0,i=t.length;r<i;++r)q(e,t[r],n[r])}else{var a=t.indexOf(".");if(a!==-1){var u=t.substr(0,a),o=t.substr(a+1);if(o==="")n===void 0?W(e)&&!isNaN(parseInt(u))?e.splice(u,1):delete e[u]:e[u]=n;else{var s=e[u];(!s||!Z(e,u))&&(s=e[u]={}),q(s,o,n)}}else n===void 0?W(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function Rr(e,t){typeof t=="string"?q(e,t,void 0):"length"in t&&[].map.call(t,function(n){q(e,n,void 0)})}function Fn(e){var t={};for(var n in e)Z(e,n)&&(t[n]=e[n]);return t}var Br=[].concat;function jn(e){return Br.apply([],e)}var Mr="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(jn([8,16,32,64].map(function(e){return["Int","Uint","Float"].map(function(t){return t+e+"Array"})}))).filter(function(e){return $[e]}),Ln=new Set(Mr.map(function(e){return $[e]}));function Nn(e){var t={};for(var n in e)if(Z(e,n)){var r=e[n];t[n]=!r||typeof r!="object"||Ln.has(r.constructor)?r:Nn(r)}return t}function Fr(e){for(var t in e)if(Z(e,t))return!1;return!0}var He=null;function Se(e){He=new WeakMap;var t=Nt(e);return He=null,t}function Nt(e){if(!e||typeof e!="object")return e;var t=He.get(e);if(t)return t;if(W(e)){t=[],He.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(Nt(e[n]))}else if(Ln.has(e.constructor))t=e;else{var i=Be(e);t=i===Object.prototype?{}:Object.create(i),He.set(e,t);for(var a in e)Z(e,a)&&(t[a]=Nt(e[a]))}return t}var jr={}.toString;function Vt(e){return jr.call(e).slice(8,-1)}var zt=typeof Symbol<"u"?Symbol.iterator:"@@iterator",Lr=typeof zt=="symbol"?function(e){var t;return e!=null&&(t=e[zt])&&t.apply(e)}:function(){return null};function Ee(e,t){var n=e.indexOf(t);return n>=0&&e.splice(n,1),n>=0}var je={};function le(e){var t,n,r,i;if(arguments.length===1){if(W(e))return e.slice();if(this===je&&typeof e=="string")return[e];if(i=Lr(e)){for(n=[];r=i.next(),!r.done;)n.push(r.value);return n}if(e==null)return[e];if(t=e.length,typeof t=="number"){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var Wt=typeof Symbol<"u"?function(e){return e[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},Nr=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"],Vn=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Ut=Nr.concat(Vn),Vr={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Le(e,t){this.name=e,this.message=t}Fe(Le).from(Error).extend({toString:function(){return this.name+": "+this.message}});function zn(e,t){return e+". Errors: "+Object.keys(t).map(function(n){return t[n].toString()}).filter(function(n,r,i){return i.indexOf(n)===r}).join(`
`)}function lt(e,t,n,r){this.failures=t,this.failedKeys=r,this.successCount=n,this.message=zn(e,t)}Fe(lt).from(Le);function Ne(e,t){this.name="BulkError",this.failures=Object.keys(t).map(function(n){return t[n]}),this.failuresByPos=t,this.message=zn(e,this.failures)}Fe(Ne).from(Le);var Yt=Ut.reduce(function(e,t){return e[t]=t+"Error",e},{}),zr=Le,D=Ut.reduce(function(e,t){var n=t+"Error";function r(i,a){this.name=n,i?typeof i=="string"?(this.message="".concat(i).concat(a?`
 `+a:""),this.inner=a||null):typeof i=="object"&&(this.message="".concat(i.name," ").concat(i.message),this.inner=i):(this.message=Vr[t]||n,this.inner=null)}return Fe(r).from(zr),e[t]=r,e},{});D.Syntax=SyntaxError,D.Type=TypeError,D.Range=RangeError;var Wn=Vn.reduce(function(e,t){return e[t+"Error"]=D[t],e},{});function Wr(e,t){if(!e||e instanceof Le||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Wn[e.name])return e;var n=new Wn[e.name](t||e.message,e);return"stack"in e&&pe(n,"stack",{get:function(){return this.inner.stack}}),n}var ft=Ut.reduce(function(e,t){return["Syntax","Type","Range"].indexOf(t)===-1&&(e[t+"Error"]=D[t]),e},{});ft.ModifyError=lt,ft.DexieError=Le,ft.BulkError=Ne;function V(){}function Ge(e){return e}function Ur(e,t){return e==null||e===Ge?t:function(n){return t(e(n))}}function Ae(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Yr(e,t){return e===V?t:function(){var n=e.apply(this,arguments);n!==void 0&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Ae(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Ae(i,this.onerror):i),a!==void 0?a:n}}function $r(e,t){return e===V?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Ae(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Ae(r,this.onerror):r)}}function Qr(e,t){return e===V?t:function(n){var r=e.apply(this,arguments);te(n,r);var i=this.onsuccess,a=this.onerror;this.onsuccess=null,this.onerror=null;var u=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Ae(i,this.onsuccess):i),a&&(this.onerror=this.onerror?Ae(a,this.onerror):a),r===void 0?u===void 0?void 0:u:te(r,u)}}function Hr(e,t){return e===V?t:function(){return t.apply(this,arguments)===!1?!1:e.apply(this,arguments)}}function $t(e,t){return e===V?t:function(){var n=e.apply(this,arguments);if(n&&typeof n.then=="function"){for(var r=this,i=arguments.length,a=new Array(i);i--;)a[i]=arguments[i];return n.then(function(){return t.apply(r,a)})}return t.apply(this,arguments)}}var ae=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Un(e,t){ae=e}var Xe={},Yn=100,Qt=typeof Promise>"u"?[]:(function(){var e=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[e,Be(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Be(t),e]})(),$n=Qt[0],Qn=Qt[1],Gr=Qt[2],Xr=Qn&&Qn.then,Ke=$n&&$n.constructor,Ht=!!Gr;function Jr(){queueMicrotask(qr)}var Je=function(e,t){Ze.push([e,t]),ht&&(Jr(),ht=!1)},Gt=!0,ht=!0,Pe=[],dt=[],Xt=Ge,ve={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:V,pgp:!1,env:{},finalize:V},P=ve,Ze=[],ke=0,pt=[];function E(e){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var t=this._PSD=P;if(typeof e!="function"){if(e!==Xe)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Zt(this,this._value);return}this._state=null,this._value=null,++t.ref,Gn(this,e)}var Jt={get:function(){var e=P,t=gt;function n(r,i){var a=this,u=!e.global&&(e!==P||t!==gt),o=u&&!me(),s=new E(function(c,h){qt(a,new Hn(Zn(r,e,u,o),Zn(i,e,u,o),c,h,e))});return this._consoleTask&&(s._consoleTask=this._consoleTask),s}return n.prototype=Xe,n},set:function(e){pe(this,"then",e&&e.prototype===Xe?Jt:{get:function(){return e},set:Jt.set})}};Me(E.prototype,{then:Jt,_then:function(e,t){qt(this,new Hn(null,null,e,t,P))},catch:function(e){if(arguments.length===1)return this.then(null,e);var t=arguments[0],n=arguments[1];return typeof t=="function"?this.then(null,function(r){return r instanceof t?n(r):vt(r)}):this.then(null,function(r){return r&&r.name===t?n(r):vt(r)})},finally:function(e){return this.then(function(t){return E.resolve(e()).then(function(){return t})},function(t){return E.resolve(e()).then(function(){return vt(t)})})},timeout:function(e,t){var n=this;return e<1/0?new E(function(r,i){var a=setTimeout(function(){return i(new D.Timeout(t))},e);n.then(r,i).finally(clearTimeout.bind(null,a))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&pe(E.prototype,Symbol.toStringTag,"Dexie.Promise"),ve.env=Jn();function Hn(e,t,n,r,i){this.onFulfilled=typeof e=="function"?e:null,this.onRejected=typeof t=="function"?t:null,this.resolve=n,this.reject=r,this.psd=i}Me(E,{all:function(){var e=le.apply(null,arguments).map(bt);return new E(function(t,n){e.length===0&&t([]);var r=e.length;e.forEach(function(i,a){return E.resolve(i).then(function(u){e[a]=u,--r||t(e)},n)})})},resolve:function(e){if(e instanceof E)return e;if(e&&typeof e.then=="function")return new E(function(n,r){e.then(n,r)});var t=new E(Xe,!0,e);return t},reject:vt,race:function(){var e=le.apply(null,arguments).map(bt);return new E(function(t,n){e.map(function(r){return E.resolve(r).then(t,n)})})},PSD:{get:function(){return P},set:function(e){return P=e}},totalEchoes:{get:function(){return gt}},newPSD:ye,usePSD:De,scheduler:{get:function(){return Je},set:function(e){Je=e}},rejectionMapper:{get:function(){return Xt},set:function(e){Xt=e}},follow:function(e,t){return new E(function(n,r){return ye(function(i,a){var u=P;u.unhandleds=[],u.onunhandled=a,u.finalize=Ae(function(){var o=this;ei(function(){o.unhandleds.length===0?i():a(o.unhandleds[0])})},u.finalize),e()},t,n,r)})}}),Ke&&(Ke.allSettled&&pe(E,"allSettled",function(){var e=le.apply(null,arguments).map(bt);return new E(function(t){e.length===0&&t([]);var n=e.length,r=new Array(n);e.forEach(function(i,a){return E.resolve(i).then(function(u){return r[a]={status:"fulfilled",value:u}},function(u){return r[a]={status:"rejected",reason:u}}).then(function(){return--n||t(r)})})})}),Ke.any&&typeof AggregateError<"u"&&pe(E,"any",function(){var e=le.apply(null,arguments).map(bt);return new E(function(t,n){e.length===0&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach(function(a,u){return E.resolve(a).then(function(o){return t(o)},function(o){i[u]=o,--r||n(new AggregateError(i))})})})}),Ke.withResolvers&&(E.withResolvers=Ke.withResolvers));function Gn(e,t){try{t(function(n){if(e._state===null){if(n===e)throw new TypeError("A promise cannot be resolved with itself.");var r=e._lib&&Ve();n&&typeof n.then=="function"?Gn(e,function(i,a){n instanceof E?n._then(i,a):n.then(i,a)}):(e._state=!0,e._value=n,Xn(e)),r&&ze()}},Zt.bind(null,e))}catch(n){Zt(e,n)}}function Zt(e,t){if(dt.push(t),e._state===null){var n=e._lib&&Ve();t=Xt(t),e._state=!1,e._value=t,ti(e),Xn(e),n&&ze()}}function Xn(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)qt(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),ke===0&&(++ke,Je(function(){--ke===0&&en()},[]))}function qt(e,t){if(e._state===null){e._listeners.push(t);return}var n=e._state?t.onFulfilled:t.onRejected;if(n===null)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++ke,Je(Zr,[n,e,t])}function Zr(e,t,n){try{var r,i=t._value;!t._state&&dt.length&&(dt=[]),r=ae&&t._consoleTask?t._consoleTask.run(function(){return e(i)}):e(i),!t._state&&dt.indexOf(i)===-1&&ni(t),n.resolve(r)}catch(a){n.reject(a)}finally{--ke===0&&en(),--n.psd.ref||n.psd.finalize()}}function qr(){De(ve,function(){Ve()&&ze()})}function Ve(){var e=Gt;return Gt=!1,ht=!1,e}function ze(){var e,t,n;do for(;Ze.length>0;)for(e=Ze,Ze=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}while(Ze.length>0);Gt=!0,ht=!0}function en(){var e=Pe;Pe=[],e.forEach(function(r){r._PSD.onunhandled.call(null,r._value,r)});for(var t=pt.slice(0),n=t.length;n;)t[--n]()}function ei(e){function t(){e(),pt.splice(pt.indexOf(t),1)}pt.push(t),++ke,Je(function(){--ke===0&&en()},[])}function ti(e){Pe.some(function(t){return t._value===e._value})||Pe.push(e)}function ni(e){for(var t=Pe.length;t;)if(Pe[--t]._value===e._value){Pe.splice(t,1);return}}function vt(e){return new E(Xe,!1,e)}function z(e,t){var n=P;return function(){var r=Ve(),i=P;try{return ge(n,!0),e.apply(this,arguments)}catch(a){t&&t(a)}finally{ge(i,!1),r&&ze()}}}var H={awaits:0,echoes:0,id:0},ri=0,yt=[],mt=0,gt=0,ii=0;function ye(e,t,n,r){var i=P,a=Object.create(i);a.parent=i,a.ref=0,a.global=!1,a.id=++ii,ve.env,a.env=Ht?{Promise:E,PromiseProp:{value:E,configurable:!0,writable:!0},all:E.all,race:E.race,allSettled:E.allSettled,any:E.any,resolve:E.resolve,reject:E.reject}:{},t&&te(a,t),++i.ref,a.finalize=function(){--this.parent.ref||this.parent.finalize()};var u=De(a,e,n,r);return a.ref===0&&a.finalize(),u}function We(){return H.id||(H.id=++ri),++H.awaits,H.echoes+=Yn,H.id}function me(){return H.awaits?(--H.awaits===0&&(H.id=0),H.echoes=H.awaits*Yn,!0):!1}(""+Xr).indexOf("[native code]")===-1&&(We=me=V);function bt(e){return H.echoes&&e&&e.constructor===Ke?(We(),e.then(function(t){return me(),t},function(t){return me(),Y(t)})):e}function ai(e){++gt,(!H.echoes||--H.echoes===0)&&(H.echoes=H.awaits=H.id=0),yt.push(P),ge(e,!0)}function ui(){var e=yt[yt.length-1];yt.pop(),ge(e,!1)}function ge(e,t){var n=P;if((t?H.echoes&&(!mt++||e!==P):mt&&(!--mt||e!==P))&&queueMicrotask(t?ai.bind(null,e):ui),e!==P&&(P=e,n===ve&&(ve.env=Jn()),Ht)){var r=ve.env.Promise,i=e.env;(n.global||e.global)&&(Object.defineProperty($,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function Jn(){var e=$.Promise;return Ht?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor($,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject}:{}}function De(e,t,n,r,i){var a=P;try{return ge(e,!0),t(n,r,i)}finally{ge(a,!1)}}function Zn(e,t,n,r){return typeof e!="function"?e:function(){var i=P;n&&We(),ge(t,!0);try{return e.apply(this,arguments)}finally{ge(i,!1),r&&queueMicrotask(me)}}}function tn(e){Promise===Ke&&H.echoes===0?mt===0?e():enqueueNativeMicroTask(e):setTimeout(e,0)}var Y=E.reject;function nn(e,t,n,r){if(!e.idbdb||!e._state.openComplete&&!P.letThrough&&!e._vip){if(e._state.openComplete)return Y(new D.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._state.autoOpen)return Y(new D.DatabaseClosed);e.open().catch(V)}return e._state.dbReadyPromise.then(function(){return nn(e,t,n,r)})}else{var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(a){return a.name===Yt.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return nn(e,t,n,r)})):Y(a)}return i._promise(t,function(a,u){return ye(function(){return P.trans=i,r(a,u,i)})}).then(function(a){if(t==="readwrite")try{i.idbtrans.commit()}catch{}return t==="readonly"?a:i._completion.then(function(){return a})})}}var qn="4.2.1",Oe="ï¿¿",rn=-1/0,fe="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",er="String expected.",Ue=[],wt="__dbnames",an="readonly",un="readwrite";function Ce(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var tr={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function _t(e){return typeof e=="string"&&!/\./.test(e)?function(t){return t[e]===void 0&&e in t&&(t=Se(t),delete t[e]),t}:function(t){return t}}function nr(){throw D.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function F(e,t){try{var n=rr(e),r=rr(t);if(n!==r)return n==="Array"?1:r==="Array"?-1:n==="binary"?1:r==="binary"?-1:n==="string"?1:r==="string"?-1:n==="Date"?1:r!=="Date"?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return si(ir(e),ir(t));case"Array":return oi(e,t)}}catch{}return NaN}function oi(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a){var u=F(e[a],t[a]);if(u!==0)return u}return n===r?0:n<r?-1:1}function si(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,a=0;a<i;++a)if(e[a]!==t[a])return e[a]<t[a]?-1:1;return n===r?0:n<r?-1:1}function rr(e){var t=typeof e;if(t!=="object")return t;if(ArrayBuffer.isView(e))return"binary";var n=Vt(e);return n==="ArrayBuffer"?"binary":n}function ir(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}function xt(e,t,n){var r=e.schema.yProps;return r?(t&&n.numFailures>0&&(t=t.filter(function(i,a){return!n.failures[a]})),Promise.all(r.map(function(i){var a=i.updatesTable;return t?e.db.table(a).where("k").anyOf(t).delete():e.db.table(a).clear()})).then(function(){return n})):n}var qe=(function(){function e(t){this["@@propmod"]=t}return e.prototype.execute=function(t){var n,r=this["@@propmod"];if(r.add!==void 0){var i=r.add;if(W(i))return de(de([],W(t)?t:[],!0),i).sort();if(typeof i=="number")return(Number(t)||0)+i;if(typeof i=="bigint")try{return BigInt(t)+i}catch{return BigInt(0)+i}throw new TypeError("Invalid term ".concat(i))}if(r.remove!==void 0){var a=r.remove;if(W(a))return W(t)?t.filter(function(o){return!a.includes(o)}).sort():[];if(typeof a=="number")return Number(t)-a;if(typeof a=="bigint")try{return BigInt(t)-a}catch{return BigInt(0)-a}throw new TypeError("Invalid subtrahend ".concat(a))}var u=(n=r.replacePrefix)===null||n===void 0?void 0:n[0];return u&&typeof t=="string"&&t.startsWith(u)?r.replacePrefix[1]+t.substring(u.length):t},e})();function ar(e,t){for(var n=Q(t),r=n.length,i=!1,a=0;a<r;++a){var u=n[a],o=t[u],s=ce(e,u);o instanceof qe?(q(e,u,o.execute(s)),i=!0):s!==o&&(q(e,u,o),i=!0)}return i}var ur=(function(){function e(){}return e.prototype._trans=function(t,n,r){var i=this._tx||P.trans,a=this.name,u=ae&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(t==="readonly"?"read":"write"," ").concat(this.name));function o(h,l,v){if(!v.schema[a])throw new D.NotFound("Table "+a+" not part of transaction");return n(v.idbtrans,v)}var s=Ve();try{var c=i&&i.db._novip===this.db._novip?i===P.trans?i._promise(t,o,r):ye(function(){return i._promise(t,o,r)},{trans:i,transless:P.transless||P}):nn(this.db,t,[this.name],o);return u&&(c._consoleTask=u,c=c.catch(function(h){return console.trace(h),Y(h)})),c}finally{s&&ze()}},e.prototype.get=function(t,n){var r=this;return t&&t.constructor===Object?this.where(t).first(n):t==null?Y(new D.Type("Invalid argument to Table.get()")):this._trans("readonly",function(i){return r.core.get({trans:i,key:t}).then(function(a){return r.hook.reading.fire(a)})}).then(n)},e.prototype.where=function(t){if(typeof t=="string")return new this.db.WhereClause(this,t);if(W(t))return new this.db.WhereClause(this,"[".concat(t.join("+"),"]"));var n=Q(t);if(n.length===1)return this.where(n[0]).equals(t[n[0]]);var r=this.schema.indexes.concat(this.schema.primKey).filter(function(h){if(h.compound&&n.every(function(v){return h.keyPath.indexOf(v)>=0})){for(var l=0;l<n.length;++l)if(n.indexOf(h.keyPath[l])===-1)return!1;return!0}return!1}).sort(function(h,l){return h.keyPath.length-l.keyPath.length})[0];if(r&&this.db._maxKey!==Oe){var i=r.keyPath.slice(0,n.length);return this.where(i).equals(i.map(function(h){return t[h]}))}!r&&ae&&console.warn("The query ".concat(JSON.stringify(t)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(n.join("+"),"]"));var a=this.schema.idxByName;function u(h,l){return F(h,l)===0}var o=n.reduce(function(h,l){var v=h[0],_=h[1],f=a[l],d=t[l];return[v||f,v||!f?Ce(_,f&&f.multi?function(p){var y=ce(p,l);return W(y)&&y.some(function(g){return u(d,g)})}:function(p){return u(d,ce(p,l))}):_]},[null,null]),s=o[0],c=o[1];return s?this.where(s.name).equals(t[s.keyPath]).filter(c):r?this.filter(c):this.where(n).equals("")},e.prototype.filter=function(t){return this.toCollection().and(t)},e.prototype.count=function(t){return this.toCollection().count(t)},e.prototype.offset=function(t){return this.toCollection().offset(t)},e.prototype.limit=function(t){return this.toCollection().limit(t)},e.prototype.each=function(t){return this.toCollection().each(t)},e.prototype.toArray=function(t){return this.toCollection().toArray(t)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(t){return new this.db.Collection(new this.db.WhereClause(this,W(t)?"[".concat(t.join("+"),"]"):t))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(t){var n=this,r=n.db,i=n.name;this.schema.mappedClass=t,t.prototype instanceof nr&&(t=(function(s){J(c,s);function c(){return s!==null&&s.apply(this,arguments)||this}return Object.defineProperty(c.prototype,"db",{get:function(){return r},enumerable:!1,configurable:!0}),c.prototype.table=function(){return i},c})(t));for(var a=new Set,u=t.prototype;u;u=Be(u))Object.getOwnPropertyNames(u).forEach(function(s){return a.add(s)});var o=function(s){if(!s)return s;var c=Object.create(t.prototype);for(var h in s)if(!a.has(h))try{c[h]=s[h]}catch{}return c};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=o,this.hook("reading",o),t},e.prototype.defineClass=function(){function t(n){te(this,n)}return this.mapToClass(t)},e.prototype.add=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,u=i.keyPath,o=t;return u&&a&&(o=_t(u)(t)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"add",keys:n!=null?[n]:null,values:[o]})}).then(function(s){return s.numFailures?E.reject(s.failures[0]):s.lastResult}).then(function(s){if(u)try{q(t,u,s)}catch{}return s})},e.prototype.upsert=function(t,n){var r=this,i=this.schema.primKey.keyPath;return this._trans("readwrite",function(a){return r.core.get({trans:a,key:t}).then(function(u){var o=u??{};return ar(o,n),i&&q(o,i,t),r.core.mutate({trans:a,type:"put",values:[o],keys:[t],upsert:!0,updates:{keys:[t],changeSpecs:[n]}}).then(function(s){return s.numFailures?E.reject(s.failures[0]):!!u})})})},e.prototype.update=function(t,n){if(typeof t=="object"&&!W(t)){var r=ce(t,this.schema.primKey.keyPath);return r===void 0?Y(new D.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(r).modify(n)}else return this.where(":id").equals(t).modify(n)},e.prototype.put=function(t,n){var r=this,i=this.schema.primKey,a=i.auto,u=i.keyPath,o=t;return u&&a&&(o=_t(u)(t)),this._trans("readwrite",function(s){return r.core.mutate({trans:s,type:"put",values:[o],keys:n!=null?[n]:null})}).then(function(s){return s.numFailures?E.reject(s.failures[0]):s.lastResult}).then(function(s){if(u)try{q(t,u,s)}catch{}return s})},e.prototype.delete=function(t){var n=this;return this._trans("readwrite",function(r){return n.core.mutate({trans:r,type:"delete",keys:[t]}).then(function(i){return xt(n,[t],i)}).then(function(i){return i.numFailures?E.reject(i.failures[0]):void 0})})},e.prototype.clear=function(){var t=this;return this._trans("readwrite",function(n){return t.core.mutate({trans:n,type:"deleteRange",range:tr}).then(function(r){return xt(t,null,r)})}).then(function(n){return n.numFailures?E.reject(n.failures[0]):void 0})},e.prototype.bulkGet=function(t){var n=this;return this._trans("readonly",function(r){return n.core.getMany({keys:t,trans:r}).then(function(i){return i.map(function(a){return n.hook.reading.fire(a)})})})},e.prototype.bulkAdd=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var u=r?r.allKeys:void 0;return this._trans("readwrite",function(o){var s=i.schema.primKey,c=s.auto,h=s.keyPath;if(h&&a)throw new D.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new D.InvalidArgument("Arguments objects and keys must have the same length");var l=t.length,v=h&&c?t.map(_t(h)):t;return i.core.mutate({trans:o,type:"add",keys:a,values:v,wantResults:u}).then(function(_){var f=_.numFailures,d=_.results,p=_.lastResult,y=_.failures,g=u?d:p;if(f===0)return g;throw new Ne("".concat(i.name,".bulkAdd(): ").concat(f," of ").concat(l," operations failed"),y)})})},e.prototype.bulkPut=function(t,n,r){var i=this,a=Array.isArray(n)?n:void 0;r=r||(a?void 0:n);var u=r?r.allKeys:void 0;return this._trans("readwrite",function(o){var s=i.schema.primKey,c=s.auto,h=s.keyPath;if(h&&a)throw new D.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(a&&a.length!==t.length)throw new D.InvalidArgument("Arguments objects and keys must have the same length");var l=t.length,v=h&&c?t.map(_t(h)):t;return i.core.mutate({trans:o,type:"put",keys:a,values:v,wantResults:u}).then(function(_){var f=_.numFailures,d=_.results,p=_.lastResult,y=_.failures,g=u?d:p;if(f===0)return g;throw new Ne("".concat(i.name,".bulkPut(): ").concat(f," of ").concat(l," operations failed"),y)})})},e.prototype.bulkUpdate=function(t){var n=this,r=this.core,i=t.map(function(o){return o.key}),a=t.map(function(o){return o.changes}),u=[];return this._trans("readwrite",function(o){return r.getMany({trans:o,keys:i,cache:"clone"}).then(function(s){var c=[],h=[];t.forEach(function(v,_){var f=v.key,d=v.changes,p=s[_];if(p){for(var y=0,g=Object.keys(d);y<g.length;y++){var b=g[y],w=d[b];if(b===n.schema.primKey.keyPath){if(F(w,f)!==0)throw new D.Constraint("Cannot update primary key in bulkUpdate()")}else q(p,b,w)}u.push(_),c.push(f),h.push(p)}});var l=c.length;return r.mutate({trans:o,type:"put",keys:c,values:h,updates:{keys:i,changeSpecs:a}}).then(function(v){var _=v.numFailures,f=v.failures;if(_===0)return l;for(var d=0,p=Object.keys(f);d<p.length;d++){var y=p[d],g=u[Number(y)];if(g!=null){var b=f[y];delete f[y],f[g]=b}}throw new Ne("".concat(n.name,".bulkUpdate(): ").concat(_," of ").concat(l," operations failed"),f)})})})},e.prototype.bulkDelete=function(t){var n=this,r=t.length;return this._trans("readwrite",function(i){return n.core.mutate({trans:i,type:"delete",keys:t}).then(function(a){return xt(n,t,a)})}).then(function(i){var a=i.numFailures,u=i.lastResult,o=i.failures;if(a===0)return u;throw new Ne("".concat(n.name,".bulkDelete(): ").concat(a," of ").concat(r," operations failed"),o)})},e})();function et(e){var t={},n=function(o,s){if(s){for(var c=arguments.length,h=new Array(c-1);--c;)h[c-1]=arguments[c];return t[o].subscribe.apply(null,h),e}else if(typeof o=="string")return t[o]};n.addEventType=a;for(var r=1,i=arguments.length;r<i;++r)a(arguments[r]);return n;function a(o,s,c){if(typeof o=="object")return u(o);s||(s=Hr),c||(c=V);var h={subscribers:[],fire:c,subscribe:function(l){h.subscribers.indexOf(l)===-1&&(h.subscribers.push(l),h.fire=s(h.fire,l))},unsubscribe:function(l){h.subscribers=h.subscribers.filter(function(v){return v!==l}),h.fire=h.subscribers.reduce(s,c)}};return t[o]=n[o]=h,h}function u(o){Q(o).forEach(function(s){var c=o[s];if(W(c))a(s,o[s][0],o[s][1]);else if(c==="asap")var h=a(s,Ge,function(){for(var v=arguments.length,_=new Array(v);v--;)_[v]=arguments[v];h.subscribers.forEach(function(f){Mn(function(){f.apply(null,_)})})});else throw new D.InvalidArgument("Invalid event config")})}}function tt(e,t){return Fe(t).from({prototype:e}),t}function ci(e){return tt(ur.prototype,function(n,r,i){this.db=e,this._tx=i,this.name=n,this.schema=r,this.hook=e._allTables[n]?e._allTables[n].hook:et(null,{creating:[Yr,V],reading:[Ur,Ge],updating:[Qr,V],deleting:[$r,V]})})}function Ye(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function on(e,t){e.filter=Ce(e.filter,t)}function sn(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return Ce(r(),t())}:t,e.justLimit=n&&!r}function li(e,t){e.isMatch=Ce(e.isMatch,t)}function It(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new D.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function or(e,t,n){var r=It(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:e.dir==="prev",unique:!!e.unique,query:{index:r,range:e.range}})}function St(e,t,n,r){var i=e.replayFilter?Ce(e.filter,e.replayFilter()):e.filter;if(e.or){var a={},u=function(o,s,c){if(!i||i(s,c,function(v){return s.stop(v)},function(v){return s.fail(v)})){var h=s.primaryKey,l=""+h;l==="[object ArrayBuffer]"&&(l=""+new Uint8Array(h)),Z(a,l)||(a[l]=!0,t(o,s,c))}};return Promise.all([e.or._iterate(u,n),sr(or(e,r,n),e.algorithm,u,!e.keysOnly&&e.valueMapper)])}else return sr(or(e,r,n),Ce(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function sr(e,t,n,r){var i=r?function(u,o,s){return n(r(u),o,s)}:n,a=z(i);return e.then(function(u){if(u)return u.start(function(){var o=function(){return u.continue()};(!t||t(u,function(s){return o=s},function(s){u.stop(s),o=V},function(s){u.fail(s),o=V}))&&a(u.value,u,function(s){return o=s}),o()})})}var fi=(function(){function e(){}return e.prototype._read=function(t,n){var r=this._ctx;return r.error?r.table._trans(null,Y.bind(null,r.error)):r.table._trans("readonly",t).then(n)},e.prototype._write=function(t){var n=this._ctx;return n.error?n.table._trans(null,Y.bind(null,n.error)):n.table._trans("readwrite",t,"locked")},e.prototype._addAlgorithm=function(t){var n=this._ctx;n.algorithm=Ce(n.algorithm,t)},e.prototype._iterate=function(t,n){return St(this._ctx,t,n,this._ctx.table.core)},e.prototype.clone=function(t){var n=Object.create(this.constructor.prototype),r=Object.create(this._ctx);return t&&te(r,t),n._ctx=r,n},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(t){var n=this._ctx;return this._read(function(r){return St(n,t,r,n.table.core)})},e.prototype.count=function(t){var n=this;return this._read(function(r){var i=n._ctx,a=i.table.core;if(Ye(i,!0))return a.count({trans:r,query:{index:It(i,a.schema),range:i.range}}).then(function(o){return Math.min(o,i.limit)});var u=0;return St(i,function(){return++u,!1},r,a).then(function(){return u})}).then(t)},e.prototype.sortBy=function(t,n){var r=t.split(".").reverse(),i=r[0],a=r.length-1;function u(c,h){return h?u(c[r[h]],h-1):c[i]}var o=this._ctx.dir==="next"?1:-1;function s(c,h){var l=u(c,a),v=u(h,a);return F(l,v)*o}return this.toArray(function(c){return c.sort(s)}).then(n)},e.prototype.toArray=function(t){var n=this;return this._read(function(r){var i=n._ctx;if(i.dir==="next"&&Ye(i,!0)&&i.limit>0){var a=i.valueMapper,u=It(i,i.table.core.schema);return i.table.core.query({trans:r,limit:i.limit,values:!0,query:{index:u,range:i.range}}).then(function(s){var c=s.result;return a?c.map(a):c})}else{var o=[];return St(i,function(s){return o.push(s)},r,i.table.core).then(function(){return o})}},t)},e.prototype.offset=function(t){var n=this._ctx;return t<=0?this:(n.offset+=t,Ye(n)?sn(n,function(){var r=t;return function(i,a){return r===0?!0:r===1?(--r,!1):(a(function(){i.advance(r),r=0}),!1)}}):sn(n,function(){var r=t;return function(){return--r<0}}),this)},e.prototype.limit=function(t){return this._ctx.limit=Math.min(this._ctx.limit,t),sn(this._ctx,function(){var n=t;return function(r,i,a){return--n<=0&&i(a),n>=0}},!0),this},e.prototype.until=function(t,n){return on(this._ctx,function(r,i,a){return t(r.value)?(i(a),n):!0}),this},e.prototype.first=function(t){return this.limit(1).toArray(function(n){return n[0]}).then(t)},e.prototype.last=function(t){return this.reverse().first(t)},e.prototype.filter=function(t){return on(this._ctx,function(n){return t(n.value)}),li(this._ctx,t),this},e.prototype.and=function(t){return this.filter(t)},e.prototype.or=function(t){return new this.db.WhereClause(this._ctx.table,t,this)},e.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.key,i)})},e.prototype.eachUniqueKey=function(t){return this._ctx.unique="unique",this.eachKey(t)},e.prototype.eachPrimaryKey=function(t){var n=this._ctx;return n.keysOnly=!n.isMatch,this.each(function(r,i){t(i.primaryKey,i)})},e.prototype.keys=function(t){var n=this._ctx;n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.key)}).then(function(){return r}).then(t)},e.prototype.primaryKeys=function(t){var n=this._ctx;if(n.dir==="next"&&Ye(n,!0)&&n.limit>0)return this._read(function(i){var a=It(n,n.table.core.schema);return n.table.core.query({trans:i,values:!1,limit:n.limit,query:{index:a,range:n.range}})}).then(function(i){var a=i.result;return a}).then(t);n.keysOnly=!n.isMatch;var r=[];return this.each(function(i,a){r.push(a.primaryKey)}).then(function(){return r}).then(t)},e.prototype.uniqueKeys=function(t){return this._ctx.unique="unique",this.keys(t)},e.prototype.firstKey=function(t){return this.limit(1).keys(function(n){return n[0]}).then(t)},e.prototype.lastKey=function(t){return this.reverse().firstKey(t)},e.prototype.distinct=function(){var t=this._ctx,n=t.index&&t.table.schema.idxByName[t.index];if(!n||!n.multi)return this;var r={};return on(this._ctx,function(i){var a=i.primaryKey.toString(),u=Z(r,a);return r[a]=!0,!u}),this},e.prototype.modify=function(t){var n=this,r=this._ctx;return this._write(function(i){var a;typeof t=="function"?a=t:a=function(y){return ar(y,t)};var u=r.table.core,o=u.schema.primaryKey,s=o.outbound,c=o.extractKey,h=200,l=n.db._options.modifyChunkSize;l&&(typeof l=="object"?h=l[u.name]||l["*"]||200:h=l);var v=[],_=0,f=[],d=function(y,g){var b=g.failures,w=g.numFailures;_+=y-w;for(var m=0,I=Q(b);m<I.length;m++){var A=I[m];v.push(b[A])}},p=t===cr;return n.clone().primaryKeys().then(function(y){var g=Ye(r)&&r.limit===1/0&&(typeof t!="function"||p)&&{index:r.index,range:r.range},b=function(w){var m=Math.min(h,y.length-w),I=y.slice(w,w+m);return(p?Promise.resolve([]):u.getMany({trans:i,keys:I,cache:"immutable"})).then(function(A){var S=[],O=[],M=s?[]:null,K=p?I:[];if(!p)for(var B=0;B<m;++B){var R=A[B],j={value:Se(R),primKey:y[w+B]};a.call(j,j.value,j)!==!1&&(j.value==null?K.push(y[w+B]):!s&&F(c(R),c(j.value))!==0?(K.push(y[w+B]),S.push(j.value)):(O.push(j.value),s&&M.push(y[w+B])))}return Promise.resolve(S.length>0&&u.mutate({trans:i,type:"add",values:S}).then(function(k){for(var U in k.failures)K.splice(parseInt(U),1);d(S.length,k)})).then(function(){return(O.length>0||g&&typeof t=="object")&&u.mutate({trans:i,type:"put",keys:M,values:O,criteria:g,changeSpec:typeof t!="function"&&t,isAdditionalChunk:w>0}).then(function(k){return d(O.length,k)})}).then(function(){return(K.length>0||g&&p)&&u.mutate({trans:i,type:"delete",keys:K,criteria:g,isAdditionalChunk:w>0}).then(function(k){return xt(r.table,K,k)}).then(function(k){return d(K.length,k)})}).then(function(){return y.length>w+m&&b(w+h)})})};return b(0).then(function(){if(v.length>0)throw new lt("Error modifying one or more objects",v,_,f);return y.length})})})},e.prototype.delete=function(){var t=this._ctx,n=t.range;return Ye(t)&&!t.table.schema.yProps&&(t.isPrimKey||n.type===3)?this._write(function(r){var i=t.table.core.schema.primaryKey,a=n;return t.table.core.count({trans:r,query:{index:i,range:a}}).then(function(u){return t.table.core.mutate({trans:r,type:"deleteRange",range:a}).then(function(o){var s=o.failures,c=o.numFailures;if(c)throw new lt("Could not delete some values",Object.keys(s).map(function(h){return s[h]}),u-c);return u-c})})}):this.modify(cr)},e})(),cr=function(e,t){return t.value=null};function hi(e){return tt(fi.prototype,function(n,r){this.db=e;var i=tr,a=null;if(r)try{i=r()}catch(c){a=c}var u=n._ctx,o=u.table,s=o.hook.reading.fire;this._ctx={table:o,index:u.index,isPrimKey:!u.index||o.schema.primKey.keyPath&&u.index===o.schema.primKey.name,range:i,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:a,or:u.or,valueMapper:s!==Ge?s:null}})}function di(e,t){return e<t?-1:e===t?0:1}function pi(e,t){return e>t?-1:e===t?0:1}function ne(e,t,n){var r=e instanceof fr?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function $e(e){return new e.Collection(e,function(){return lr("")}).limit(0)}function vi(e){return e==="next"?function(t){return t.toUpperCase()}:function(t){return t.toLowerCase()}}function yi(e){return e==="next"?function(t){return t.toLowerCase()}:function(t){return t.toUpperCase()}}function mi(e,t,n,r,i,a){for(var u=Math.min(e.length,r.length),o=-1,s=0;s<u;++s){var c=t[s];if(c!==r[s])return i(e[s],n[s])<0?e.substr(0,s)+n[s]+n.substr(s+1):i(e[s],r[s])<0?e.substr(0,s)+r[s]+n.substr(s+1):o>=0?e.substr(0,o)+t[o]+n.substr(o+1):null;i(e[s],c)<0&&(o=s)}return u<r.length&&a==="next"?e+n.substr(e.length):u<e.length&&a==="prev"?e.substr(0,n.length):o<0?null:e.substr(0,o)+r[o]+n.substr(o+1)}function Et(e,t,n,r){var i,a,u,o,s,c,h,l=n.length;if(!n.every(function(d){return typeof d=="string"}))return ne(e,er);function v(d){i=vi(d),a=yi(d),u=d==="next"?di:pi;var p=n.map(function(y){return{lower:a(y),upper:i(y)}}).sort(function(y,g){return u(y.lower,g.lower)});o=p.map(function(y){return y.upper}),s=p.map(function(y){return y.lower}),c=d,h=d==="next"?"":r}v("next");var _=new e.Collection(e,function(){return be(o[0],s[l-1]+r)});_._ondirectionchange=function(d){v(d)};var f=0;return _._addAlgorithm(function(d,p,y){var g=d.key;if(typeof g!="string")return!1;var b=a(g);if(t(b,s,f))return!0;for(var w=null,m=f;m<l;++m){var I=mi(g,b,o[m],s[m],u,c);I===null&&w===null?f=m+1:(w===null||u(w,I)>0)&&(w=I)}return p(w!==null?function(){d.continue(w+h)}:y),!1}),_}function be(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function lr(e){return{type:1,lower:e,upper:e}}var fr=(function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(t,n,r,i){r=r!==!1,i=i===!0;try{return this._cmp(t,n)>0||this._cmp(t,n)===0&&(r||i)&&!(r&&i)?$e(this):new this.Collection(this,function(){return be(t,n,!r,!i)})}catch{return ne(this,fe)}},e.prototype.equals=function(t){return t==null?ne(this,fe):new this.Collection(this,function(){return lr(t)})},e.prototype.above=function(t){return t==null?ne(this,fe):new this.Collection(this,function(){return be(t,void 0,!0)})},e.prototype.aboveOrEqual=function(t){return t==null?ne(this,fe):new this.Collection(this,function(){return be(t,void 0,!1)})},e.prototype.below=function(t){return t==null?ne(this,fe):new this.Collection(this,function(){return be(void 0,t,!1,!0)})},e.prototype.belowOrEqual=function(t){return t==null?ne(this,fe):new this.Collection(this,function(){return be(void 0,t)})},e.prototype.startsWith=function(t){return typeof t!="string"?ne(this,er):this.between(t,t+Oe,!0,!0)},e.prototype.startsWithIgnoreCase=function(t){return t===""?this.startsWith(t):Et(this,function(n,r){return n.indexOf(r[0])===0},[t],Oe)},e.prototype.equalsIgnoreCase=function(t){return Et(this,function(n,r){return n===r[0]},[t],"")},e.prototype.anyOfIgnoreCase=function(){var t=le.apply(je,arguments);return t.length===0?$e(this):Et(this,function(n,r){return r.indexOf(n)!==-1},t,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var t=le.apply(je,arguments);return t.length===0?$e(this):Et(this,function(n,r){return r.some(function(i){return n.indexOf(i)===0})},t,Oe)},e.prototype.anyOf=function(){var t=this,n=le.apply(je,arguments),r=this._cmp;try{n.sort(r)}catch{return ne(this,fe)}if(n.length===0)return $e(this);var i=new this.Collection(this,function(){return be(n[0],n[n.length-1])});i._ondirectionchange=function(u){r=u==="next"?t._ascending:t._descending,n.sort(r)};var a=0;return i._addAlgorithm(function(u,o,s){for(var c=u.key;r(c,n[a])>0;)if(++a,a===n.length)return o(s),!1;return r(c,n[a])===0?!0:(o(function(){u.continue(n[a])}),!1)}),i},e.prototype.notEqual=function(t){return this.inAnyRange([[rn,t],[t,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var t=le.apply(je,arguments);if(t.length===0)return new this.Collection(this);try{t.sort(this._ascending)}catch{return ne(this,fe)}var n=t.reduce(function(r,i){return r?r.concat([[r[r.length-1][1],i]]):[[rn,i]]},null);return n.push([t[t.length-1],this.db._maxKey]),this.inAnyRange(n,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(t,n){var r=this,i=this._cmp,a=this._ascending,u=this._descending,o=this._min,s=this._max;if(t.length===0)return $e(this);if(!t.every(function(m){return m[0]!==void 0&&m[1]!==void 0&&a(m[0],m[1])<=0}))return ne(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",D.InvalidArgument);var c=!n||n.includeLowers!==!1,h=n&&n.includeUppers===!0;function l(m,I){for(var A=0,S=m.length;A<S;++A){var O=m[A];if(i(I[0],O[1])<0&&i(I[1],O[0])>0){O[0]=o(O[0],I[0]),O[1]=s(O[1],I[1]);break}}return A===S&&m.push(I),m}var v=a;function _(m,I){return v(m[0],I[0])}var f;try{f=t.reduce(l,[]),f.sort(_)}catch{return ne(this,fe)}var d=0,p=h?function(m){return a(m,f[d][1])>0}:function(m){return a(m,f[d][1])>=0},y=c?function(m){return u(m,f[d][0])>0}:function(m){return u(m,f[d][0])>=0};function g(m){return!p(m)&&!y(m)}var b=p,w=new this.Collection(this,function(){return be(f[0][0],f[f.length-1][1],!c,!h)});return w._ondirectionchange=function(m){m==="next"?(b=p,v=a):(b=y,v=u),f.sort(_)},w._addAlgorithm(function(m,I,A){for(var S=m.key;b(S);)if(++d,d===f.length)return I(A),!1;return g(S)?!0:(r._cmp(S,f[d][1])===0||r._cmp(S,f[d][0])===0||I(function(){v===a?m.continue(f[d][0]):m.continue(f[d][1])}),!1)}),w},e.prototype.startsWithAnyOf=function(){var t=le.apply(je,arguments);return t.every(function(n){return typeof n=="string"})?t.length===0?$e(this):this.inAnyRange(t.map(function(n){return[n,n+Oe]})):ne(this,"startsWithAnyOf() only works with strings")},e})();function gi(e){return tt(fr.prototype,function(n,r,i){if(this.db=e,this._ctx={table:n,index:r===":id"?null:r,or:i},this._cmp=this._ascending=F,this._descending=function(a,u){return F(u,a)},this._max=function(a,u){return F(a,u)>0?a:u},this._min=function(a,u){return F(a,u)<0?a:u},this._IDBKeyRange=e._deps.IDBKeyRange,!this._IDBKeyRange)throw new D.MissingAPI})}function ue(e){return z(function(t){return nt(t),e(t.target.error),!1})}function nt(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var rt="storagemutated",cn="x-storagemutated-1",we=et(null,rt),bi=(function(){function e(){}return e.prototype._lock=function(){return Qe(!P.global),++this._reculock,this._reculock===1&&!P.global&&(P.lockOwnerFor=this),this},e.prototype._unlock=function(){if(Qe(!P.global),--this._reculock===0)for(P.global||(P.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var t=this._blockedFuncs.shift();try{De(t[1],t[0])}catch{}}return this},e.prototype._locked=function(){return this._reculock&&P.lockOwnerFor!==this},e.prototype.create=function(t){var n=this;if(!this.mode)return this;var r=this.db.idbdb,i=this.db._state.dbOpenError;if(Qe(!this.idbtrans),!t&&!r)switch(i&&i.name){case"DatabaseClosedError":throw new D.DatabaseClosed(i);case"MissingAPIError":throw new D.MissingAPI(i.message,i);default:throw new D.OpenFailed(i)}if(!this.active)throw new D.TransactionInactive;return Qe(this._completion._state===null),t=this.idbtrans=t||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):r.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})),t.onerror=z(function(a){nt(a),n._reject(t.error)}),t.onabort=z(function(a){nt(a),n.active&&n._reject(new D.Abort(t.error)),n.active=!1,n.on("abort").fire(a)}),t.oncomplete=z(function(){n.active=!1,n._resolve(),"mutatedParts"in t&&we.storagemutated.fire(t.mutatedParts)}),this},e.prototype._promise=function(t,n,r){var i=this;if(t==="readwrite"&&this.mode!=="readwrite")return Y(new D.ReadOnly("Transaction is readonly"));if(!this.active)return Y(new D.TransactionInactive);if(this._locked())return new E(function(u,o){i._blockedFuncs.push([function(){i._promise(t,n,r).then(u,o)},P])});if(r)return ye(function(){var u=new E(function(o,s){i._lock();var c=n(o,s,i);c&&c.then&&c.then(o,s)});return u.finally(function(){return i._unlock()}),u._lib=!0,u});var a=new E(function(u,o){var s=n(u,o,i);s&&s.then&&s.then(u,o)});return a._lib=!0,a},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(t){var n=this._root(),r=E.resolve(t);if(n._waitingFor)n._waitingFor=n._waitingFor.then(function(){return r});else{n._waitingFor=r,n._waitingQueue=[];var i=n.idbtrans.objectStore(n.storeNames[0]);(function u(){for(++n._spinCount;n._waitingQueue.length;)n._waitingQueue.shift()();n._waitingFor&&(i.get(-1/0).onsuccess=u)})()}var a=n._waitingFor;return new E(function(u,o){r.then(function(s){return n._waitingQueue.push(z(u.bind(null,s)))},function(s){return n._waitingQueue.push(z(o.bind(null,s)))}).finally(function(){n._waitingFor===a&&(n._waitingFor=null)})})},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new D.Abort))},e.prototype.table=function(t){var n=this._memoizedTables||(this._memoizedTables={});if(Z(n,t))return n[t];var r=this.schema[t];if(!r)throw new D.NotFound("Table "+t+" not part of transaction");var i=new this.db.Table(t,r,this);return i.core=this.db.core.table(t),n[t]=i,i},e})();function wi(e){return tt(bi.prototype,function(n,r,i,a,u){var o=this;n!=="readonly"&&r.forEach(function(s){var c,h=(c=i[s])===null||c===void 0?void 0:c.yProps;h&&(r=r.concat(h.map(function(l){return l.updatesTable})))}),this.db=e,this.mode=n,this.storeNames=r,this.schema=i,this.chromeTransactionDurability=a,this.idbtrans=null,this.on=et(this,"complete","error","abort"),this.parent=u||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new E(function(s,c){o._resolve=s,o._reject=c}),this._completion.then(function(){o.active=!1,o.on.complete.fire()},function(s){var c=o.active;return o.active=!1,o.on.error.fire(s),o.parent?o.parent._reject(s):c&&o.idbtrans&&o.idbtrans.abort(),Y(s)})})}function ln(e,t,n,r,i,a,u,o){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:a,src:(n&&!u?"&":"")+(r?"*":"")+(i?"++":"")+hr(t),type:o}}function hr(e){return typeof e=="string"?e:e?"["+[].join.call(e,"+")+"]":""}function fn(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:Tr(n,function(r){return[r.name,r]})}}function _i(e){return e.length===1?e[0]:e}var it=function(e){try{return e.only([[]]),it=function(){return[[]]},[[]]}catch{return it=function(){return Oe},Oe}};function hn(e){return e==null?function(){}:typeof e=="string"?xi(e):function(t){return ce(t,e)}}function xi(e){var t=e.split(".");return t.length===1?function(n){return n[e]}:function(n){return ce(n,e)}}function dr(e){return[].slice.call(e)}var Ii=0;function at(e){return e==null?":id":typeof e=="string"?e:"[".concat(e.join("+"),"]")}function Si(e,t,n){function r(l,v){var _=dr(l.objectStoreNames);return{schema:{name:l.name,tables:_.map(function(f){return v.objectStore(f)}).map(function(f){var d=f.keyPath,p=f.autoIncrement,y=W(d),g=d==null,b={},w={name:f.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:g,compound:y,keyPath:d,autoIncrement:p,unique:!0,extractKey:hn(d)},indexes:dr(f.indexNames).map(function(m){return f.index(m)}).map(function(m){var I=m.name,A=m.unique,S=m.multiEntry,O=m.keyPath,M=W(O),K={name:I,compound:M,keyPath:O,unique:A,multiEntry:S,extractKey:hn(O)};return b[at(O)]=K,K}),getIndexByKeyPath:function(m){return b[at(m)]}};return b[":id"]=w.primaryKey,d!=null&&(b[at(d)]=w.primaryKey),w})},hasGetAll:_.length>0&&"getAll"in v.objectStore(_[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}}function i(l){if(l.type===3)return null;if(l.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var v=l.lower,_=l.upper,f=l.lowerOpen,d=l.upperOpen,p=v===void 0?_===void 0?null:t.upperBound(_,!!d):_===void 0?t.lowerBound(v,!!f):t.bound(v,_,!!f,!!d);return p}function a(l){var v=l.name;function _(p){var y=p.trans,g=p.type,b=p.keys,w=p.values,m=p.range;return new Promise(function(I,A){I=z(I);var S=y.objectStore(v),O=S.keyPath==null,M=g==="put"||g==="add";if(!M&&g!=="delete"&&g!=="deleteRange")throw new Error("Invalid operation type: "+g);var K=(b||w||{length:1}).length;if(b&&w&&b.length!==w.length)throw new Error("Given keys array must have same length as given values array.");if(K===0)return I({numFailures:0,failures:{},results:[],lastResult:void 0});var B,R=[],j=[],k=0,U=function(se){++k,nt(se)};if(g==="deleteRange"){if(m.type===4)return I({numFailures:k,failures:j,results:[],lastResult:void 0});m.type===3?R.push(B=S.clear()):R.push(B=S.delete(i(m)))}else{var X=M?O?[w,b]:[w,null]:[b,null],oe=X[0],ee=X[1];if(M)for(var re=0;re<K;++re)R.push(B=ee&&ee[re]!==void 0?S[g](oe[re],ee[re]):S[g](oe[re])),B.onerror=U;else for(var re=0;re<K;++re)R.push(B=S[g](oe[re])),B.onerror=U}var Ie=function(se){var st=se.target.result;R.forEach(function(ie,Ft){return ie.error!=null&&(j[Ft]=ie.error)}),I({numFailures:k,failures:j,results:g==="delete"?b:R.map(function(ie){return ie.result}),lastResult:st})};B.onerror=function(se){U(se),Ie(se)},B.onsuccess=Ie})}function f(p){var y=p.trans,g=p.values,b=p.query,w=p.reverse,m=p.unique;return new Promise(function(I,A){I=z(I);var S=b.index,O=b.range,M=y.objectStore(v),K=S.isPrimaryKey?M:M.index(S.name),B=w?m?"prevunique":"prev":m?"nextunique":"next",R=g||!("openKeyCursor"in K)?K.openCursor(i(O),B):K.openKeyCursor(i(O),B);R.onerror=ue(A),R.onsuccess=z(function(j){var k=R.result;if(!k){I(null);return}k.___id=++Ii,k.done=!1;var U=k.continue.bind(k),X=k.continuePrimaryKey;X&&(X=X.bind(k));var oe=k.advance.bind(k),ee=function(){throw new Error("Cursor not started")},re=function(){throw new Error("Cursor not stopped")};k.trans=y,k.stop=k.continue=k.continuePrimaryKey=k.advance=ee,k.fail=z(A),k.next=function(){var Ie=this,se=1;return this.start(function(){return se--?Ie.continue():Ie.stop()}).then(function(){return Ie})},k.start=function(Ie){var se=new Promise(function(ie,Ft){ie=z(ie),R.onerror=ue(Ft),k.fail=Ft,k.stop=function(fa){k.stop=k.continue=k.continuePrimaryKey=k.advance=re,ie(fa)}}),st=function(){if(R.result)try{Ie()}catch(ie){k.fail(ie)}else k.done=!0,k.start=function(){throw new Error("Cursor behind last entry")},k.stop()};return R.onsuccess=z(function(ie){R.onsuccess=st,st()}),k.continue=U,k.continuePrimaryKey=X,k.advance=oe,st(),se},I(k)},A)})}function d(p){return function(y){return new Promise(function(g,b){g=z(g);var w=y.trans,m=y.values,I=y.limit,A=y.query,S=I===1/0?void 0:I,O=A.index,M=A.range,K=w.objectStore(v),B=O.isPrimaryKey?K:K.index(O.name),R=i(M);if(I===0)return g({result:[]});if(p){var j=m?B.getAll(R,S):B.getAllKeys(R,S);j.onsuccess=function(oe){return g({result:oe.target.result})},j.onerror=ue(b)}else{var k=0,U=m||!("openKeyCursor"in B)?B.openCursor(R):B.openKeyCursor(R),X=[];U.onsuccess=function(oe){var ee=U.result;if(!ee)return g({result:X});if(X.push(m?ee.value:ee.primaryKey),++k===I)return g({result:X});ee.continue()},U.onerror=ue(b)}})}}return{name:v,schema:l,mutate:_,getMany:function(p){var y=p.trans,g=p.keys;return new Promise(function(b,w){b=z(b);for(var m=y.objectStore(v),I=g.length,A=new Array(I),S=0,O=0,M,K=function(k){var U=k.target;(A[U._pos]=U.result)!=null,++O===S&&b(A)},B=ue(w),R=0;R<I;++R){var j=g[R];j!=null&&(M=m.get(g[R]),M._pos=R,M.onsuccess=K,M.onerror=B,++S)}S===0&&b(A)})},get:function(p){var y=p.trans,g=p.key;return new Promise(function(b,w){b=z(b);var m=y.objectStore(v),I=m.get(g);I.onsuccess=function(A){return b(A.target.result)},I.onerror=ue(w)})},query:d(s),openCursor:f,count:function(p){var y=p.query,g=p.trans,b=y.index,w=y.range;return new Promise(function(m,I){var A=g.objectStore(v),S=b.isPrimaryKey?A:A.index(b.name),O=i(w),M=O?S.count(O):S.count();M.onsuccess=z(function(K){return m(K.target.result)}),M.onerror=ue(I)})}}}var u=r(e,n),o=u.schema,s=u.hasGetAll,c=o.tables.map(function(l){return a(l)}),h={};return c.forEach(function(l){return h[l.name]=l}),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(l){var v=h[l];if(!v)throw new Error("Table '".concat(l,"' not found"));return h[l]},MIN_KEY:-1/0,MAX_KEY:it(t),schema:o}}function Ei(e,t){return t.reduce(function(n,r){var i=r.create;return T(T({},n),i(n))},e)}function Ai(e,t,n,r){var i=n.IDBKeyRange;n.indexedDB;var a=Ei(Si(t,i,r),e.dbcore);return{dbcore:a}}function At(e,t){var n=t.db,r=Ai(e._middlewares,n,e._deps,t);e.core=r.dbcore,e.tables.forEach(function(i){var a=i.name;e.core.schema.tables.some(function(u){return u.name===a})&&(i.core=e.core.table(a),e[a]instanceof e.Table&&(e[a].core=i.core))})}function Kt(e,t,n,r){n.forEach(function(i){var a=r[i];t.forEach(function(u){var o=Rn(u,i);(!o||"value"in o&&o.value===void 0)&&(u===e.Transaction.prototype||u instanceof e.Transaction?pe(u,i,{get:function(){return this.table(i)},set:function(s){Tn(this,i,{value:s,writable:!0,configurable:!0,enumerable:!0})}}):u[i]=new e.Table(i,a))})})}function dn(e,t){t.forEach(function(n){for(var r in n)n[r]instanceof e.Table&&delete n[r]})}function Ki(e,t){return e._cfg.version-t._cfg.version}function Pi(e,t,n,r){var i=e._dbSchema;n.objectStoreNames.contains("$meta")&&!i.$meta&&(i.$meta=fn("$meta",vr("")[0],[]),e._storeNames.push("$meta"));var a=e._createTransaction("readwrite",e._storeNames,i);a.create(n),a._completion.catch(r);var u=a._reject.bind(a),o=P.transless||P;ye(function(){if(P.trans=a,P.transless=o,t===0)Q(i).forEach(function(s){vn(n,s,i[s].primKey,i[s].indexes)}),At(e,n),E.follow(function(){return e.on.populate.fire(a)}).catch(u);else return At(e,n),Di(e,a,t).then(function(s){return Oi(e,s,a,n)}).catch(u)})}function ki(e,t){pr(e._dbSchema,t),t.db.version%10===0&&!t.objectStoreNames.contains("$meta")&&t.db.createObjectStore("$meta").add(Math.ceil(t.db.version/10-1),"version");var n=kt(e,e.idbdb,t);Dt(e,e._dbSchema,t);for(var r=pn(n,e._dbSchema),i=function(c){if(c.change.length||c.recreate)return console.warn("Unable to patch indexes of table ".concat(c.name," because it has changes on the type of index or primary key.")),{value:void 0};var h=t.objectStore(c.name);c.add.forEach(function(l){ae&&console.debug("Dexie upgrade patch: Creating missing index ".concat(c.name,".").concat(l.src)),Pt(h,l)})},a=0,u=r.change;a<u.length;a++){var o=u[a],s=i(o);if(typeof s=="object")return s.value}}function Di(e,t,n){return t.storeNames.includes("$meta")?t.table("$meta").get("version").then(function(r){return r??n}):E.resolve(n)}function Oi(e,t,n,r){var i=[],a=e._versions,u=e._dbSchema=kt(e,e.idbdb,r),o=a.filter(function(c){return c._cfg.version>=t});if(o.length===0)return E.resolve();o.forEach(function(c){i.push(function(){var h=u,l=c._cfg.dbschema;Dt(e,h,r),Dt(e,l,r),u=e._dbSchema=l;var v=pn(h,l);v.add.forEach(function(g){vn(r,g[0],g[1].primKey,g[1].indexes)}),v.change.forEach(function(g){if(g.recreate)throw new D.Upgrade("Not yet support for changing primary key");var b=r.objectStore(g.name);g.add.forEach(function(w){return Pt(b,w)}),g.change.forEach(function(w){b.deleteIndex(w.name),Pt(b,w)}),g.del.forEach(function(w){return b.deleteIndex(w)})});var _=c._cfg.contentUpgrade;if(_&&c._cfg.version>t){At(e,r),n._memoizedTables={};var f=Fn(l);v.del.forEach(function(g){f[g]=h[g]}),dn(e,[e.Transaction.prototype]),Kt(e,[e.Transaction.prototype],Q(f),f),n.schema=f;var d=Wt(_);d&&We();var p,y=E.follow(function(){if(p=_(n),p&&d){var g=me.bind(null,null);p.then(g,g)}});return p&&typeof p.then=="function"?E.resolve(p):y.then(function(){return p})}}),i.push(function(h){var l=c._cfg.dbschema;Ci(l,h),dn(e,[e.Transaction.prototype]),Kt(e,[e.Transaction.prototype],e._storeNames,e._dbSchema),n.schema=e._dbSchema}),i.push(function(h){e.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(e.idbdb.version/10)===c._cfg.version?(e.idbdb.deleteObjectStore("$meta"),delete e._dbSchema.$meta,e._storeNames=e._storeNames.filter(function(l){return l!=="$meta"})):h.objectStore("$meta").put(c._cfg.version,"version"))})});function s(){return i.length?E.resolve(i.shift()(n.idbtrans)).then(s):E.resolve()}return s().then(function(){pr(u,r)})}function pn(e,t){var n={del:[],add:[],change:[]},r;for(r in e)t[r]||n.del.push(r);for(r in t){var i=e[r],a=t[r];if(!i)n.add.push([r,a]);else{var u={name:r,def:a,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(a.primKey.keyPath||"")||i.primKey.auto!==a.primKey.auto)u.recreate=!0,n.change.push(u);else{var o=i.idxByName,s=a.idxByName,c=void 0;for(c in o)s[c]||u.del.push(c);for(c in s){var h=o[c],l=s[c];h?h.src!==l.src&&u.change.push(l):u.add.push(l)}(u.del.length>0||u.add.length>0||u.change.length>0)&&n.change.push(u)}}}return n}function vn(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach(function(a){return Pt(i,a)}),i}function pr(e,t){Q(e).forEach(function(n){t.db.objectStoreNames.contains(n)||(ae&&console.debug("Dexie: Creating missing table",n),vn(t,n,e[n].primKey,e[n].indexes))})}function Ci(e,t){[].slice.call(t.db.objectStoreNames).forEach(function(n){return e[n]==null&&t.db.deleteObjectStore(n)})}function Pt(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function kt(e,t,n){var r={},i=ct(t.objectStoreNames,0);return i.forEach(function(a){for(var u=n.objectStore(a),o=u.keyPath,s=ln(hr(o),o||"",!0,!1,!!u.autoIncrement,o&&typeof o!="string",!0),c=[],h=0;h<u.indexNames.length;++h){var l=u.index(u.indexNames[h]);o=l.keyPath;var v=ln(l.name,o,!!l.unique,!!l.multiEntry,!1,o&&typeof o!="string",!1);c.push(v)}r[a]=fn(a,s,c)}),r}function Ti(e,t,n){e.verno=t.version/10;var r=e._dbSchema=kt(e,t,n);e._storeNames=ct(t.objectStoreNames,0),Kt(e,[e._allTables],Q(r),r)}function Ri(e,t){var n=kt(e,e.idbdb,t),r=pn(n,e._dbSchema);return!(r.add.length||r.change.some(function(i){return i.add.length||i.change.length}))}function Dt(e,t,n){for(var r=n.db.objectStoreNames,i=0;i<r.length;++i){var a=r[i],u=n.objectStore(a);e._hasGetAll="getAll"in u;for(var o=0;o<u.indexNames.length;++o){var s=u.indexNames[o],c=u.index(s).keyPath,h=typeof c=="string"?c:"["+ct(c).join("+")+"]";if(t[a]){var l=t[a].idxByName[h];l&&(l.name=s,delete t[a].idxByName[h],t[a].idxByName[s]=l)}}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&$.WorkerGlobalScope&&$ instanceof $.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(e._hasGetAll=!1)}function vr(e){return e.split(",").map(function(t,n){var r,i=t.split(":"),a=(r=i[1])===null||r===void 0?void 0:r.trim();t=i[0].trim();var u=t.replace(/([&*]|\+\+)/g,""),o=/^\[/.test(u)?u.match(/^\[(.*)\]$/)[1].split("+"):u;return ln(u,o||null,/\&/.test(t),/\*/.test(t),/\+\+/.test(t),W(o),n===0,a)})}var Bi=(function(){function e(){}return e.prototype._createTableSchema=function(t,n,r){return fn(t,n,r)},e.prototype._parseIndexSyntax=function(t){return vr(t)},e.prototype._parseStoresSpec=function(t,n){var r=this;Q(t).forEach(function(i){if(t[i]!==null){var a=r._parseIndexSyntax(t[i]),u=a.shift();if(!u)throw new D.Schema("Invalid schema for table "+i+": "+t[i]);if(u.unique=!0,u.multi)throw new D.Schema("Primary key cannot be multiEntry*");a.forEach(function(s){if(s.auto)throw new D.Schema("Only primary key can be marked as autoIncrement (++)");if(!s.keyPath)throw new D.Schema("Index must have a name and cannot be an empty string")});var o=r._createTableSchema(i,u,a);n[i]=o}})},e.prototype.stores=function(t){var n=this.db;this._cfg.storesSource=this._cfg.storesSource?te(this._cfg.storesSource,t):t;var r=n._versions,i={},a={};return r.forEach(function(u){te(i,u._cfg.storesSource),a=u._cfg.dbschema={},u._parseStoresSpec(i,a)}),n._dbSchema=a,dn(n,[n._allTables,n,n.Transaction.prototype]),Kt(n,[n._allTables,n,n.Transaction.prototype,this._cfg.tables],Q(a),a),n._storeNames=Q(a),this},e.prototype.upgrade=function(t){return this._cfg.contentUpgrade=$t(this._cfg.contentUpgrade||V,t),this},e})();function Mi(e){return tt(Bi.prototype,function(n){this.db=e,this._cfg={version:n,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})}function yn(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new he(wt,{addons:[],indexedDB:e,IDBKeyRange:t}),n.version(1).stores({dbnames:"name"})),n.table("dbnames")}function mn(e){return e&&typeof e.databases=="function"}function Fi(e){var t=e.indexedDB,n=e.IDBKeyRange;return mn(t)?Promise.resolve(t.databases()).then(function(r){return r.map(function(i){return i.name}).filter(function(i){return i!==wt})}):yn(t,n).toCollection().primaryKeys()}function ji(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!mn(n)&&t!==wt&&yn(n,r).put({name:t}).catch(V)}function Li(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!mn(n)&&t!==wt&&yn(n,r).delete(t).catch(V)}function gn(e){return ye(function(){return P.letThrough=!0,e()})}function Ni(){var e=!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent);if(!e||!indexedDB.databases)return Promise.resolve();var t;return new Promise(function(n){var r=function(){return indexedDB.databases().finally(n)};t=setInterval(r,100),r()}).finally(function(){return clearInterval(t)})}var bn;function wn(e){return!("from"in e)}var G=function(e,t){if(this)te(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0});else{var n=new G;return e&&"d"in e&&te(n,e),n}};Me(G.prototype,(bn={add:function(e){return ot(this,e),this},addKey:function(e){return ut(this,e,e),this},addKeys:function(e){var t=this;return e.forEach(function(n){return ut(t,n,n)}),this},hasKey:function(e){var t=Ot(this).next(e).value;return t&&F(t.from,e)<=0&&F(t.to,e)>=0}},bn[zt]=function(){return Ot(this)},bn));function ut(e,t,n){var r=F(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(wn(e))return te(e,{from:t,to:n,d:1});var i=e.l,a=e.r;if(F(n,e.from)<0)return i?ut(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},mr(e);if(F(t,e.to)>0)return a?ut(a,t,n):e.r={from:t,to:n,d:1,l:null,r:null},mr(e);F(t,e.from)<0&&(e.from=t,e.l=null,e.d=a?a.d+1:1),F(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var u=!e.r;i&&!e.l&&ot(e,i),a&&u&&ot(e,a)}}function ot(e,t){function n(r,i){var a=i.from,u=i.to,o=i.l,s=i.r;ut(r,a,u),o&&n(r,o),s&&n(r,s)}wn(t)||n(e,t)}function yr(e,t){var n=Ot(t),r=n.next();if(r.done)return!1;for(var i=r.value,a=Ot(e),u=a.next(i.from),o=u.value;!r.done&&!u.done;){if(F(o.from,i.to)<=0&&F(o.to,i.from)>=0)return!0;F(i.from,o.from)<0?i=(r=n.next(o.from)).value:o=(u=a.next(i.from)).value}return!1}function Ot(e){var t=wn(e)?null:{s:0,n:e};return{next:function(n){for(var r=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,r)for(;t.n.l&&F(n,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!r||F(n,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function mr(e){var t,n,r=(((t=e.r)===null||t===void 0?void 0:t.d)||0)-(((n=e.l)===null||n===void 0?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var a=i==="r"?"l":"r",u=T({},e),o=e[i];e.from=o.from,e.to=o.to,e[i]=o[i],u[i]=o[a],e[a]=u,u.d=gr(u)}e.d=gr(e)}function gr(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}function Ct(e,t){return Q(t).forEach(function(n){e[n]?ot(e[n],t[n]):e[n]=Nn(t[n])}),e}function _n(e,t){return e.all||t.all||Object.keys(e).some(function(n){return t[n]&&yr(t[n],e[n])})}var Te={},xn={},In=!1;function Tt(e,t){Ct(xn,e),In||(In=!0,setTimeout(function(){In=!1;var n=xn;xn={},Sn(n,!1)},0))}function Sn(e,t){t===void 0&&(t=!1);var n=new Set;if(e.all)for(var r=0,i=Object.values(Te);r<i.length;r++){var a=i[r];br(a,e,n,t)}else for(var u in e){var o=/^idb\:\/\/(.*)\/(.*)\//.exec(u);if(o){var s=o[1],c=o[2],a=Te["idb://".concat(s,"/").concat(c)];a&&br(a,e,n,t)}}n.forEach(function(h){return h()})}function br(e,t,n,r){for(var i=[],a=0,u=Object.entries(e.queries.query);a<u.length;a++){for(var o=u[a],s=o[0],c=o[1],h=[],l=0,v=c;l<v.length;l++){var _=v[l];_n(t,_.obsSet)?_.subscribers.forEach(function(y){return n.add(y)}):r&&h.push(_)}r&&i.push([s,h])}if(r)for(var f=0,d=i;f<d.length;f++){var p=d[f],s=p[0],h=p[1];e.queries.query[s]=h}}function Vi(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then(function(){return t.dbOpenError?Y(t.dbOpenError):e});t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller,i=Math.round(e.verno*10),a=!1;function u(){if(t.openCanceller!==r)throw new D.DatabaseClosed("db.open() was cancelled")}var o=t.dbReadyResolve,s=null,c=!1,h=function(){return new E(function(l,v){if(u(),!n)throw new D.MissingAPI;var _=e.name,f=t.autoSchema||!i?n.open(_):n.open(_,i);if(!f)throw new D.MissingAPI;f.onerror=ue(v),f.onblocked=z(e._fireOnBlocked),f.onupgradeneeded=z(function(d){if(s=f.transaction,t.autoSchema&&!e._options.allowEmptyDB){f.onerror=nt,s.abort(),f.result.close();var p=n.deleteDatabase(_);p.onsuccess=p.onerror=z(function(){v(new D.NoSuchDatabase("Database ".concat(_," doesnt exist")))})}else{s.onerror=ue(v);var y=d.oldVersion>Math.pow(2,62)?0:d.oldVersion;c=y<1,e.idbdb=f.result,a&&ki(e,s),Pi(e,y/10,s,v)}},v),f.onsuccess=z(function(){s=null;var d=e.idbdb=f.result,p=ct(d.objectStoreNames);if(p.length>0)try{var y=d.transaction(_i(p),"readonly");if(t.autoSchema)Ti(e,d,y);else if(Dt(e,e._dbSchema,y),!Ri(e,y)&&!a)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),d.close(),i=d.version+1,a=!0,l(h());At(e,y)}catch{}Ue.push(e),d.onversionchange=z(function(g){t.vcFired=!0,e.on("versionchange").fire(g)}),d.onclose=z(function(){e.close({disableAutoOpen:!1})}),c&&ji(e._deps,_),l()},v)}).catch(function(l){switch(l?.name){case"UnknownError":if(t.PR1398_maxLoop>0)return t.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),h();break;case"VersionError":if(i>0)return i=0,h();break}return E.reject(l)})};return E.race([r,(typeof navigator>"u"?E.resolve():Ni()).then(h)]).then(function(){return u(),t.onReadyBeingFired=[],E.resolve(gn(function(){return e.on.ready.fire(e.vip)})).then(function l(){if(t.onReadyBeingFired.length>0){var v=t.onReadyBeingFired.reduce($t,V);return t.onReadyBeingFired=[],E.resolve(gn(function(){return v(e.vip)})).then(l)}})}).finally(function(){t.openCanceller===r&&(t.onReadyBeingFired=null,t.isBeingOpened=!1)}).catch(function(l){t.dbOpenError=l;try{s&&s.abort()}catch{}return r===t.openCanceller&&e._close(),Y(l)}).finally(function(){t.openComplete=!0,o()}).then(function(){if(c){var l={};e.tables.forEach(function(v){v.schema.indexes.forEach(function(_){_.name&&(l["idb://".concat(e.name,"/").concat(v.name,"/").concat(_.name)]=new G(-1/0,[[[]]]))}),l["idb://".concat(e.name,"/").concat(v.name,"/")]=l["idb://".concat(e.name,"/").concat(v.name,"/:dels")]=new G(-1/0,[[[]]])}),we(rt).fire(l),Sn(l,!0)}return e})}function En(e){var t=function(u){return e.next(u)},n=function(u){return e.throw(u)},r=a(t),i=a(n);function a(u){return function(o){var s=u(o),c=s.value;return s.done?c:!c||typeof c.then!="function"?W(c)?Promise.all(c).then(r,i):r(c):c.then(r,i)}}return a(t)()}function zi(e,t,n){var r=arguments.length;if(r<2)throw new D.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var a=jn(i);return[e,a,n]}function wr(e,t,n,r,i){return E.resolve().then(function(){var a=P.transless||P,u=e._createTransaction(t,n,e._dbSchema,r);u.explicit=!0;var o={trans:u,transless:a};if(r)u.idbtrans=r.idbtrans;else try{u.create(),u.idbtrans._explicit=!0,e._state.PR1398_maxLoop=3}catch(l){return l.name===Yt.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e.close({disableAutoOpen:!1}),e.open().then(function(){return wr(e,t,n,null,i)})):Y(l)}var s=Wt(i);s&&We();var c,h=E.follow(function(){if(c=i.call(u,u),c)if(s){var l=me.bind(null,null);c.then(l,l)}else typeof c.next=="function"&&typeof c.throw=="function"&&(c=En(c))},o);return(c&&typeof c.then=="function"?E.resolve(c).then(function(l){return u.active?l:Y(new D.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):h.then(function(){return c})).then(function(l){return r&&u._resolve(),u._completion.then(function(){return l})}).catch(function(l){return u._reject(l),Y(l)})})}function Rt(e,t,n){for(var r=W(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}function Wi(e){return T(T({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},a=[];function u(d,p,y){var g=at(d),b=i[g]=i[g]||[],w=d==null?0:typeof d=="string"?1:d.length,m=p>0,I=T(T({},y),{name:m?"".concat(g,"(virtual-from:").concat(y.name,")"):y.name,lowLevelIndex:y,isVirtual:m,keyTail:p,keyLength:w,extractKey:hn(d),unique:!m&&y.unique});if(b.push(I),I.isPrimaryKey||a.push(I),w>1){var A=w===2?d[0]:d.slice(0,w-1);u(A,p+1,y)}return b.sort(function(S,O){return S.keyTail-O.keyTail}),I}var o=u(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[o];for(var s=0,c=r.indexes;s<c.length;s++){var h=c[s];u(h.keyPath,0,h)}function l(d){var p=i[at(d)];return p&&p[0]}function v(d,p){return{type:d.type===1?2:d.type,lower:Rt(d.lower,d.lowerOpen?e.MAX_KEY:e.MIN_KEY,p),lowerOpen:!0,upper:Rt(d.upper,d.upperOpen?e.MIN_KEY:e.MAX_KEY,p),upperOpen:!0}}function _(d){var p=d.query.index;return p.isVirtual?T(T({},d),{query:{index:p.lowLevelIndex,range:v(d.query.range,p.keyTail)}}):d}var f=T(T({},n),{schema:T(T({},r),{primaryKey:o,indexes:a,getIndexByKeyPath:l}),count:function(d){return n.count(_(d))},query:function(d){return n.query(_(d))},openCursor:function(d){var p=d.query.index,y=p.keyTail,g=p.isVirtual,b=p.keyLength;if(!g)return n.openCursor(d);function w(m){function I(S){S!=null?m.continue(Rt(S,d.reverse?e.MAX_KEY:e.MIN_KEY,y)):d.unique?m.continue(m.key.slice(0,b).concat(d.reverse?e.MIN_KEY:e.MAX_KEY,y)):m.continue()}var A=Object.create(m,{continue:{value:I},continuePrimaryKey:{value:function(S,O){m.continuePrimaryKey(Rt(S,e.MAX_KEY,y),O)}},primaryKey:{get:function(){return m.primaryKey}},key:{get:function(){var S=m.key;return b===1?S[0]:S.slice(0,b)}},value:{get:function(){return m.value}}});return A}return n.openCursor(_(d)).then(function(m){return m&&w(m)})}});return f}})}var Ui={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:Wi};function An(e,t,n,r){return n=n||{},r=r||"",Q(e).forEach(function(i){if(!Z(t,i))n[r+i]=void 0;else{var a=e[i],u=t[i];if(typeof a=="object"&&typeof u=="object"&&a&&u){var o=Vt(a),s=Vt(u);o!==s?n[r+i]=t[i]:o==="Object"?An(a,u,n,r+i+"."):a!==u&&(n[r+i]=t[i])}else a!==u&&(n[r+i]=t[i])}}),Q(t).forEach(function(i){Z(e,i)||(n[r+i]=t[i])}),n}function Kn(e,t){return t.type==="delete"?t.keys:t.keys||t.values.map(e.extractKey)}var Yi={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return T(T({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey,i=T(T({},n),{mutate:function(a){var u=P.trans,o=u.table(t).hook,s=o.deleting,c=o.creating,h=o.updating;switch(a.type){case"add":if(c.fire===V)break;return u._promise("readwrite",function(){return l(a)},!0);case"put":if(c.fire===V&&h.fire===V)break;return u._promise("readwrite",function(){return l(a)},!0);case"delete":if(s.fire===V)break;return u._promise("readwrite",function(){return l(a)},!0);case"deleteRange":if(s.fire===V)break;return u._promise("readwrite",function(){return v(a)},!0)}return n.mutate(a);function l(f){var d=P.trans,p=f.keys||Kn(r,f);if(!p)throw new Error("Keys missing");return f=f.type==="add"||f.type==="put"?T(T({},f),{keys:p}):T({},f),f.type!=="delete"&&(f.values=de([],f.values)),f.keys&&(f.keys=de([],f.keys)),$i(n,f,p).then(function(y){var g=p.map(function(b,w){var m=y[w],I={onerror:null,onsuccess:null};if(f.type==="delete")s.fire.call(I,b,m,d);else if(f.type==="add"||m===void 0){var A=c.fire.call(I,b,f.values[w],d);b==null&&A!=null&&(b=A,f.keys[w]=b,r.outbound||q(f.values[w],r.keyPath,b))}else{var S=An(m,f.values[w]),O=h.fire.call(I,S,b,m,d);if(O){var M=f.values[w];Object.keys(O).forEach(function(K){Z(M,K)?M[K]=O[K]:q(M,K,O[K])})}}return I});return n.mutate(f).then(function(b){for(var w=b.failures,m=b.results,I=b.numFailures,A=b.lastResult,S=0;S<p.length;++S){var O=m?m[S]:p[S],M=g[S];O==null?M.onerror&&M.onerror(w[S]):M.onsuccess&&M.onsuccess(f.type==="put"&&y[S]?f.values[S]:O)}return{failures:w,results:m,numFailures:I,lastResult:A}}).catch(function(b){return g.forEach(function(w){return w.onerror&&w.onerror(b)}),Promise.reject(b)})})}function v(f){return _(f.trans,f.range,1e4)}function _(f,d,p){return n.query({trans:f,values:!1,query:{index:r,range:d},limit:p}).then(function(y){var g=y.result;return l({type:"delete",keys:g,trans:f}).then(function(b){return b.numFailures>0?Promise.reject(b.failures[0]):g.length<p?{failures:[],numFailures:0,lastResult:void 0}:_(f,T(T({},d),{lower:g[g.length-1],lowerOpen:!0}),p)})})}}});return i}})}};function $i(e,t,n){return t.type==="add"?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}function _r(e,t,n){try{if(!t||t.keys.length<e.length)return null;for(var r=[],i=0,a=0;i<t.keys.length&&a<e.length;++i)F(t.keys[i],e[a])===0&&(r.push(n?Se(t.values[i]):t.values[i]),++a);return r.length===e.length?r:null}catch{return null}}var Qi={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return T(T({},n),{getMany:function(r){if(!r.cache)return n.getMany(r);var i=_r(r.keys,r.trans._cache,r.cache==="clone");return i?E.resolve(i):n.getMany(r).then(function(a){return r.trans._cache={keys:r.keys,values:r.cache==="clone"?Se(a):a},a})},mutate:function(r){return r.type!=="add"&&(r.trans._cache=null),n.mutate(r)}})}}}};function xr(e,t){return e.trans.mode==="readonly"&&!!e.subscr&&!e.trans.explicit&&e.trans.db._options.cache!=="disabled"&&!t.schema.primaryKey.outbound}function Ir(e,t){switch(e){case"query":return t.values&&!t.unique;case"get":return!1;case"getMany":return!1;case"count":return!1;case"openCursor":return!1}}var Hi={stack:"dbcore",level:0,name:"Observability",create:function(e){var t=e.schema.name,n=new G(e.MIN_KEY,e.MAX_KEY);return T(T({},e),{transaction:function(r,i,a){if(P.subscr&&i!=="readonly")throw new D.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(P.querier));return e.transaction(r,i,a)},table:function(r){var i=e.table(r),a=i.schema,u=a.primaryKey,o=a.indexes,s=u.extractKey,c=u.outbound,h=u.autoIncrement&&o.filter(function(f){return f.compound&&f.keyPath.includes(u.keyPath)}),l=T(T({},i),{mutate:function(f){var d,p,y=f.trans,g=f.mutatedParts||(f.mutatedParts={}),b=function(R){var j="idb://".concat(t,"/").concat(r,"/").concat(R);return g[j]||(g[j]=new G)},w=b(""),m=b(":dels"),I=f.type,A=f.type==="deleteRange"?[f.range]:f.type==="delete"?[f.keys]:f.values.length<50?[Kn(u,f).filter(function(R){return R}),f.values]:[],S=A[0],O=A[1],M=f.trans._cache;if(W(S)){w.addKeys(S);var K=I==="delete"||S.length===O.length?_r(S,M):null;K||m.addKeys(S),(K||O)&&Gi(b,a,K,O)}else if(S){var B={from:(d=S.lower)!==null&&d!==void 0?d:e.MIN_KEY,to:(p=S.upper)!==null&&p!==void 0?p:e.MAX_KEY};m.add(B),w.add(B)}else w.add(n),m.add(n),a.indexes.forEach(function(R){return b(R.name).add(n)});return i.mutate(f).then(function(R){return S&&(f.type==="add"||f.type==="put")&&(w.addKeys(R.results),h&&h.forEach(function(j){for(var k=f.values.map(function(ee){return j.extractKey(ee)}),U=j.keyPath.findIndex(function(ee){return ee===u.keyPath}),X=0,oe=R.results.length;X<oe;++X)k[X][U]=R.results[X];b(j.name).addKeys(k)})),y.mutatedParts=Ct(y.mutatedParts||{},g),R})}}),v=function(f){var d,p,y=f.query,g=y.index,b=y.range;return[g,new G((d=b.lower)!==null&&d!==void 0?d:e.MIN_KEY,(p=b.upper)!==null&&p!==void 0?p:e.MAX_KEY)]},_={get:function(f){return[u,new G(f.key)]},getMany:function(f){return[u,new G().addKeys(f.keys)]},count:v,query:v,openCursor:v};return Q(_).forEach(function(f){l[f]=function(d){var p=P.subscr,y=!!p,g=xr(P,i)&&Ir(f,d),b=g?d.obsSet={}:p;if(y){var w=function(K){var B="idb://".concat(t,"/").concat(r,"/").concat(K);return b[B]||(b[B]=new G)},m=w(""),I=w(":dels"),A=_[f](d),S=A[0],O=A[1];if(f==="query"&&S.isPrimaryKey&&!d.values?I.add(O):w(S.name||"").add(O),!S.isPrimaryKey)if(f==="count")I.add(n);else{var M=f==="query"&&c&&d.values&&i.query(T(T({},d),{values:!1}));return i[f].apply(this,arguments).then(function(K){if(f==="query"){if(c&&d.values)return M.then(function(k){var U=k.result;return m.addKeys(U),K});var B=d.values?K.result.map(s):K.result;d.values?m.addKeys(B):I.addKeys(B)}else if(f==="openCursor"){var R=K,j=d.values;return R&&Object.create(R,{key:{get:function(){return I.addKey(R.primaryKey),R.key}},primaryKey:{get:function(){var k=R.primaryKey;return I.addKey(k),k}},value:{get:function(){return j&&m.addKey(R.primaryKey),R.value}}})}return K})}}return i[f].apply(this,arguments)}}),l}})}};function Gi(e,t,n,r){function i(a){var u=e(a.name||"");function o(c){return c!=null?a.extractKey(c):null}var s=function(c){return a.multiEntry&&W(c)?c.forEach(function(h){return u.addKey(h)}):u.addKey(c)};(n||r).forEach(function(c,h){var l=n&&o(n[h]),v=r&&o(r[h]);F(l,v)!==0&&(l!=null&&s(l),v!=null&&s(v))})}t.indexes.forEach(i)}function Sr(e,t,n){if(n.numFailures===0)return t;if(t.type==="deleteRange")return null;var r=t.keys?t.keys.length:"values"in t&&t.values?t.values.length:1;if(n.numFailures===r)return null;var i=T({},t);return W(i.keys)&&(i.keys=i.keys.filter(function(a,u){return!(u in n.failures)})),"values"in i&&W(i.values)&&(i.values=i.values.filter(function(a,u){return!(u in n.failures)})),i}function Xi(e,t){return t.lower===void 0?!0:t.lowerOpen?F(e,t.lower)>0:F(e,t.lower)>=0}function Ji(e,t){return t.upper===void 0?!0:t.upperOpen?F(e,t.upper)<0:F(e,t.upper)<=0}function Pn(e,t){return Xi(e,t)&&Ji(e,t)}function Er(e,t,n,r,i,a){if(!n||n.length===0)return e;var u=t.query.index,o=u.multiEntry,s=t.query.range,c=r.schema.primaryKey,h=c.extractKey,l=u.extractKey,v=(u.lowLevelIndex||u).extractKey,_=n.reduce(function(f,d){var p=f,y=[];if(d.type==="add"||d.type==="put")for(var g=new G,b=d.values.length-1;b>=0;--b){var w=d.values[b],m=h(w);if(!g.hasKey(m)){var I=l(w);(o&&W(I)?I.some(function(K){return Pn(K,s)}):Pn(I,s))&&(g.addKey(m),y.push(w))}}switch(d.type){case"add":{var A=new G().addKeys(t.values?f.map(function(K){return h(K)}):f);p=f.concat(t.values?y.filter(function(K){var B=h(K);return A.hasKey(B)?!1:(A.addKey(B),!0)}):y.map(function(K){return h(K)}).filter(function(K){return A.hasKey(K)?!1:(A.addKey(K),!0)}));break}case"put":{var S=new G().addKeys(d.values.map(function(K){return h(K)}));p=f.filter(function(K){return!S.hasKey(t.values?h(K):K)}).concat(t.values?y:y.map(function(K){return h(K)}));break}case"delete":var O=new G().addKeys(d.keys);p=f.filter(function(K){return!O.hasKey(t.values?h(K):K)});break;case"deleteRange":var M=d.range;p=f.filter(function(K){return!Pn(h(K),M)});break}return p},e);return _===e?e:(_.sort(function(f,d){return F(v(f),v(d))||F(h(f),h(d))}),t.limit&&t.limit<1/0&&(_.length>t.limit?_.length=t.limit:e.length===t.limit&&_.length<t.limit&&(i.dirty=!0)),a?Object.freeze(_):_)}function Ar(e,t){return F(e.lower,t.lower)===0&&F(e.upper,t.upper)===0&&!!e.lowerOpen==!!t.lowerOpen&&!!e.upperOpen==!!t.upperOpen}function Zi(e,t,n,r){if(e===void 0)return t!==void 0?-1:0;if(t===void 0)return 1;var i=F(e,t);if(i===0){if(n&&r)return 0;if(n)return 1;if(r)return-1}return i}function qi(e,t,n,r){if(e===void 0)return t!==void 0?1:0;if(t===void 0)return-1;var i=F(e,t);if(i===0){if(n&&r)return 0;if(n)return-1;if(r)return 1}return i}function ea(e,t){return Zi(e.lower,t.lower,e.lowerOpen,t.lowerOpen)<=0&&qi(e.upper,t.upper,e.upperOpen,t.upperOpen)>=0}function ta(e,t,n,r){var i=Te["idb://".concat(e,"/").concat(t)];if(!i)return[];var a=i.queries[n];if(!a)return[null,!1,i,null];var u=r.query?r.query.index.name:null,o=a[u||""];if(!o)return[null,!1,i,null];switch(n){case"query":var s=o.find(function(l){return l.req.limit===r.limit&&l.req.values===r.values&&Ar(l.req.query.range,r.query.range)});if(s)return[s,!0,i,o];var c=o.find(function(l){var v="limit"in l.req?l.req.limit:1/0;return v>=r.limit&&(r.values?l.req.values:!0)&&ea(l.req.query.range,r.query.range)});return[c,!1,i,o];case"count":var h=o.find(function(l){return Ar(l.req.query.range,r.query.range)});return[h,!!h,i,o]}}function na(e,t,n,r){e.subscribers.add(n),r.addEventListener("abort",function(){e.subscribers.delete(n),e.subscribers.size===0&&ra(e,t)})}function ra(e,t){setTimeout(function(){e.subscribers.size===0&&Ee(t,e)},3e3)}var ia={stack:"dbcore",level:0,name:"Cache",create:function(e){var t=e.schema.name,n=T(T({},e),{transaction:function(r,i,a){var u=e.transaction(r,i,a);if(i==="readwrite"){var o=new AbortController,s=o.signal,c=function(h){return function(){if(o.abort(),i==="readwrite"){for(var l=new Set,v=0,_=r;v<_.length;v++){var f=_[v],d=Te["idb://".concat(t,"/").concat(f)];if(d){var p=e.table(f),y=d.optimisticOps.filter(function(j){return j.trans===u});if(u._explicit&&h&&u.mutatedParts)for(var g=0,b=Object.values(d.queries.query);g<b.length;g++)for(var w=b[g],m=0,I=w.slice();m<I.length;m++){var A=I[m];_n(A.obsSet,u.mutatedParts)&&(Ee(w,A),A.subscribers.forEach(function(j){return l.add(j)}))}else if(y.length>0){d.optimisticOps=d.optimisticOps.filter(function(j){return j.trans!==u});for(var S=0,O=Object.values(d.queries.query);S<O.length;S++)for(var w=O[S],M=0,K=w.slice();M<K.length;M++){var A=K[M];if(A.res!=null&&u.mutatedParts)if(h&&!A.dirty){var B=Object.isFrozen(A.res),R=Er(A.res,A.req,y,p,A,B);A.dirty?(Ee(w,A),A.subscribers.forEach(function(U){return l.add(U)})):R!==A.res&&(A.res=R,A.promise=E.resolve({result:R}))}else A.dirty&&Ee(w,A),A.subscribers.forEach(function(U){return l.add(U)})}}}}l.forEach(function(j){return j()})}}};u.addEventListener("abort",c(!1),{signal:s}),u.addEventListener("error",c(!1),{signal:s}),u.addEventListener("complete",c(!0),{signal:s})}return u},table:function(r){var i=e.table(r),a=i.schema.primaryKey,u=T(T({},i),{mutate:function(o){var s=P.trans;if(a.outbound||s.db._options.cache==="disabled"||s.explicit||s.idbtrans.mode!=="readwrite")return i.mutate(o);var c=Te["idb://".concat(t,"/").concat(r)];if(!c)return i.mutate(o);var h=i.mutate(o);return(o.type==="add"||o.type==="put")&&(o.values.length>=50||Kn(a,o).some(function(l){return l==null}))?h.then(function(l){var v=T(T({},o),{values:o.values.map(function(f,d){var p;if(l.failures[d])return f;var y=!((p=a.keyPath)===null||p===void 0)&&p.includes(".")?Se(f):T({},f);return q(y,a.keyPath,l.results[d]),y})}),_=Sr(c,v,l);c.optimisticOps.push(_),queueMicrotask(function(){return o.mutatedParts&&Tt(o.mutatedParts)})}):(c.optimisticOps.push(o),o.mutatedParts&&Tt(o.mutatedParts),h.then(function(l){if(l.numFailures>0){Ee(c.optimisticOps,o);var v=Sr(c,o,l);v&&c.optimisticOps.push(v),o.mutatedParts&&Tt(o.mutatedParts)}}),h.catch(function(){Ee(c.optimisticOps,o),o.mutatedParts&&Tt(o.mutatedParts)})),h},query:function(o){var s;if(!xr(P,i)||!Ir("query",o))return i.query(o);var c=((s=P.trans)===null||s===void 0?void 0:s.db._options.cache)==="immutable",h=P,l=h.requery,v=h.signal,_=ta(t,r,"query",o),f=_[0],d=_[1],p=_[2],y=_[3];if(f&&d)f.obsSet=o.obsSet;else{var g=i.query(o).then(function(b){var w=b.result;if(f&&(f.res=w),c){for(var m=0,I=w.length;m<I;++m)Object.freeze(w[m]);Object.freeze(w)}else b.result=Se(w);return b}).catch(function(b){return y&&f&&Ee(y,f),Promise.reject(b)});f={obsSet:o.obsSet,promise:g,subscribers:new Set,type:"query",req:o,dirty:!1},y?y.push(f):(y=[f],p||(p=Te["idb://".concat(t,"/").concat(r)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}}),p.queries.query[o.query.index.name||""]=y)}return na(f,y,l,v),f.promise.then(function(b){return{result:Er(b.result,o,p?.optimisticOps,i,f,c)}})}});return u}});return n}};function Bt(e,t){return new Proxy(e,{get:function(n,r,i){return r==="db"?t:Reflect.get(n,r,i)}})}var he=(function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=T({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange,cache:"cloned"},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var a=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var u={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:V,dbReadyPromise:null,cancelOpen:V,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:n.autoOpen};u.dbReadyPromise=new E(function(s){u.dbReadyResolve=s}),u.openCanceller=new E(function(s,c){u.cancelOpen=c}),this._state=u,this.name=t,this.on=et(this,"populate","blocked","versionchange","close",{ready:[$t,V]}),this.once=function(s,c){var h=function(){for(var l=[],v=0;v<arguments.length;v++)l[v]=arguments[v];r.on(s).unsubscribe(h),c.apply(r,l)};return r.on(s,h)},this.on.ready.subscribe=Bn(this.on.ready.subscribe,function(s){return function(c,h){e.vip(function(){var l=r._state;if(l.openComplete)l.dbOpenError||E.resolve().then(c),h&&s(c);else if(l.onReadyBeingFired)l.onReadyBeingFired.push(c),h&&s(c);else{s(c);var v=r;h||s(function _(){v.on.ready.unsubscribe(c),v.on.ready.unsubscribe(_)})}})}}),this.Collection=hi(this),this.Table=ci(this),this.Transaction=wi(this),this.Version=Mi(this),this.WhereClause=gi(this),this.on("versionchange",function(s){s.newVersion>0?console.warn("Another connection wants to upgrade database '".concat(r.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(r.name,"'. Closing db now to resume the delete request.")),r.close({disableAutoOpen:!1})}),this.on("blocked",function(s){!s.newVersion||s.newVersion<s.oldVersion?console.warn("Dexie.delete('".concat(r.name,"') was blocked")):console.warn("Upgrade '".concat(r.name,"' blocked by other connection holding version ").concat(s.oldVersion/10))}),this._maxKey=it(n.IDBKeyRange),this._createTransaction=function(s,c,h,l){return new r.Transaction(s,c,h,r._options.chromeTransactionDurability,l)},this._fireOnBlocked=function(s){r.on("blocked").fire(s),Ue.filter(function(c){return c.name===r.name&&c!==r&&!c._state.vcFired}).map(function(c){return c.on("versionchange").fire(s)})},this.use(Qi),this.use(ia),this.use(Hi),this.use(Ui),this.use(Yi);var o=new Proxy(this,{get:function(s,c,h){if(c==="_vip")return!0;if(c==="table")return function(v){return Bt(r.table(v),o)};var l=Reflect.get(s,c,h);return l instanceof ur?Bt(l,o):c==="tables"?l.map(function(v){return Bt(v,o)}):c==="_createTransaction"?function(){var v=l.apply(this,arguments);return Bt(v,o)}:l}});this.vip=o,a.forEach(function(s){return s(r)})}return e.prototype.version=function(t){if(isNaN(t)||t<.1)throw new D.Type("Given version is not a positive number");if(t=Math.round(t*10)/10,this.idbdb||this._state.isBeingOpened)throw new D.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,t);var n=this._versions,r=n.filter(function(i){return i._cfg.version===t})[0];return r||(r=new this.Version(t),n.push(r),n.sort(Ki),r.stores({}),this._state.autoSchema=!1,r)},e.prototype._whenReady=function(t){var n=this;return this.idbdb&&(this._state.openComplete||P.letThrough||this._vip)?t():new E(function(r,i){if(n._state.openComplete)return i(new D.DatabaseClosed(n._state.dbOpenError));if(!n._state.isBeingOpened){if(!n._state.autoOpen){i(new D.DatabaseClosed);return}n.open().catch(V)}n._state.dbReadyPromise.then(r,i)}).then(t)},e.prototype.use=function(t){var n=t.stack,r=t.create,i=t.level,a=t.name;a&&this.unuse({stack:n,name:a});var u=this._middlewares[n]||(this._middlewares[n]=[]);return u.push({stack:n,create:r,level:i??10,name:a}),u.sort(function(o,s){return o.level-s.level}),this},e.prototype.unuse=function(t){var n=t.stack,r=t.name,i=t.create;return n&&this._middlewares[n]&&(this._middlewares[n]=this._middlewares[n].filter(function(a){return i?a.create!==i:r?a.name!==r:!1})),this},e.prototype.open=function(){var t=this;return De(ve,function(){return Vi(t)})},e.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var t=this._state,n=Ue.indexOf(this);if(n>=0&&Ue.splice(n,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}t.isBeingOpened||(t.dbReadyPromise=new E(function(r){t.dbReadyResolve=r}),t.openCanceller=new E(function(r,i){t.cancelOpen=i}))},e.prototype.close=function(t){var n=t===void 0?{disableAutoOpen:!0}:t,r=n.disableAutoOpen,i=this._state;r?(i.isBeingOpened&&i.cancelOpen(new D.DatabaseClosed),this._close(),i.autoOpen=!1,i.dbOpenError=new D.DatabaseClosed):(this._close(),i.autoOpen=this._options.autoOpen||i.isBeingOpened,i.openComplete=!1,i.dbOpenError=null)},e.prototype.delete=function(t){var n=this;t===void 0&&(t={disableAutoOpen:!0});var r=arguments.length>0&&typeof arguments[0]!="object",i=this._state;return new E(function(a,u){var o=function(){n.close(t);var s=n._deps.indexedDB.deleteDatabase(n.name);s.onsuccess=z(function(){Li(n._deps,n.name),a()}),s.onerror=ue(u),s.onblocked=n._fireOnBlocked};if(r)throw new D.InvalidArgument("Invalid closeOptions argument to db.delete()");i.isBeingOpened?i.dbReadyPromise.then(o):o()})},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return this.idbdb!==null},e.prototype.hasBeenClosed=function(){var t=this._state.dbOpenError;return t&&t.name==="DatabaseClosed"},e.prototype.hasFailed=function(){return this._state.dbOpenError!==null},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var t=this;return Q(this._allTables).map(function(n){return t._allTables[n]})},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var t=zi.apply(this,arguments);return this._transaction.apply(this,t)},e.prototype._transaction=function(t,n,r){var i=this,a=P.trans;(!a||a.db!==this||t.indexOf("!")!==-1)&&(a=null);var u=t.indexOf("?")!==-1;t=t.replace("!","").replace("?","");var o,s;try{if(s=n.map(function(h){var l=h instanceof i.Table?h.name:h;if(typeof l!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return l}),t=="r"||t===an)o=an;else if(t=="rw"||t==un)o=un;else throw new D.InvalidArgument("Invalid transaction mode: "+t);if(a){if(a.mode===an&&o===un)if(u)a=null;else throw new D.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");a&&s.forEach(function(h){if(a&&a.storeNames.indexOf(h)===-1)if(u)a=null;else throw new D.SubTransaction("Table "+h+" not included in parent transaction.")}),u&&a&&!a.active&&(a=null)}}catch(h){return a?a._promise(null,function(l,v){v(h)}):Y(h)}var c=wr.bind(null,this,o,s,a,r);return a?a._promise(o,c,"lock"):P.trans?De(P.transless,function(){return i._whenReady(c)}):this._whenReady(c)},e.prototype.table=function(t){if(!Z(this._allTables,t))throw new D.InvalidTable("Table ".concat(t," does not exist"));return this._allTables[t]},e})(),aa=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",ua=(function(){function e(t){this._subscribe=t}return e.prototype.subscribe=function(t,n,r){return this._subscribe(!t||typeof t=="function"?{next:t,error:n,complete:r}:t)},e.prototype[aa]=function(){return this},e})(),Mt;try{Mt={indexedDB:$.indexedDB||$.mozIndexedDB||$.webkitIndexedDB||$.msIndexedDB,IDBKeyRange:$.IDBKeyRange||$.webkitIDBKeyRange}}catch{Mt={indexedDB:null,IDBKeyRange:null}}function Kr(e){var t=!1,n,r=new ua(function(i){var a=Wt(e);function u(y){var g=Ve();try{a&&We();var b=ye(e,y);return a&&(b=b.finally(me)),b}finally{g&&ze()}}var o=!1,s,c={},h={},l={get closed(){return o},unsubscribe:function(){o||(o=!0,s&&s.abort(),v&&we.storagemutated.unsubscribe(d))}};i.start&&i.start(l);var v=!1,_=function(){return tn(p)};function f(){return _n(h,c)}var d=function(y){Ct(c,y),f()&&_()},p=function(){if(!(o||!Mt.indexedDB)){c={};var y={};s&&s.abort(),s=new AbortController;var g={subscr:y,signal:s.signal,requery:_,querier:e,trans:null},b=u(g);Promise.resolve(b).then(function(w){t=!0,n=w,!(o||g.signal.aborted)&&(c={},h=y,!Fr(h)&&!v&&(we(rt,d),v=!0),tn(function(){return!o&&i.next&&i.next(w)}))},function(w){t=!1,["DatabaseClosedError","AbortError"].includes(w?.name)||o||tn(function(){o||i.error&&i.error(w)})})}};return setTimeout(_,0),l});return r.hasValue=function(){return t},r.getValue=function(){return n},r}var Re=he;Me(Re,T(T({},ft),{delete:function(e){var t=new Re(e,{addons:[]});return t.delete()},exists:function(e){return new Re(e,{addons:[]}).open().then(function(t){return t.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(e){try{return Fi(Re.dependencies).then(e)}catch{return Y(new D.MissingAPI)}},defineClass:function(){function e(t){te(this,t)}return e},ignoreTransaction:function(e){return P.trans?De(P.transless,e):e()},vip:gn,async:function(e){return function(){try{var t=En(e.apply(this,arguments));return!t||typeof t.then!="function"?E.resolve(t):t}catch(n){return Y(n)}}},spawn:function(e,t,n){try{var r=En(e.apply(n,t||[]));return!r||typeof r.then!="function"?E.resolve(r):r}catch(i){return Y(i)}},currentTransaction:{get:function(){return P.trans||null}},waitFor:function(e,t){var n=E.resolve(typeof e=="function"?Re.ignoreTransaction(e):e).timeout(t||6e4);return P.trans?P.trans.waitFor(n):n},Promise:E,debug:{get:function(){return ae},set:function(e){Un(e)}},derive:Fe,extend:te,props:Me,override:Bn,Events:et,on:we,liveQuery:Kr,extendObservabilitySet:Ct,getByKeyPath:ce,setByKeyPath:q,delByKeyPath:Rr,shallowClone:Fn,deepClone:Se,getObjectDiff:An,cmp:F,asap:Mn,minKey:rn,addons:[],connections:Ue,errnames:Yt,dependencies:Mt,cache:Te,semVer:qn,version:qn.split(".").map(function(e){return parseInt(e)}).reduce(function(e,t,n){return e+t/Math.pow(10,n*2)})})),Re.maxKey=it(Re.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(we(rt,function(e){if(!_e){var t;t=new CustomEvent(cn,{detail:e}),_e=!0,dispatchEvent(t),_e=!1}}),addEventListener(cn,function(e){var t=e.detail;_e||kn(t)}));function kn(e){var t=_e;try{_e=!0,we.storagemutated.fire(e),Sn(e,!0)}finally{_e=t}}var _e=!1,xe,Dn=function(){};typeof BroadcastChannel<"u"&&(Dn=function(){xe=new BroadcastChannel(cn),xe.onmessage=function(e){return e.data&&kn(e.data)}},Dn(),typeof xe.unref=="function"&&xe.unref(),we(rt,function(e){_e||xe.postMessage(e)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(e){if(!he.disableBfCache&&e.persisted){ae&&console.debug("Dexie: handling persisted pagehide"),xe?.close();for(var t=0,n=Ue;t<n.length;t++){var r=n[t];r.close({disableAutoOpen:!1})}}}),addEventListener("pageshow",function(e){!he.disableBfCache&&e.persisted&&(ae&&console.debug("Dexie: handling persisted pageshow"),Dn(),kn({all:new G(-1/0,[[]])}))}));function oa(e){return new qe({add:e})}function sa(e){return new qe({remove:e})}function ca(e,t){return new qe({replacePrefix:[e,t]})}E.rejectionMapper=Wr,Un(ae);var la=Object.freeze({__proto__:null,Dexie:he,liveQuery:Kr,Entity:nr,cmp:F,PropModification:qe,replacePrefix:ca,add:oa,remove:sa,default:he,RangeSet:G,mergeRanges:ot,rangesOverlap:yr});return T(he,la,{default:he}),he}))})(jt)),jt.exports}var ba=ga();const Cn=da(ba),kr=Symbol.for("Dexie"),Lt=globalThis[kr]||(globalThis[kr]=Cn);if(Cn.semVer!==Lt.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Cn.semVer} and ${Lt.semVer}`);const{liveQuery:Ia,mergeRanges:Sa,rangesOverlap:Ea,RangeSet:Aa,cmp:Ka,Entity:Pa,PropModification:ka,replacePrefix:Da,add:Oa,remove:Ca,DexieYProvider:Ta}=Lt;class wa extends Lt{users;userPreferences;songs;arrangements;snapshots;spaces;memberships;sessions;sessionParticipants;syncStates;conflicts;customInstruments;localFingerings;songMetadata;songSets;constructor(){super("gigwidget"),this.version(1).stores({users:"id, supabaseId, createdAt",userPreferences:"userId",songs:"id, ownerId, title, artist, visibility, updatedAt, *tags, *spaceIds",arrangements:"id, songId, instrument, updatedAt",snapshots:"id, songId, arrangementId, createdAt",spaces:"id, ownerId, type, name, createdAt",memberships:"id, userId, spaceId, role",sessions:"id, hostId, type, createdAt, expiresAt",sessionParticipants:"[sessionId+userId], sessionId, userId",syncStates:"userId, syncStatus",conflicts:"id, songId, arrangementId, resolved, detectedAt"}),this.version(2).stores({users:"id, supabaseId, createdAt",userPreferences:"userId",songs:"id, ownerId, title, artist, visibility, updatedAt, *tags, *spaceIds",arrangements:"id, songId, instrument, updatedAt",snapshots:"id, songId, arrangementId, createdAt",spaces:"id, ownerId, type, name, createdAt",memberships:"id, userId, spaceId, role",sessions:"id, hostId, type, createdAt, expiresAt",sessionParticipants:"[sessionId+userId], sessionId, userId",syncStates:"userId, syncStatus",conflicts:"id, songId, arrangementId, resolved, detectedAt",customInstruments:"id, userId, name, baseType, isPublic",localFingerings:"id, userId, chordName, instrumentId, [userId+chordName+instrumentId]",songMetadata:"songId",songSets:"id, userId, parentSetId, name, isSetlist"})}}let On=null;function N(){return On||(On=new wa),On}async function Ra(){const x=N(),C=await x.users.toArray();if(C.length>0)return C[0];const L=pa(),J={userId:L.id,autoSaveInterval:5e3,snapshotRetention:10},T=va(L.id,"My Library","personal",{description:"Your personal song library"}),de={id:ya(),userId:L.id,spaceId:T.id,role:"owner",joinedAt:new Date},$={userId:L.id,lastLocalUpdate:new Date,pendingChanges:0,syncStatus:"idle"};return await x.transaction("rw",[x.users,x.userPreferences,x.spaces,x.memberships,x.syncStates],async()=>{await x.users.add(L),await x.userPreferences.add(J),await x.spaces.add(T),await x.memberships.add(de),await x.syncStates.add($)}),L}const Ba={async getById(x){return N().songs.get(x)},async getByOwner(x){return N().songs.where({ownerId:x}).toArray()},async getBySpace(x){return N().songs.filter(C=>C.spaceIds.includes(x)).toArray()},async getByVisibility(x){return N().songs.where({visibility:x}).toArray()},async search(x){const C=x.toLowerCase();return N().songs.filter(L=>L.title.toLowerCase().includes(C)||L.artist?.toLowerCase().includes(C)||L.tags.some(J=>J.toLowerCase().includes(C))).toArray()},async create(x){return N().songs.add(x)},async update(x,C){return N().songs.update(x,{...C,updatedAt:new Date})},async delete(x){const C=N();await C.transaction("rw",[C.songs,C.arrangements,C.snapshots],async()=>{await C.snapshots.where({songId:x}).delete(),await C.arrangements.where({songId:x}).delete(),await C.songs.delete(x)})},async addToSpace(x,C){const L=await this.getById(x);L&&!L.spaceIds.includes(C)&&await this.update(x,{spaceIds:[...L.spaceIds,C]})},async removeFromSpace(x,C){const L=await this.getById(x);L&&await this.update(x,{spaceIds:L.spaceIds.filter(J=>J!==C)})}},Ma={async getById(x){return N().arrangements.get(x)},async getBySong(x){return N().arrangements.where({songId:x}).toArray()},async getByInstrument(x){return N().arrangements.where({instrument:x}).toArray()},async create(x){return N().arrangements.add(x)},async update(x,C){return N().arrangements.update(x,{...C,updatedAt:new Date})},async delete(x){const C=N();await C.transaction("rw",[C.arrangements,C.snapshots],async()=>{await C.snapshots.where({arrangementId:x}).delete(),await C.arrangements.delete(x)})}},Fa={async getById(x){return N().customInstruments.get(x)},async getByUser(x){return N().customInstruments.where({userId:x}).toArray()},async getPublic(){return N().customInstruments.where({isPublic:1}).toArray()},async getByBaseType(x){return N().customInstruments.where({baseType:x}).toArray()},async create(x){return N().customInstruments.add(x)},async update(x,C){return N().customInstruments.update(x,{...C,updatedAt:new Date})},async delete(x){await N().customInstruments.delete(x)}},ja={async getById(x){return N().songSets.get(x)},async getByUser(x){return N().songSets.where({userId:x}).toArray()},async getRootSets(x){return N().songSets.where({userId:x}).filter(C=>!C.parentSetId).toArray()},async getChildSets(x){return N().songSets.where({parentSetId:x}).toArray()},async getSetlists(x){return N().songSets.where({userId:x}).filter(C=>C.isSetlist).toArray()},async create(x){return N().songSets.add(x)},async update(x,C){return N().songSets.update(x,{...C,updatedAt:new Date})},async delete(x){const C=await this.getChildSets(x);for(const L of C)await this.delete(L.id);await N().songSets.delete(x)},async addSong(x,C){const L=await this.getById(x);L&&!L.songIds.includes(C)&&await this.update(x,{songIds:[...L.songIds,C]})},async removeSong(x,C){const L=await this.getById(x);L&&await this.update(x,{songIds:L.songIds.filter(J=>J!==C)})},async reorderSongs(x,C){await this.update(x,{songIds:C})},async moveSong(x,C,L){const J=await this.getById(x);if(!J)return;const T=[...J.songIds],[de]=T.splice(C,1);T.splice(L,0,de),await this.update(x,{songIds:T})}};export{Ma as ArrangementRepository,Fa as CustomInstrumentRepository,wa as GigwidgetDatabase,Ba as SongRepository,ja as SongSetRepository,N as getDatabase,Ra as initializeDatabase};
//# sourceMappingURL=DhSYb-d6.js.map
