{"version":3,"file":"DhSYb-d6.js","sources":["../../../../../../../../node_modules/.pnpm/dexie@4.2.1/node_modules/dexie/dist/dexie.js","../../../../../../../../node_modules/.pnpm/dexie@4.2.1/node_modules/dexie/import-wrapper.mjs","../../../../../../../../packages/db/dist/schema.js","../../../../../../../../packages/db/dist/repositories/index.js"],"sourcesContent":["/*\n * Dexie.js - a minimalistic wrapper for IndexedDB\n * ===============================================\n *\n * By David Fahlander, david.fahlander@gmail.com\n *\n * Version 4.2.1, Sat Oct 04 2025\n *\n * https://dexie.org\n *\n * Apache License Version 2.0, January 2004, http://www.apache.org/licenses/\n */\n \n(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define(factory) :\n    (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.Dexie = factory());\n})(this, (function () { 'use strict';\n\n    /*! *****************************************************************************\n    Copyright (c) Microsoft Corporation.\n    Permission to use, copy, modify, and/or distribute this software for any\n    purpose with or without fee is hereby granted.\n    THE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\n    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\n    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\n    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\n    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\n    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\n    PERFORMANCE OF THIS SOFTWARE.\n    ***************************************************************************** */\n    var extendStatics = function(d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    function __extends(d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    }\n    var __assign = function() {\n        __assign = Object.assign || function __assign(t) {\n            for (var s, i = 1, n = arguments.length; i < n; i++) {\n                s = arguments[i];\n                for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n            }\n            return t;\n        };\n        return __assign.apply(this, arguments);\n    };\n    function __spreadArray(to, from, pack) {\n        if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n            if (ar || !(i in from)) {\n                if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n                ar[i] = from[i];\n            }\n        }\n        return to.concat(ar || Array.prototype.slice.call(from));\n    }\n\n    var _global = typeof globalThis !== 'undefined' ? globalThis :\n        typeof self !== 'undefined' ? self :\n            typeof window !== 'undefined' ? window :\n                global;\n\n    var keys = Object.keys;\n    var isArray = Array.isArray;\n    if (typeof Promise !== 'undefined' && !_global.Promise) {\n        _global.Promise = Promise;\n    }\n    function extend(obj, extension) {\n        if (typeof extension !== 'object')\n            return obj;\n        keys(extension).forEach(function (key) {\n            obj[key] = extension[key];\n        });\n        return obj;\n    }\n    var getProto = Object.getPrototypeOf;\n    var _hasOwn = {}.hasOwnProperty;\n    function hasOwn(obj, prop) {\n        return _hasOwn.call(obj, prop);\n    }\n    function props(proto, extension) {\n        if (typeof extension === 'function')\n            extension = extension(getProto(proto));\n        (typeof Reflect === \"undefined\" ? keys : Reflect.ownKeys)(extension).forEach(function (key) {\n            setProp(proto, key, extension[key]);\n        });\n    }\n    var defineProperty = Object.defineProperty;\n    function setProp(obj, prop, functionOrGetSet, options) {\n        defineProperty(obj, prop, extend(functionOrGetSet && hasOwn(functionOrGetSet, \"get\") && typeof functionOrGetSet.get === 'function' ?\n            { get: functionOrGetSet.get, set: functionOrGetSet.set, configurable: true } :\n            { value: functionOrGetSet, configurable: true, writable: true }, options));\n    }\n    function derive(Child) {\n        return {\n            from: function (Parent) {\n                Child.prototype = Object.create(Parent.prototype);\n                setProp(Child.prototype, \"constructor\", Child);\n                return {\n                    extend: props.bind(null, Child.prototype)\n                };\n            }\n        };\n    }\n    var getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n    function getPropertyDescriptor(obj, prop) {\n        var pd = getOwnPropertyDescriptor(obj, prop);\n        var proto;\n        return pd || (proto = getProto(obj)) && getPropertyDescriptor(proto, prop);\n    }\n    var _slice = [].slice;\n    function slice(args, start, end) {\n        return _slice.call(args, start, end);\n    }\n    function override(origFunc, overridedFactory) {\n        return overridedFactory(origFunc);\n    }\n    function assert(b) {\n        if (!b)\n            throw new Error(\"Assertion Failed\");\n    }\n    function asap$1(fn) {\n        if (_global.setImmediate)\n            setImmediate(fn);\n        else\n            setTimeout(fn, 0);\n    }\n    function arrayToObject(array, extractor) {\n        return array.reduce(function (result, item, i) {\n            var nameAndValue = extractor(item, i);\n            if (nameAndValue)\n                result[nameAndValue[0]] = nameAndValue[1];\n            return result;\n        }, {});\n    }\n    function getByKeyPath(obj, keyPath) {\n        if (typeof keyPath === 'string' && hasOwn(obj, keyPath))\n            return obj[keyPath];\n        if (!keyPath)\n            return obj;\n        if (typeof keyPath !== 'string') {\n            var rv = [];\n            for (var i = 0, l = keyPath.length; i < l; ++i) {\n                var val = getByKeyPath(obj, keyPath[i]);\n                rv.push(val);\n            }\n            return rv;\n        }\n        var period = keyPath.indexOf('.');\n        if (period !== -1) {\n            var innerObj = obj[keyPath.substr(0, period)];\n            return innerObj == null ? undefined : getByKeyPath(innerObj, keyPath.substr(period + 1));\n        }\n        return undefined;\n    }\n    function setByKeyPath(obj, keyPath, value) {\n        if (!obj || keyPath === undefined)\n            return;\n        if ('isFrozen' in Object && Object.isFrozen(obj))\n            return;\n        if (typeof keyPath !== 'string' && 'length' in keyPath) {\n            assert(typeof value !== 'string' && 'length' in value);\n            for (var i = 0, l = keyPath.length; i < l; ++i) {\n                setByKeyPath(obj, keyPath[i], value[i]);\n            }\n        }\n        else {\n            var period = keyPath.indexOf('.');\n            if (period !== -1) {\n                var currentKeyPath = keyPath.substr(0, period);\n                var remainingKeyPath = keyPath.substr(period + 1);\n                if (remainingKeyPath === \"\")\n                    if (value === undefined) {\n                        if (isArray(obj) && !isNaN(parseInt(currentKeyPath)))\n                            obj.splice(currentKeyPath, 1);\n                        else\n                            delete obj[currentKeyPath];\n                    }\n                    else\n                        obj[currentKeyPath] = value;\n                else {\n                    var innerObj = obj[currentKeyPath];\n                    if (!innerObj || !hasOwn(obj, currentKeyPath))\n                        innerObj = (obj[currentKeyPath] = {});\n                    setByKeyPath(innerObj, remainingKeyPath, value);\n                }\n            }\n            else {\n                if (value === undefined) {\n                    if (isArray(obj) && !isNaN(parseInt(keyPath)))\n                        obj.splice(keyPath, 1);\n                    else\n                        delete obj[keyPath];\n                }\n                else\n                    obj[keyPath] = value;\n            }\n        }\n    }\n    function delByKeyPath(obj, keyPath) {\n        if (typeof keyPath === 'string')\n            setByKeyPath(obj, keyPath, undefined);\n        else if ('length' in keyPath)\n            [].map.call(keyPath, function (kp) {\n                setByKeyPath(obj, kp, undefined);\n            });\n    }\n    function shallowClone(obj) {\n        var rv = {};\n        for (var m in obj) {\n            if (hasOwn(obj, m))\n                rv[m] = obj[m];\n        }\n        return rv;\n    }\n    var concat = [].concat;\n    function flatten(a) {\n        return concat.apply([], a);\n    }\n    var intrinsicTypeNames = \"BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey\"\n        .split(',').concat(flatten([8, 16, 32, 64].map(function (num) { return [\"Int\", \"Uint\", \"Float\"].map(function (t) { return t + num + \"Array\"; }); }))).filter(function (t) { return _global[t]; });\n    var intrinsicTypes = new Set(intrinsicTypeNames.map(function (t) { return _global[t]; }));\n    function cloneSimpleObjectTree(o) {\n        var rv = {};\n        for (var k in o)\n            if (hasOwn(o, k)) {\n                var v = o[k];\n                rv[k] = !v || typeof v !== 'object' || intrinsicTypes.has(v.constructor) ? v : cloneSimpleObjectTree(v);\n            }\n        return rv;\n    }\n    function objectIsEmpty(o) {\n        for (var k in o)\n            if (hasOwn(o, k))\n                return false;\n        return true;\n    }\n    var circularRefs = null;\n    function deepClone(any) {\n        circularRefs = new WeakMap();\n        var rv = innerDeepClone(any);\n        circularRefs = null;\n        return rv;\n    }\n    function innerDeepClone(x) {\n        if (!x || typeof x !== 'object')\n            return x;\n        var rv = circularRefs.get(x);\n        if (rv)\n            return rv;\n        if (isArray(x)) {\n            rv = [];\n            circularRefs.set(x, rv);\n            for (var i = 0, l = x.length; i < l; ++i) {\n                rv.push(innerDeepClone(x[i]));\n            }\n        }\n        else if (intrinsicTypes.has(x.constructor)) {\n            rv = x;\n        }\n        else {\n            var proto = getProto(x);\n            rv = proto === Object.prototype ? {} : Object.create(proto);\n            circularRefs.set(x, rv);\n            for (var prop in x) {\n                if (hasOwn(x, prop)) {\n                    rv[prop] = innerDeepClone(x[prop]);\n                }\n            }\n        }\n        return rv;\n    }\n    var toString = {}.toString;\n    function toStringTag(o) {\n        return toString.call(o).slice(8, -1);\n    }\n    var iteratorSymbol = typeof Symbol !== 'undefined' ?\n        Symbol.iterator :\n        '@@iterator';\n    var getIteratorOf = typeof iteratorSymbol === \"symbol\" ? function (x) {\n        var i;\n        return x != null && (i = x[iteratorSymbol]) && i.apply(x);\n    } : function () { return null; };\n    function delArrayItem(a, x) {\n        var i = a.indexOf(x);\n        if (i >= 0)\n            a.splice(i, 1);\n        return i >= 0;\n    }\n    var NO_CHAR_ARRAY = {};\n    function getArrayOf(arrayLike) {\n        var i, a, x, it;\n        if (arguments.length === 1) {\n            if (isArray(arrayLike))\n                return arrayLike.slice();\n            if (this === NO_CHAR_ARRAY && typeof arrayLike === 'string')\n                return [arrayLike];\n            if ((it = getIteratorOf(arrayLike))) {\n                a = [];\n                while ((x = it.next()), !x.done)\n                    a.push(x.value);\n                return a;\n            }\n            if (arrayLike == null)\n                return [arrayLike];\n            i = arrayLike.length;\n            if (typeof i === 'number') {\n                a = new Array(i);\n                while (i--)\n                    a[i] = arrayLike[i];\n                return a;\n            }\n            return [arrayLike];\n        }\n        i = arguments.length;\n        a = new Array(i);\n        while (i--)\n            a[i] = arguments[i];\n        return a;\n    }\n    var isAsyncFunction = typeof Symbol !== 'undefined'\n        ? function (fn) { return fn[Symbol.toStringTag] === 'AsyncFunction'; }\n        : function () { return false; };\n\n    var dexieErrorNames = [\n        'Modify',\n        'Bulk',\n        'OpenFailed',\n        'VersionChange',\n        'Schema',\n        'Upgrade',\n        'InvalidTable',\n        'MissingAPI',\n        'NoSuchDatabase',\n        'InvalidArgument',\n        'SubTransaction',\n        'Unsupported',\n        'Internal',\n        'DatabaseClosed',\n        'PrematureCommit',\n        'ForeignAwait'\n    ];\n    var idbDomErrorNames = [\n        'Unknown',\n        'Constraint',\n        'Data',\n        'TransactionInactive',\n        'ReadOnly',\n        'Version',\n        'NotFound',\n        'InvalidState',\n        'InvalidAccess',\n        'Abort',\n        'Timeout',\n        'QuotaExceeded',\n        'Syntax',\n        'DataClone'\n    ];\n    var errorList = dexieErrorNames.concat(idbDomErrorNames);\n    var defaultTexts = {\n        VersionChanged: \"Database version changed by other database connection\",\n        DatabaseClosed: \"Database has been closed\",\n        Abort: \"Transaction aborted\",\n        TransactionInactive: \"Transaction has already completed or failed\",\n        MissingAPI: \"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb\"\n    };\n    function DexieError(name, msg) {\n        this.name = name;\n        this.message = msg;\n    }\n    derive(DexieError).from(Error).extend({\n        toString: function () { return this.name + \": \" + this.message; }\n    });\n    function getMultiErrorMessage(msg, failures) {\n        return msg + \". Errors: \" + Object.keys(failures)\n            .map(function (key) { return failures[key].toString(); })\n            .filter(function (v, i, s) { return s.indexOf(v) === i; })\n            .join('\\n');\n    }\n    function ModifyError(msg, failures, successCount, failedKeys) {\n        this.failures = failures;\n        this.failedKeys = failedKeys;\n        this.successCount = successCount;\n        this.message = getMultiErrorMessage(msg, failures);\n    }\n    derive(ModifyError).from(DexieError);\n    function BulkError(msg, failures) {\n        this.name = \"BulkError\";\n        this.failures = Object.keys(failures).map(function (pos) { return failures[pos]; });\n        this.failuresByPos = failures;\n        this.message = getMultiErrorMessage(msg, this.failures);\n    }\n    derive(BulkError).from(DexieError);\n    var errnames = errorList.reduce(function (obj, name) { return (obj[name] = name + \"Error\", obj); }, {});\n    var BaseException = DexieError;\n    var exceptions = errorList.reduce(function (obj, name) {\n        var fullName = name + \"Error\";\n        function DexieError(msgOrInner, inner) {\n            this.name = fullName;\n            if (!msgOrInner) {\n                this.message = defaultTexts[name] || fullName;\n                this.inner = null;\n            }\n            else if (typeof msgOrInner === 'string') {\n                this.message = \"\".concat(msgOrInner).concat(!inner ? '' : '\\n ' + inner);\n                this.inner = inner || null;\n            }\n            else if (typeof msgOrInner === 'object') {\n                this.message = \"\".concat(msgOrInner.name, \" \").concat(msgOrInner.message);\n                this.inner = msgOrInner;\n            }\n        }\n        derive(DexieError).from(BaseException);\n        obj[name] = DexieError;\n        return obj;\n    }, {});\n    exceptions.Syntax = SyntaxError;\n    exceptions.Type = TypeError;\n    exceptions.Range = RangeError;\n    var exceptionMap = idbDomErrorNames.reduce(function (obj, name) {\n        obj[name + \"Error\"] = exceptions[name];\n        return obj;\n    }, {});\n    function mapError(domError, message) {\n        if (!domError || domError instanceof DexieError || domError instanceof TypeError || domError instanceof SyntaxError || !domError.name || !exceptionMap[domError.name])\n            return domError;\n        var rv = new exceptionMap[domError.name](message || domError.message, domError);\n        if (\"stack\" in domError) {\n            setProp(rv, \"stack\", { get: function () {\n                    return this.inner.stack;\n                } });\n        }\n        return rv;\n    }\n    var fullNameExceptions = errorList.reduce(function (obj, name) {\n        if ([\"Syntax\", \"Type\", \"Range\"].indexOf(name) === -1)\n            obj[name + \"Error\"] = exceptions[name];\n        return obj;\n    }, {});\n    fullNameExceptions.ModifyError = ModifyError;\n    fullNameExceptions.DexieError = DexieError;\n    fullNameExceptions.BulkError = BulkError;\n\n    function nop() { }\n    function mirror(val) { return val; }\n    function pureFunctionChain(f1, f2) {\n        if (f1 == null || f1 === mirror)\n            return f2;\n        return function (val) {\n            return f2(f1(val));\n        };\n    }\n    function callBoth(on1, on2) {\n        return function () {\n            on1.apply(this, arguments);\n            on2.apply(this, arguments);\n        };\n    }\n    function hookCreatingChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            var res = f1.apply(this, arguments);\n            if (res !== undefined)\n                arguments[0] = res;\n            var onsuccess = this.onsuccess,\n            onerror = this.onerror;\n            this.onsuccess = null;\n            this.onerror = null;\n            var res2 = f2.apply(this, arguments);\n            if (onsuccess)\n                this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n            if (onerror)\n                this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n            return res2 !== undefined ? res2 : res;\n        };\n    }\n    function hookDeletingChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            f1.apply(this, arguments);\n            var onsuccess = this.onsuccess,\n            onerror = this.onerror;\n            this.onsuccess = this.onerror = null;\n            f2.apply(this, arguments);\n            if (onsuccess)\n                this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n            if (onerror)\n                this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n        };\n    }\n    function hookUpdatingChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function (modifications) {\n            var res = f1.apply(this, arguments);\n            extend(modifications, res);\n            var onsuccess = this.onsuccess,\n            onerror = this.onerror;\n            this.onsuccess = null;\n            this.onerror = null;\n            var res2 = f2.apply(this, arguments);\n            if (onsuccess)\n                this.onsuccess = this.onsuccess ? callBoth(onsuccess, this.onsuccess) : onsuccess;\n            if (onerror)\n                this.onerror = this.onerror ? callBoth(onerror, this.onerror) : onerror;\n            return res === undefined ?\n                (res2 === undefined ? undefined : res2) :\n                (extend(res, res2));\n        };\n    }\n    function reverseStoppableEventChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            if (f2.apply(this, arguments) === false)\n                return false;\n            return f1.apply(this, arguments);\n        };\n    }\n    function promisableChain(f1, f2) {\n        if (f1 === nop)\n            return f2;\n        return function () {\n            var res = f1.apply(this, arguments);\n            if (res && typeof res.then === 'function') {\n                var thiz = this, i = arguments.length, args = new Array(i);\n                while (i--)\n                    args[i] = arguments[i];\n                return res.then(function () {\n                    return f2.apply(thiz, args);\n                });\n            }\n            return f2.apply(this, arguments);\n        };\n    }\n\n    var debug = typeof location !== 'undefined' &&\n        /^(http|https):\\/\\/(localhost|127\\.0\\.0\\.1)/.test(location.href);\n    function setDebug(value, filter) {\n        debug = value;\n    }\n\n    var INTERNAL = {};\n    var ZONE_ECHO_LIMIT = 100, _a$1 = typeof Promise === 'undefined' ?\n        [] :\n        (function () {\n            var globalP = Promise.resolve();\n            if (typeof crypto === 'undefined' || !crypto.subtle)\n                return [globalP, getProto(globalP), globalP];\n            var nativeP = crypto.subtle.digest(\"SHA-512\", new Uint8Array([0]));\n            return [\n                nativeP,\n                getProto(nativeP),\n                globalP\n            ];\n        })(), resolvedNativePromise = _a$1[0], nativePromiseProto = _a$1[1], resolvedGlobalPromise = _a$1[2], nativePromiseThen = nativePromiseProto && nativePromiseProto.then;\n    var NativePromise = resolvedNativePromise && resolvedNativePromise.constructor;\n    var patchGlobalPromise = !!resolvedGlobalPromise;\n    function schedulePhysicalTick() {\n        queueMicrotask(physicalTick);\n    }\n    var asap = function (callback, args) {\n        microtickQueue.push([callback, args]);\n        if (needsNewPhysicalTick) {\n            schedulePhysicalTick();\n            needsNewPhysicalTick = false;\n        }\n    };\n    var isOutsideMicroTick = true,\n    needsNewPhysicalTick = true,\n    unhandledErrors = [],\n    rejectingErrors = [],\n    rejectionMapper = mirror;\n    var globalPSD = {\n        id: 'global',\n        global: true,\n        ref: 0,\n        unhandleds: [],\n        onunhandled: nop,\n        pgp: false,\n        env: {},\n        finalize: nop\n    };\n    var PSD = globalPSD;\n    var microtickQueue = [];\n    var numScheduledCalls = 0;\n    var tickFinalizers = [];\n    function DexiePromise(fn) {\n        if (typeof this !== 'object')\n            throw new TypeError('Promises must be constructed via new');\n        this._listeners = [];\n        this._lib = false;\n        var psd = (this._PSD = PSD);\n        if (typeof fn !== 'function') {\n            if (fn !== INTERNAL)\n                throw new TypeError('Not a function');\n            this._state = arguments[1];\n            this._value = arguments[2];\n            if (this._state === false)\n                handleRejection(this, this._value);\n            return;\n        }\n        this._state = null;\n        this._value = null;\n        ++psd.ref;\n        executePromiseTask(this, fn);\n    }\n    var thenProp = {\n        get: function () {\n            var psd = PSD, microTaskId = totalEchoes;\n            function then(onFulfilled, onRejected) {\n                var _this = this;\n                var possibleAwait = !psd.global && (psd !== PSD || microTaskId !== totalEchoes);\n                var cleanup = possibleAwait && !decrementExpectedAwaits();\n                var rv = new DexiePromise(function (resolve, reject) {\n                    propagateToListener(_this, new Listener(nativeAwaitCompatibleWrap(onFulfilled, psd, possibleAwait, cleanup), nativeAwaitCompatibleWrap(onRejected, psd, possibleAwait, cleanup), resolve, reject, psd));\n                });\n                if (this._consoleTask)\n                    rv._consoleTask = this._consoleTask;\n                return rv;\n            }\n            then.prototype = INTERNAL;\n            return then;\n        },\n        set: function (value) {\n            setProp(this, 'then', value && value.prototype === INTERNAL ?\n                thenProp :\n                {\n                    get: function () {\n                        return value;\n                    },\n                    set: thenProp.set\n                });\n        }\n    };\n    props(DexiePromise.prototype, {\n        then: thenProp,\n        _then: function (onFulfilled, onRejected) {\n            propagateToListener(this, new Listener(null, null, onFulfilled, onRejected, PSD));\n        },\n        catch: function (onRejected) {\n            if (arguments.length === 1)\n                return this.then(null, onRejected);\n            var type = arguments[0], handler = arguments[1];\n            return typeof type === 'function' ? this.then(null, function (err) {\n                return err instanceof type ? handler(err) : PromiseReject(err);\n            })\n                : this.then(null, function (err) {\n                    return err && err.name === type ? handler(err) : PromiseReject(err);\n                });\n        },\n        finally: function (onFinally) {\n            return this.then(function (value) {\n                return DexiePromise.resolve(onFinally()).then(function () { return value; });\n            }, function (err) {\n                return DexiePromise.resolve(onFinally()).then(function () { return PromiseReject(err); });\n            });\n        },\n        timeout: function (ms, msg) {\n            var _this = this;\n            return ms < Infinity ?\n                new DexiePromise(function (resolve, reject) {\n                    var handle = setTimeout(function () { return reject(new exceptions.Timeout(msg)); }, ms);\n                    _this.then(resolve, reject).finally(clearTimeout.bind(null, handle));\n                }) : this;\n        }\n    });\n    if (typeof Symbol !== 'undefined' && Symbol.toStringTag)\n        setProp(DexiePromise.prototype, Symbol.toStringTag, 'Dexie.Promise');\n    globalPSD.env = snapShot();\n    function Listener(onFulfilled, onRejected, resolve, reject, zone) {\n        this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n        this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n        this.resolve = resolve;\n        this.reject = reject;\n        this.psd = zone;\n    }\n    props(DexiePromise, {\n        all: function () {\n            var values = getArrayOf.apply(null, arguments)\n                .map(onPossibleParallellAsync);\n            return new DexiePromise(function (resolve, reject) {\n                if (values.length === 0)\n                    resolve([]);\n                var remaining = values.length;\n                values.forEach(function (a, i) { return DexiePromise.resolve(a).then(function (x) {\n                    values[i] = x;\n                    if (!--remaining)\n                        resolve(values);\n                }, reject); });\n            });\n        },\n        resolve: function (value) {\n            if (value instanceof DexiePromise)\n                return value;\n            if (value && typeof value.then === 'function')\n                return new DexiePromise(function (resolve, reject) {\n                    value.then(resolve, reject);\n                });\n            var rv = new DexiePromise(INTERNAL, true, value);\n            return rv;\n        },\n        reject: PromiseReject,\n        race: function () {\n            var values = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n            return new DexiePromise(function (resolve, reject) {\n                values.map(function (value) { return DexiePromise.resolve(value).then(resolve, reject); });\n            });\n        },\n        PSD: {\n            get: function () { return PSD; },\n            set: function (value) { return PSD = value; }\n        },\n        totalEchoes: { get: function () { return totalEchoes; } },\n        newPSD: newScope,\n        usePSD: usePSD,\n        scheduler: {\n            get: function () { return asap; },\n            set: function (value) { asap = value; }\n        },\n        rejectionMapper: {\n            get: function () { return rejectionMapper; },\n            set: function (value) { rejectionMapper = value; }\n        },\n        follow: function (fn, zoneProps) {\n            return new DexiePromise(function (resolve, reject) {\n                return newScope(function (resolve, reject) {\n                    var psd = PSD;\n                    psd.unhandleds = [];\n                    psd.onunhandled = reject;\n                    psd.finalize = callBoth(function () {\n                        var _this = this;\n                        run_at_end_of_this_or_next_physical_tick(function () {\n                            _this.unhandleds.length === 0 ? resolve() : reject(_this.unhandleds[0]);\n                        });\n                    }, psd.finalize);\n                    fn();\n                }, zoneProps, resolve, reject);\n            });\n        }\n    });\n    if (NativePromise) {\n        if (NativePromise.allSettled)\n            setProp(DexiePromise, \"allSettled\", function () {\n                var possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n                return new DexiePromise(function (resolve) {\n                    if (possiblePromises.length === 0)\n                        resolve([]);\n                    var remaining = possiblePromises.length;\n                    var results = new Array(remaining);\n                    possiblePromises.forEach(function (p, i) { return DexiePromise.resolve(p).then(function (value) { return results[i] = { status: \"fulfilled\", value: value }; }, function (reason) { return results[i] = { status: \"rejected\", reason: reason }; })\n                        .then(function () { return --remaining || resolve(results); }); });\n                });\n            });\n        if (NativePromise.any && typeof AggregateError !== 'undefined')\n            setProp(DexiePromise, \"any\", function () {\n                var possiblePromises = getArrayOf.apply(null, arguments).map(onPossibleParallellAsync);\n                return new DexiePromise(function (resolve, reject) {\n                    if (possiblePromises.length === 0)\n                        reject(new AggregateError([]));\n                    var remaining = possiblePromises.length;\n                    var failures = new Array(remaining);\n                    possiblePromises.forEach(function (p, i) { return DexiePromise.resolve(p).then(function (value) { return resolve(value); }, function (failure) {\n                        failures[i] = failure;\n                        if (!--remaining)\n                            reject(new AggregateError(failures));\n                    }); });\n                });\n            });\n        if (NativePromise.withResolvers)\n            DexiePromise.withResolvers = NativePromise.withResolvers;\n    }\n    function executePromiseTask(promise, fn) {\n        try {\n            fn(function (value) {\n                if (promise._state !== null)\n                    return;\n                if (value === promise)\n                    throw new TypeError('A promise cannot be resolved with itself.');\n                var shouldExecuteTick = promise._lib && beginMicroTickScope();\n                if (value && typeof value.then === 'function') {\n                    executePromiseTask(promise, function (resolve, reject) {\n                        value instanceof DexiePromise ?\n                            value._then(resolve, reject) :\n                            value.then(resolve, reject);\n                    });\n                }\n                else {\n                    promise._state = true;\n                    promise._value = value;\n                    propagateAllListeners(promise);\n                }\n                if (shouldExecuteTick)\n                    endMicroTickScope();\n            }, handleRejection.bind(null, promise));\n        }\n        catch (ex) {\n            handleRejection(promise, ex);\n        }\n    }\n    function handleRejection(promise, reason) {\n        rejectingErrors.push(reason);\n        if (promise._state !== null)\n            return;\n        var shouldExecuteTick = promise._lib && beginMicroTickScope();\n        reason = rejectionMapper(reason);\n        promise._state = false;\n        promise._value = reason;\n        addPossiblyUnhandledError(promise);\n        propagateAllListeners(promise);\n        if (shouldExecuteTick)\n            endMicroTickScope();\n    }\n    function propagateAllListeners(promise) {\n        var listeners = promise._listeners;\n        promise._listeners = [];\n        for (var i = 0, len = listeners.length; i < len; ++i) {\n            propagateToListener(promise, listeners[i]);\n        }\n        var psd = promise._PSD;\n        --psd.ref || psd.finalize();\n        if (numScheduledCalls === 0) {\n            ++numScheduledCalls;\n            asap(function () {\n                if (--numScheduledCalls === 0)\n                    finalizePhysicalTick();\n            }, []);\n        }\n    }\n    function propagateToListener(promise, listener) {\n        if (promise._state === null) {\n            promise._listeners.push(listener);\n            return;\n        }\n        var cb = promise._state ? listener.onFulfilled : listener.onRejected;\n        if (cb === null) {\n            return (promise._state ? listener.resolve : listener.reject)(promise._value);\n        }\n        ++listener.psd.ref;\n        ++numScheduledCalls;\n        asap(callListener, [cb, promise, listener]);\n    }\n    function callListener(cb, promise, listener) {\n        try {\n            var ret, value = promise._value;\n            if (!promise._state && rejectingErrors.length)\n                rejectingErrors = [];\n            ret = debug && promise._consoleTask ? promise._consoleTask.run(function () { return cb(value); }) : cb(value);\n            if (!promise._state && rejectingErrors.indexOf(value) === -1) {\n                markErrorAsHandled(promise);\n            }\n            listener.resolve(ret);\n        }\n        catch (e) {\n            listener.reject(e);\n        }\n        finally {\n            if (--numScheduledCalls === 0)\n                finalizePhysicalTick();\n            --listener.psd.ref || listener.psd.finalize();\n        }\n    }\n    function physicalTick() {\n        usePSD(globalPSD, function () {\n            beginMicroTickScope() && endMicroTickScope();\n        });\n    }\n    function beginMicroTickScope() {\n        var wasRootExec = isOutsideMicroTick;\n        isOutsideMicroTick = false;\n        needsNewPhysicalTick = false;\n        return wasRootExec;\n    }\n    function endMicroTickScope() {\n        var callbacks, i, l;\n        do {\n            while (microtickQueue.length > 0) {\n                callbacks = microtickQueue;\n                microtickQueue = [];\n                l = callbacks.length;\n                for (i = 0; i < l; ++i) {\n                    var item = callbacks[i];\n                    item[0].apply(null, item[1]);\n                }\n            }\n        } while (microtickQueue.length > 0);\n        isOutsideMicroTick = true;\n        needsNewPhysicalTick = true;\n    }\n    function finalizePhysicalTick() {\n        var unhandledErrs = unhandledErrors;\n        unhandledErrors = [];\n        unhandledErrs.forEach(function (p) {\n            p._PSD.onunhandled.call(null, p._value, p);\n        });\n        var finalizers = tickFinalizers.slice(0);\n        var i = finalizers.length;\n        while (i)\n            finalizers[--i]();\n    }\n    function run_at_end_of_this_or_next_physical_tick(fn) {\n        function finalizer() {\n            fn();\n            tickFinalizers.splice(tickFinalizers.indexOf(finalizer), 1);\n        }\n        tickFinalizers.push(finalizer);\n        ++numScheduledCalls;\n        asap(function () {\n            if (--numScheduledCalls === 0)\n                finalizePhysicalTick();\n        }, []);\n    }\n    function addPossiblyUnhandledError(promise) {\n        if (!unhandledErrors.some(function (p) { return p._value === promise._value; }))\n            unhandledErrors.push(promise);\n    }\n    function markErrorAsHandled(promise) {\n        var i = unhandledErrors.length;\n        while (i)\n            if (unhandledErrors[--i]._value === promise._value) {\n                unhandledErrors.splice(i, 1);\n                return;\n            }\n    }\n    function PromiseReject(reason) {\n        return new DexiePromise(INTERNAL, false, reason);\n    }\n    function wrap(fn, errorCatcher) {\n        var psd = PSD;\n        return function () {\n            var wasRootExec = beginMicroTickScope(), outerScope = PSD;\n            try {\n                switchToZone(psd, true);\n                return fn.apply(this, arguments);\n            }\n            catch (e) {\n                errorCatcher && errorCatcher(e);\n            }\n            finally {\n                switchToZone(outerScope, false);\n                if (wasRootExec)\n                    endMicroTickScope();\n            }\n        };\n    }\n    var task = { awaits: 0, echoes: 0, id: 0 };\n    var taskCounter = 0;\n    var zoneStack = [];\n    var zoneEchoes = 0;\n    var totalEchoes = 0;\n    var zone_id_counter = 0;\n    function newScope(fn, props, a1, a2) {\n        var parent = PSD, psd = Object.create(parent);\n        psd.parent = parent;\n        psd.ref = 0;\n        psd.global = false;\n        psd.id = ++zone_id_counter;\n        globalPSD.env;\n        psd.env = patchGlobalPromise ? {\n            Promise: DexiePromise,\n            PromiseProp: { value: DexiePromise, configurable: true, writable: true },\n            all: DexiePromise.all,\n            race: DexiePromise.race,\n            allSettled: DexiePromise.allSettled,\n            any: DexiePromise.any,\n            resolve: DexiePromise.resolve,\n            reject: DexiePromise.reject,\n        } : {};\n        if (props)\n            extend(psd, props);\n        ++parent.ref;\n        psd.finalize = function () {\n            --this.parent.ref || this.parent.finalize();\n        };\n        var rv = usePSD(psd, fn, a1, a2);\n        if (psd.ref === 0)\n            psd.finalize();\n        return rv;\n    }\n    function incrementExpectedAwaits() {\n        if (!task.id)\n            task.id = ++taskCounter;\n        ++task.awaits;\n        task.echoes += ZONE_ECHO_LIMIT;\n        return task.id;\n    }\n    function decrementExpectedAwaits() {\n        if (!task.awaits)\n            return false;\n        if (--task.awaits === 0)\n            task.id = 0;\n        task.echoes = task.awaits * ZONE_ECHO_LIMIT;\n        return true;\n    }\n    if (('' + nativePromiseThen).indexOf('[native code]') === -1) {\n        incrementExpectedAwaits = decrementExpectedAwaits = nop;\n    }\n    function onPossibleParallellAsync(possiblePromise) {\n        if (task.echoes && possiblePromise && possiblePromise.constructor === NativePromise) {\n            incrementExpectedAwaits();\n            return possiblePromise.then(function (x) {\n                decrementExpectedAwaits();\n                return x;\n            }, function (e) {\n                decrementExpectedAwaits();\n                return rejection(e);\n            });\n        }\n        return possiblePromise;\n    }\n    function zoneEnterEcho(targetZone) {\n        ++totalEchoes;\n        if (!task.echoes || --task.echoes === 0) {\n            task.echoes = task.awaits = task.id = 0;\n        }\n        zoneStack.push(PSD);\n        switchToZone(targetZone, true);\n    }\n    function zoneLeaveEcho() {\n        var zone = zoneStack[zoneStack.length - 1];\n        zoneStack.pop();\n        switchToZone(zone, false);\n    }\n    function switchToZone(targetZone, bEnteringZone) {\n        var currentZone = PSD;\n        if (bEnteringZone ? task.echoes && (!zoneEchoes++ || targetZone !== PSD) : zoneEchoes && (!--zoneEchoes || targetZone !== PSD)) {\n            queueMicrotask(bEnteringZone ? zoneEnterEcho.bind(null, targetZone) : zoneLeaveEcho);\n        }\n        if (targetZone === PSD)\n            return;\n        PSD = targetZone;\n        if (currentZone === globalPSD)\n            globalPSD.env = snapShot();\n        if (patchGlobalPromise) {\n            var GlobalPromise = globalPSD.env.Promise;\n            var targetEnv = targetZone.env;\n            if (currentZone.global || targetZone.global) {\n                Object.defineProperty(_global, 'Promise', targetEnv.PromiseProp);\n                GlobalPromise.all = targetEnv.all;\n                GlobalPromise.race = targetEnv.race;\n                GlobalPromise.resolve = targetEnv.resolve;\n                GlobalPromise.reject = targetEnv.reject;\n                if (targetEnv.allSettled)\n                    GlobalPromise.allSettled = targetEnv.allSettled;\n                if (targetEnv.any)\n                    GlobalPromise.any = targetEnv.any;\n            }\n        }\n    }\n    function snapShot() {\n        var GlobalPromise = _global.Promise;\n        return patchGlobalPromise ? {\n            Promise: GlobalPromise,\n            PromiseProp: Object.getOwnPropertyDescriptor(_global, \"Promise\"),\n            all: GlobalPromise.all,\n            race: GlobalPromise.race,\n            allSettled: GlobalPromise.allSettled,\n            any: GlobalPromise.any,\n            resolve: GlobalPromise.resolve,\n            reject: GlobalPromise.reject,\n        } : {};\n    }\n    function usePSD(psd, fn, a1, a2, a3) {\n        var outerScope = PSD;\n        try {\n            switchToZone(psd, true);\n            return fn(a1, a2, a3);\n        }\n        finally {\n            switchToZone(outerScope, false);\n        }\n    }\n    function nativeAwaitCompatibleWrap(fn, zone, possibleAwait, cleanup) {\n        return typeof fn !== 'function' ? fn : function () {\n            var outerZone = PSD;\n            if (possibleAwait)\n                incrementExpectedAwaits();\n            switchToZone(zone, true);\n            try {\n                return fn.apply(this, arguments);\n            }\n            finally {\n                switchToZone(outerZone, false);\n                if (cleanup)\n                    queueMicrotask(decrementExpectedAwaits);\n            }\n        };\n    }\n    function execInGlobalContext(cb) {\n        if (Promise === NativePromise && task.echoes === 0) {\n            if (zoneEchoes === 0) {\n                cb();\n            }\n            else {\n                enqueueNativeMicroTask(cb);\n            }\n        }\n        else {\n            setTimeout(cb, 0);\n        }\n    }\n    var rejection = DexiePromise.reject;\n\n    function tempTransaction(db, mode, storeNames, fn) {\n        if (!db.idbdb || (!db._state.openComplete && (!PSD.letThrough && !db._vip))) {\n            if (db._state.openComplete) {\n                return rejection(new exceptions.DatabaseClosed(db._state.dbOpenError));\n            }\n            if (!db._state.isBeingOpened) {\n                if (!db._state.autoOpen)\n                    return rejection(new exceptions.DatabaseClosed());\n                db.open().catch(nop);\n            }\n            return db._state.dbReadyPromise.then(function () { return tempTransaction(db, mode, storeNames, fn); });\n        }\n        else {\n            var trans = db._createTransaction(mode, storeNames, db._dbSchema);\n            try {\n                trans.create();\n                db._state.PR1398_maxLoop = 3;\n            }\n            catch (ex) {\n                if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                    console.warn('Dexie: Need to reopen db');\n                    db.close({ disableAutoOpen: false });\n                    return db.open().then(function () { return tempTransaction(db, mode, storeNames, fn); });\n                }\n                return rejection(ex);\n            }\n            return trans._promise(mode, function (resolve, reject) {\n                return newScope(function () {\n                    PSD.trans = trans;\n                    return fn(resolve, reject, trans);\n                });\n            }).then(function (result) {\n                if (mode === 'readwrite')\n                    try {\n                        trans.idbtrans.commit();\n                    }\n                    catch (_a) { }\n                return mode === 'readonly' ? result : trans._completion.then(function () { return result; });\n            });\n        }\n    }\n\n    var DEXIE_VERSION = '4.2.1';\n    var maxString = String.fromCharCode(65535);\n    var minKey = -Infinity;\n    var INVALID_KEY_ARGUMENT = \"Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.\";\n    var STRING_EXPECTED = \"String expected.\";\n    var connections = [];\n    var DBNAMES_DB = '__dbnames';\n    var READONLY = 'readonly';\n    var READWRITE = 'readwrite';\n\n    function combine(filter1, filter2) {\n        return filter1 ?\n            filter2 ?\n                function () { return filter1.apply(this, arguments) && filter2.apply(this, arguments); } :\n                filter1 :\n            filter2;\n    }\n\n    var AnyRange = {\n        type: 3 ,\n        lower: -Infinity,\n        lowerOpen: false,\n        upper: [[]],\n        upperOpen: false\n    };\n\n    function workaroundForUndefinedPrimKey(keyPath) {\n        return typeof keyPath === \"string\" && !/\\./.test(keyPath)\n            ? function (obj) {\n                if (obj[keyPath] === undefined && (keyPath in obj)) {\n                    obj = deepClone(obj);\n                    delete obj[keyPath];\n                }\n                return obj;\n            }\n            : function (obj) { return obj; };\n    }\n\n    function Entity() {\n        throw exceptions.Type(\"Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.\");\n    }\n\n    function cmp(a, b) {\n        try {\n            var ta = type(a);\n            var tb = type(b);\n            if (ta !== tb) {\n                if (ta === 'Array')\n                    return 1;\n                if (tb === 'Array')\n                    return -1;\n                if (ta === 'binary')\n                    return 1;\n                if (tb === 'binary')\n                    return -1;\n                if (ta === 'string')\n                    return 1;\n                if (tb === 'string')\n                    return -1;\n                if (ta === 'Date')\n                    return 1;\n                if (tb !== 'Date')\n                    return NaN;\n                return -1;\n            }\n            switch (ta) {\n                case 'number':\n                case 'Date':\n                case 'string':\n                    return a > b ? 1 : a < b ? -1 : 0;\n                case 'binary': {\n                    return compareUint8Arrays(getUint8Array(a), getUint8Array(b));\n                }\n                case 'Array':\n                    return compareArrays(a, b);\n            }\n        }\n        catch (_a) { }\n        return NaN;\n    }\n    function compareArrays(a, b) {\n        var al = a.length;\n        var bl = b.length;\n        var l = al < bl ? al : bl;\n        for (var i = 0; i < l; ++i) {\n            var res = cmp(a[i], b[i]);\n            if (res !== 0)\n                return res;\n        }\n        return al === bl ? 0 : al < bl ? -1 : 1;\n    }\n    function compareUint8Arrays(a, b) {\n        var al = a.length;\n        var bl = b.length;\n        var l = al < bl ? al : bl;\n        for (var i = 0; i < l; ++i) {\n            if (a[i] !== b[i])\n                return a[i] < b[i] ? -1 : 1;\n        }\n        return al === bl ? 0 : al < bl ? -1 : 1;\n    }\n    function type(x) {\n        var t = typeof x;\n        if (t !== 'object')\n            return t;\n        if (ArrayBuffer.isView(x))\n            return 'binary';\n        var tsTag = toStringTag(x);\n        return tsTag === 'ArrayBuffer' ? 'binary' : tsTag;\n    }\n    function getUint8Array(a) {\n        if (a instanceof Uint8Array)\n            return a;\n        if (ArrayBuffer.isView(a))\n            return new Uint8Array(a.buffer, a.byteOffset, a.byteLength);\n        return new Uint8Array(a);\n    }\n\n    function builtInDeletionTrigger(table, keys, res) {\n        var yProps = table.schema.yProps;\n        if (!yProps)\n            return res;\n        if (keys && res.numFailures > 0)\n            keys = keys.filter(function (_, i) { return !res.failures[i]; });\n        return Promise.all(yProps.map(function (_a) {\n            var updatesTable = _a.updatesTable;\n            return keys\n                ? table.db.table(updatesTable).where('k').anyOf(keys).delete()\n                : table.db.table(updatesTable).clear();\n        })).then(function () { return res; });\n    }\n\n    var PropModification =  (function () {\n        function PropModification(spec) {\n            this[\"@@propmod\"] = spec;\n        }\n        PropModification.prototype.execute = function (value) {\n            var _a;\n            var spec = this[\"@@propmod\"];\n            if (spec.add !== undefined) {\n                var term = spec.add;\n                if (isArray(term)) {\n                    return __spreadArray(__spreadArray([], (isArray(value) ? value : []), true), term, true).sort();\n                }\n                if (typeof term === 'number')\n                    return (Number(value) || 0) + term;\n                if (typeof term === 'bigint') {\n                    try {\n                        return BigInt(value) + term;\n                    }\n                    catch (_b) {\n                        return BigInt(0) + term;\n                    }\n                }\n                throw new TypeError(\"Invalid term \".concat(term));\n            }\n            if (spec.remove !== undefined) {\n                var subtrahend_1 = spec.remove;\n                if (isArray(subtrahend_1)) {\n                    return isArray(value) ? value.filter(function (item) { return !subtrahend_1.includes(item); }).sort() : [];\n                }\n                if (typeof subtrahend_1 === 'number')\n                    return Number(value) - subtrahend_1;\n                if (typeof subtrahend_1 === 'bigint') {\n                    try {\n                        return BigInt(value) - subtrahend_1;\n                    }\n                    catch (_c) {\n                        return BigInt(0) - subtrahend_1;\n                    }\n                }\n                throw new TypeError(\"Invalid subtrahend \".concat(subtrahend_1));\n            }\n            var prefixToReplace = (_a = spec.replacePrefix) === null || _a === void 0 ? void 0 : _a[0];\n            if (prefixToReplace && typeof value === 'string' && value.startsWith(prefixToReplace)) {\n                return spec.replacePrefix[1] + value.substring(prefixToReplace.length);\n            }\n            return value;\n        };\n        return PropModification;\n    }());\n\n    function applyUpdateSpec(obj, changes) {\n        var keyPaths = keys(changes);\n        var numKeys = keyPaths.length;\n        var anythingModified = false;\n        for (var i = 0; i < numKeys; ++i) {\n            var keyPath = keyPaths[i];\n            var value = changes[keyPath];\n            var origValue = getByKeyPath(obj, keyPath);\n            if (value instanceof PropModification) {\n                setByKeyPath(obj, keyPath, value.execute(origValue));\n                anythingModified = true;\n            }\n            else if (origValue !== value) {\n                setByKeyPath(obj, keyPath, value);\n                anythingModified = true;\n            }\n        }\n        return anythingModified;\n    }\n\n    var Table =  (function () {\n        function Table() {\n        }\n        Table.prototype._trans = function (mode, fn, writeLocked) {\n            var trans = this._tx || PSD.trans;\n            var tableName = this.name;\n            var task = debug && typeof console !== 'undefined' && console.createTask && console.createTask(\"Dexie: \".concat(mode === 'readonly' ? 'read' : 'write', \" \").concat(this.name));\n            function checkTableInTransaction(resolve, reject, trans) {\n                if (!trans.schema[tableName])\n                    throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n                return fn(trans.idbtrans, trans);\n            }\n            var wasRootExec = beginMicroTickScope();\n            try {\n                var p = trans && trans.db._novip === this.db._novip ?\n                    trans === PSD.trans ?\n                        trans._promise(mode, checkTableInTransaction, writeLocked) :\n                        newScope(function () { return trans._promise(mode, checkTableInTransaction, writeLocked); }, { trans: trans, transless: PSD.transless || PSD }) :\n                    tempTransaction(this.db, mode, [this.name], checkTableInTransaction);\n                if (task) {\n                    p._consoleTask = task;\n                    p = p.catch(function (err) {\n                        console.trace(err);\n                        return rejection(err);\n                    });\n                }\n                return p;\n            }\n            finally {\n                if (wasRootExec)\n                    endMicroTickScope();\n            }\n        };\n        Table.prototype.get = function (keyOrCrit, cb) {\n            var _this = this;\n            if (keyOrCrit && keyOrCrit.constructor === Object)\n                return this.where(keyOrCrit).first(cb);\n            if (keyOrCrit == null)\n                return rejection(new exceptions.Type(\"Invalid argument to Table.get()\"));\n            return this._trans('readonly', function (trans) {\n                return _this.core.get({ trans: trans, key: keyOrCrit })\n                    .then(function (res) { return _this.hook.reading.fire(res); });\n            }).then(cb);\n        };\n        Table.prototype.where = function (indexOrCrit) {\n            if (typeof indexOrCrit === 'string')\n                return new this.db.WhereClause(this, indexOrCrit);\n            if (isArray(indexOrCrit))\n                return new this.db.WhereClause(this, \"[\".concat(indexOrCrit.join('+'), \"]\"));\n            var keyPaths = keys(indexOrCrit);\n            if (keyPaths.length === 1)\n                return this\n                    .where(keyPaths[0])\n                    .equals(indexOrCrit[keyPaths[0]]);\n            var compoundIndex = this.schema.indexes.concat(this.schema.primKey).filter(function (ix) {\n                if (ix.compound &&\n                    keyPaths.every(function (keyPath) { return ix.keyPath.indexOf(keyPath) >= 0; })) {\n                    for (var i = 0; i < keyPaths.length; ++i) {\n                        if (keyPaths.indexOf(ix.keyPath[i]) === -1)\n                            return false;\n                    }\n                    return true;\n                }\n                return false;\n            }).sort(function (a, b) { return a.keyPath.length - b.keyPath.length; })[0];\n            if (compoundIndex && this.db._maxKey !== maxString) {\n                var keyPathsInValidOrder = compoundIndex.keyPath.slice(0, keyPaths.length);\n                return this\n                    .where(keyPathsInValidOrder)\n                    .equals(keyPathsInValidOrder.map(function (kp) { return indexOrCrit[kp]; }));\n            }\n            if (!compoundIndex && debug)\n                console.warn(\"The query \".concat(JSON.stringify(indexOrCrit), \" on \").concat(this.name, \" would benefit from a \") +\n                    \"compound index [\".concat(keyPaths.join('+'), \"]\"));\n            var idxByName = this.schema.idxByName;\n            function equals(a, b) {\n                return cmp(a, b) === 0;\n            }\n            var _a = keyPaths.reduce(function (_a, keyPath) {\n                var prevIndex = _a[0], prevFilterFn = _a[1];\n                var index = idxByName[keyPath];\n                var value = indexOrCrit[keyPath];\n                return [\n                    prevIndex || index,\n                    prevIndex || !index ?\n                        combine(prevFilterFn, index && index.multi ?\n                            function (x) {\n                                var prop = getByKeyPath(x, keyPath);\n                                return isArray(prop) && prop.some(function (item) { return equals(value, item); });\n                            } : function (x) { return equals(value, getByKeyPath(x, keyPath)); })\n                        : prevFilterFn\n                ];\n            }, [null, null]), idx = _a[0], filterFunction = _a[1];\n            return idx ?\n                this.where(idx.name).equals(indexOrCrit[idx.keyPath])\n                    .filter(filterFunction) :\n                compoundIndex ?\n                    this.filter(filterFunction) :\n                    this.where(keyPaths).equals('');\n        };\n        Table.prototype.filter = function (filterFunction) {\n            return this.toCollection().and(filterFunction);\n        };\n        Table.prototype.count = function (thenShortcut) {\n            return this.toCollection().count(thenShortcut);\n        };\n        Table.prototype.offset = function (offset) {\n            return this.toCollection().offset(offset);\n        };\n        Table.prototype.limit = function (numRows) {\n            return this.toCollection().limit(numRows);\n        };\n        Table.prototype.each = function (callback) {\n            return this.toCollection().each(callback);\n        };\n        Table.prototype.toArray = function (thenShortcut) {\n            return this.toCollection().toArray(thenShortcut);\n        };\n        Table.prototype.toCollection = function () {\n            return new this.db.Collection(new this.db.WhereClause(this));\n        };\n        Table.prototype.orderBy = function (index) {\n            return new this.db.Collection(new this.db.WhereClause(this, isArray(index) ?\n                \"[\".concat(index.join('+'), \"]\") :\n                index));\n        };\n        Table.prototype.reverse = function () {\n            return this.toCollection().reverse();\n        };\n        Table.prototype.mapToClass = function (constructor) {\n            var _a = this, db = _a.db, tableName = _a.name;\n            this.schema.mappedClass = constructor;\n            if (constructor.prototype instanceof Entity) {\n                constructor =  (function (_super) {\n                    __extends(class_1, _super);\n                    function class_1() {\n                        return _super !== null && _super.apply(this, arguments) || this;\n                    }\n                    Object.defineProperty(class_1.prototype, \"db\", {\n                        get: function () { return db; },\n                        enumerable: false,\n                        configurable: true\n                    });\n                    class_1.prototype.table = function () { return tableName; };\n                    return class_1;\n                }(constructor));\n            }\n            var inheritedProps = new Set();\n            for (var proto = constructor.prototype; proto; proto = getProto(proto)) {\n                Object.getOwnPropertyNames(proto).forEach(function (propName) { return inheritedProps.add(propName); });\n            }\n            var readHook = function (obj) {\n                if (!obj)\n                    return obj;\n                var res = Object.create(constructor.prototype);\n                for (var m in obj)\n                    if (!inheritedProps.has(m))\n                        try {\n                            res[m] = obj[m];\n                        }\n                        catch (_) { }\n                return res;\n            };\n            if (this.schema.readHook) {\n                this.hook.reading.unsubscribe(this.schema.readHook);\n            }\n            this.schema.readHook = readHook;\n            this.hook(\"reading\", readHook);\n            return constructor;\n        };\n        Table.prototype.defineClass = function () {\n            function Class(content) {\n                extend(this, content);\n            }\n            return this.mapToClass(Class);\n        };\n        Table.prototype.add = function (obj, key) {\n            var _this = this;\n            var _a = this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n            var objToAdd = obj;\n            if (keyPath && auto) {\n                objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n            }\n            return this._trans('readwrite', function (trans) {\n                return _this.core.mutate({ trans: trans, type: 'add', keys: key != null ? [key] : null, values: [objToAdd] });\n            }).then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult; })\n                .then(function (lastResult) {\n                if (keyPath) {\n                    try {\n                        setByKeyPath(obj, keyPath, lastResult);\n                    }\n                    catch (_) { }\n                }\n                return lastResult;\n            });\n        };\n        Table.prototype.upsert = function (key, modifications) {\n            var _this = this;\n            var keyPath = this.schema.primKey.keyPath;\n            return this._trans('readwrite', function (trans) {\n                return _this.core.get({ trans: trans, key: key }).then(function (existing) {\n                    var obj = existing !== null && existing !== void 0 ? existing : {};\n                    applyUpdateSpec(obj, modifications);\n                    if (keyPath)\n                        setByKeyPath(obj, keyPath, key);\n                    return _this.core.mutate({\n                        trans: trans,\n                        type: 'put',\n                        values: [obj],\n                        keys: [key],\n                        upsert: true,\n                        updates: { keys: [key], changeSpecs: [modifications] }\n                    }).then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : !!existing; });\n                });\n            });\n        };\n        Table.prototype.update = function (keyOrObject, modifications) {\n            if (typeof keyOrObject === 'object' && !isArray(keyOrObject)) {\n                var key = getByKeyPath(keyOrObject, this.schema.primKey.keyPath);\n                if (key === undefined)\n                    return rejection(new exceptions.InvalidArgument(\"Given object does not contain its primary key\"));\n                return this.where(\":id\").equals(key).modify(modifications);\n            }\n            else {\n                return this.where(\":id\").equals(keyOrObject).modify(modifications);\n            }\n        };\n        Table.prototype.put = function (obj, key) {\n            var _this = this;\n            var _a = this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n            var objToAdd = obj;\n            if (keyPath && auto) {\n                objToAdd = workaroundForUndefinedPrimKey(keyPath)(obj);\n            }\n            return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'put', values: [objToAdd], keys: key != null ? [key] : null }); })\n                .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : res.lastResult; })\n                .then(function (lastResult) {\n                if (keyPath) {\n                    try {\n                        setByKeyPath(obj, keyPath, lastResult);\n                    }\n                    catch (_) { }\n                }\n                return lastResult;\n            });\n        };\n        Table.prototype.delete = function (key) {\n            var _this = this;\n            return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'delete', keys: [key] })\n                .then(function (res) { return builtInDeletionTrigger(_this, [key], res); })\n                .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined; }); });\n        };\n        Table.prototype.clear = function () {\n            var _this = this;\n            return this._trans('readwrite', function (trans) { return _this.core.mutate({ trans: trans, type: 'deleteRange', range: AnyRange })\n                .then(function (res) { return builtInDeletionTrigger(_this, null, res); }); })\n                .then(function (res) { return res.numFailures ? DexiePromise.reject(res.failures[0]) : undefined; });\n        };\n        Table.prototype.bulkGet = function (keys) {\n            var _this = this;\n            return this._trans('readonly', function (trans) {\n                return _this.core.getMany({\n                    keys: keys,\n                    trans: trans\n                }).then(function (result) { return result.map(function (res) { return _this.hook.reading.fire(res); }); });\n            });\n        };\n        Table.prototype.bulkAdd = function (objects, keysOrOptions, options) {\n            var _this = this;\n            var keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n            options = options || (keys ? undefined : keysOrOptions);\n            var wantResults = options ? options.allKeys : undefined;\n            return this._trans('readwrite', function (trans) {\n                var _a = _this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n                if (keyPath && keys)\n                    throw new exceptions.InvalidArgument(\"bulkAdd(): keys argument invalid on tables with inbound keys\");\n                if (keys && keys.length !== objects.length)\n                    throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n                var numObjects = objects.length;\n                var objectsToAdd = keyPath && auto ?\n                    objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                    objects;\n                return _this.core.mutate({ trans: trans, type: 'add', keys: keys, values: objectsToAdd, wantResults: wantResults })\n                    .then(function (_a) {\n                    var numFailures = _a.numFailures, results = _a.results, lastResult = _a.lastResult, failures = _a.failures;\n                    var result = wantResults ? results : lastResult;\n                    if (numFailures === 0)\n                        return result;\n                    throw new BulkError(\"\".concat(_this.name, \".bulkAdd(): \").concat(numFailures, \" of \").concat(numObjects, \" operations failed\"), failures);\n                });\n            });\n        };\n        Table.prototype.bulkPut = function (objects, keysOrOptions, options) {\n            var _this = this;\n            var keys = Array.isArray(keysOrOptions) ? keysOrOptions : undefined;\n            options = options || (keys ? undefined : keysOrOptions);\n            var wantResults = options ? options.allKeys : undefined;\n            return this._trans('readwrite', function (trans) {\n                var _a = _this.schema.primKey, auto = _a.auto, keyPath = _a.keyPath;\n                if (keyPath && keys)\n                    throw new exceptions.InvalidArgument(\"bulkPut(): keys argument invalid on tables with inbound keys\");\n                if (keys && keys.length !== objects.length)\n                    throw new exceptions.InvalidArgument(\"Arguments objects and keys must have the same length\");\n                var numObjects = objects.length;\n                var objectsToPut = keyPath && auto ?\n                    objects.map(workaroundForUndefinedPrimKey(keyPath)) :\n                    objects;\n                return _this.core.mutate({ trans: trans, type: 'put', keys: keys, values: objectsToPut, wantResults: wantResults })\n                    .then(function (_a) {\n                    var numFailures = _a.numFailures, results = _a.results, lastResult = _a.lastResult, failures = _a.failures;\n                    var result = wantResults ? results : lastResult;\n                    if (numFailures === 0)\n                        return result;\n                    throw new BulkError(\"\".concat(_this.name, \".bulkPut(): \").concat(numFailures, \" of \").concat(numObjects, \" operations failed\"), failures);\n                });\n            });\n        };\n        Table.prototype.bulkUpdate = function (keysAndChanges) {\n            var _this = this;\n            var coreTable = this.core;\n            var keys = keysAndChanges.map(function (entry) { return entry.key; });\n            var changeSpecs = keysAndChanges.map(function (entry) { return entry.changes; });\n            var offsetMap = [];\n            return this._trans('readwrite', function (trans) {\n                return coreTable.getMany({ trans: trans, keys: keys, cache: 'clone' }).then(function (objs) {\n                    var resultKeys = [];\n                    var resultObjs = [];\n                    keysAndChanges.forEach(function (_a, idx) {\n                        var key = _a.key, changes = _a.changes;\n                        var obj = objs[idx];\n                        if (obj) {\n                            for (var _i = 0, _b = Object.keys(changes); _i < _b.length; _i++) {\n                                var keyPath = _b[_i];\n                                var value = changes[keyPath];\n                                if (keyPath === _this.schema.primKey.keyPath) {\n                                    if (cmp(value, key) !== 0) {\n                                        throw new exceptions.Constraint(\"Cannot update primary key in bulkUpdate()\");\n                                    }\n                                }\n                                else {\n                                    setByKeyPath(obj, keyPath, value);\n                                }\n                            }\n                            offsetMap.push(idx);\n                            resultKeys.push(key);\n                            resultObjs.push(obj);\n                        }\n                    });\n                    var numEntries = resultKeys.length;\n                    return coreTable\n                        .mutate({\n                        trans: trans,\n                        type: 'put',\n                        keys: resultKeys,\n                        values: resultObjs,\n                        updates: {\n                            keys: keys,\n                            changeSpecs: changeSpecs\n                        }\n                    })\n                        .then(function (_a) {\n                        var numFailures = _a.numFailures, failures = _a.failures;\n                        if (numFailures === 0)\n                            return numEntries;\n                        for (var _i = 0, _b = Object.keys(failures); _i < _b.length; _i++) {\n                            var offset = _b[_i];\n                            var mappedOffset = offsetMap[Number(offset)];\n                            if (mappedOffset != null) {\n                                var failure = failures[offset];\n                                delete failures[offset];\n                                failures[mappedOffset] = failure;\n                            }\n                        }\n                        throw new BulkError(\"\".concat(_this.name, \".bulkUpdate(): \").concat(numFailures, \" of \").concat(numEntries, \" operations failed\"), failures);\n                    });\n                });\n            });\n        };\n        Table.prototype.bulkDelete = function (keys) {\n            var _this = this;\n            var numKeys = keys.length;\n            return this._trans('readwrite', function (trans) {\n                return _this.core.mutate({ trans: trans, type: 'delete', keys: keys })\n                    .then(function (res) { return builtInDeletionTrigger(_this, keys, res); });\n            }).then(function (_a) {\n                var numFailures = _a.numFailures, lastResult = _a.lastResult, failures = _a.failures;\n                if (numFailures === 0)\n                    return lastResult;\n                throw new BulkError(\"\".concat(_this.name, \".bulkDelete(): \").concat(numFailures, \" of \").concat(numKeys, \" operations failed\"), failures);\n            });\n        };\n        return Table;\n    }());\n\n    function Events(ctx) {\n        var evs = {};\n        var rv = function (eventName, subscriber) {\n            if (subscriber) {\n                var i = arguments.length, args = new Array(i - 1);\n                while (--i)\n                    args[i - 1] = arguments[i];\n                evs[eventName].subscribe.apply(null, args);\n                return ctx;\n            }\n            else if (typeof (eventName) === 'string') {\n                return evs[eventName];\n            }\n        };\n        rv.addEventType = add;\n        for (var i = 1, l = arguments.length; i < l; ++i) {\n            add(arguments[i]);\n        }\n        return rv;\n        function add(eventName, chainFunction, defaultFunction) {\n            if (typeof eventName === 'object')\n                return addConfiguredEvents(eventName);\n            if (!chainFunction)\n                chainFunction = reverseStoppableEventChain;\n            if (!defaultFunction)\n                defaultFunction = nop;\n            var context = {\n                subscribers: [],\n                fire: defaultFunction,\n                subscribe: function (cb) {\n                    if (context.subscribers.indexOf(cb) === -1) {\n                        context.subscribers.push(cb);\n                        context.fire = chainFunction(context.fire, cb);\n                    }\n                },\n                unsubscribe: function (cb) {\n                    context.subscribers = context.subscribers.filter(function (fn) { return fn !== cb; });\n                    context.fire = context.subscribers.reduce(chainFunction, defaultFunction);\n                }\n            };\n            evs[eventName] = rv[eventName] = context;\n            return context;\n        }\n        function addConfiguredEvents(cfg) {\n            keys(cfg).forEach(function (eventName) {\n                var args = cfg[eventName];\n                if (isArray(args)) {\n                    add(eventName, cfg[eventName][0], cfg[eventName][1]);\n                }\n                else if (args === 'asap') {\n                    var context = add(eventName, mirror, function fire() {\n                        var i = arguments.length, args = new Array(i);\n                        while (i--)\n                            args[i] = arguments[i];\n                        context.subscribers.forEach(function (fn) {\n                            asap$1(function fireEvent() {\n                                fn.apply(null, args);\n                            });\n                        });\n                    });\n                }\n                else\n                    throw new exceptions.InvalidArgument(\"Invalid event config\");\n            });\n        }\n    }\n\n    function makeClassConstructor(prototype, constructor) {\n        derive(constructor).from({ prototype: prototype });\n        return constructor;\n    }\n\n    function createTableConstructor(db) {\n        return makeClassConstructor(Table.prototype, function Table(name, tableSchema, trans) {\n            this.db = db;\n            this._tx = trans;\n            this.name = name;\n            this.schema = tableSchema;\n            this.hook = db._allTables[name] ? db._allTables[name].hook : Events(null, {\n                \"creating\": [hookCreatingChain, nop],\n                \"reading\": [pureFunctionChain, mirror],\n                \"updating\": [hookUpdatingChain, nop],\n                \"deleting\": [hookDeletingChain, nop]\n            });\n        });\n    }\n\n    function isPlainKeyRange(ctx, ignoreLimitFilter) {\n        return !(ctx.filter || ctx.algorithm || ctx.or) &&\n            (ignoreLimitFilter ? ctx.justLimit : !ctx.replayFilter);\n    }\n    function addFilter(ctx, fn) {\n        ctx.filter = combine(ctx.filter, fn);\n    }\n    function addReplayFilter(ctx, factory, isLimitFilter) {\n        var curr = ctx.replayFilter;\n        ctx.replayFilter = curr ? function () { return combine(curr(), factory()); } : factory;\n        ctx.justLimit = isLimitFilter && !curr;\n    }\n    function addMatchFilter(ctx, fn) {\n        ctx.isMatch = combine(ctx.isMatch, fn);\n    }\n    function getIndexOrStore(ctx, coreSchema) {\n        if (ctx.isPrimKey)\n            return coreSchema.primaryKey;\n        var index = coreSchema.getIndexByKeyPath(ctx.index);\n        if (!index)\n            throw new exceptions.Schema(\"KeyPath \" + ctx.index + \" on object store \" + coreSchema.name + \" is not indexed\");\n        return index;\n    }\n    function openCursor(ctx, coreTable, trans) {\n        var index = getIndexOrStore(ctx, coreTable.schema);\n        return coreTable.openCursor({\n            trans: trans,\n            values: !ctx.keysOnly,\n            reverse: ctx.dir === 'prev',\n            unique: !!ctx.unique,\n            query: {\n                index: index,\n                range: ctx.range\n            }\n        });\n    }\n    function iter(ctx, fn, coreTrans, coreTable) {\n        var filter = ctx.replayFilter ? combine(ctx.filter, ctx.replayFilter()) : ctx.filter;\n        if (!ctx.or) {\n            return iterate(openCursor(ctx, coreTable, coreTrans), combine(ctx.algorithm, filter), fn, !ctx.keysOnly && ctx.valueMapper);\n        }\n        else {\n            var set_1 = {};\n            var union = function (item, cursor, advance) {\n                if (!filter || filter(cursor, advance, function (result) { return cursor.stop(result); }, function (err) { return cursor.fail(err); })) {\n                    var primaryKey = cursor.primaryKey;\n                    var key = '' + primaryKey;\n                    if (key === '[object ArrayBuffer]')\n                        key = '' + new Uint8Array(primaryKey);\n                    if (!hasOwn(set_1, key)) {\n                        set_1[key] = true;\n                        fn(item, cursor, advance);\n                    }\n                }\n            };\n            return Promise.all([\n                ctx.or._iterate(union, coreTrans),\n                iterate(openCursor(ctx, coreTable, coreTrans), ctx.algorithm, union, !ctx.keysOnly && ctx.valueMapper)\n            ]);\n        }\n    }\n    function iterate(cursorPromise, filter, fn, valueMapper) {\n        var mappedFn = valueMapper ? function (x, c, a) { return fn(valueMapper(x), c, a); } : fn;\n        var wrappedFn = wrap(mappedFn);\n        return cursorPromise.then(function (cursor) {\n            if (cursor) {\n                return cursor.start(function () {\n                    var c = function () { return cursor.continue(); };\n                    if (!filter || filter(cursor, function (advancer) { return c = advancer; }, function (val) { cursor.stop(val); c = nop; }, function (e) { cursor.fail(e); c = nop; }))\n                        wrappedFn(cursor.value, cursor, function (advancer) { return c = advancer; });\n                    c();\n                });\n            }\n        });\n    }\n\n    var Collection =  (function () {\n        function Collection() {\n        }\n        Collection.prototype._read = function (fn, cb) {\n            var ctx = this._ctx;\n            return ctx.error ?\n                ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n                ctx.table._trans('readonly', fn).then(cb);\n        };\n        Collection.prototype._write = function (fn) {\n            var ctx = this._ctx;\n            return ctx.error ?\n                ctx.table._trans(null, rejection.bind(null, ctx.error)) :\n                ctx.table._trans('readwrite', fn, \"locked\");\n        };\n        Collection.prototype._addAlgorithm = function (fn) {\n            var ctx = this._ctx;\n            ctx.algorithm = combine(ctx.algorithm, fn);\n        };\n        Collection.prototype._iterate = function (fn, coreTrans) {\n            return iter(this._ctx, fn, coreTrans, this._ctx.table.core);\n        };\n        Collection.prototype.clone = function (props) {\n            var rv = Object.create(this.constructor.prototype), ctx = Object.create(this._ctx);\n            if (props)\n                extend(ctx, props);\n            rv._ctx = ctx;\n            return rv;\n        };\n        Collection.prototype.raw = function () {\n            this._ctx.valueMapper = null;\n            return this;\n        };\n        Collection.prototype.each = function (fn) {\n            var ctx = this._ctx;\n            return this._read(function (trans) { return iter(ctx, fn, trans, ctx.table.core); });\n        };\n        Collection.prototype.count = function (cb) {\n            var _this = this;\n            return this._read(function (trans) {\n                var ctx = _this._ctx;\n                var coreTable = ctx.table.core;\n                if (isPlainKeyRange(ctx, true)) {\n                    return coreTable.count({\n                        trans: trans,\n                        query: {\n                            index: getIndexOrStore(ctx, coreTable.schema),\n                            range: ctx.range\n                        }\n                    }).then(function (count) { return Math.min(count, ctx.limit); });\n                }\n                else {\n                    var count = 0;\n                    return iter(ctx, function () { ++count; return false; }, trans, coreTable)\n                        .then(function () { return count; });\n                }\n            }).then(cb);\n        };\n        Collection.prototype.sortBy = function (keyPath, cb) {\n            var parts = keyPath.split('.').reverse(), lastPart = parts[0], lastIndex = parts.length - 1;\n            function getval(obj, i) {\n                if (i)\n                    return getval(obj[parts[i]], i - 1);\n                return obj[lastPart];\n            }\n            var order = this._ctx.dir === \"next\" ? 1 : -1;\n            function sorter(a, b) {\n                var aVal = getval(a, lastIndex), bVal = getval(b, lastIndex);\n                return cmp(aVal, bVal) * order;\n            }\n            return this.toArray(function (a) {\n                return a.sort(sorter);\n            }).then(cb);\n        };\n        Collection.prototype.toArray = function (cb) {\n            var _this = this;\n            return this._read(function (trans) {\n                var ctx = _this._ctx;\n                if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                    var valueMapper_1 = ctx.valueMapper;\n                    var index = getIndexOrStore(ctx, ctx.table.core.schema);\n                    return ctx.table.core.query({\n                        trans: trans,\n                        limit: ctx.limit,\n                        values: true,\n                        query: {\n                            index: index,\n                            range: ctx.range\n                        }\n                    }).then(function (_a) {\n                        var result = _a.result;\n                        return valueMapper_1 ? result.map(valueMapper_1) : result;\n                    });\n                }\n                else {\n                    var a_1 = [];\n                    return iter(ctx, function (item) { return a_1.push(item); }, trans, ctx.table.core).then(function () { return a_1; });\n                }\n            }, cb);\n        };\n        Collection.prototype.offset = function (offset) {\n            var ctx = this._ctx;\n            if (offset <= 0)\n                return this;\n            ctx.offset += offset;\n            if (isPlainKeyRange(ctx)) {\n                addReplayFilter(ctx, function () {\n                    var offsetLeft = offset;\n                    return function (cursor, advance) {\n                        if (offsetLeft === 0)\n                            return true;\n                        if (offsetLeft === 1) {\n                            --offsetLeft;\n                            return false;\n                        }\n                        advance(function () {\n                            cursor.advance(offsetLeft);\n                            offsetLeft = 0;\n                        });\n                        return false;\n                    };\n                });\n            }\n            else {\n                addReplayFilter(ctx, function () {\n                    var offsetLeft = offset;\n                    return function () { return (--offsetLeft < 0); };\n                });\n            }\n            return this;\n        };\n        Collection.prototype.limit = function (numRows) {\n            this._ctx.limit = Math.min(this._ctx.limit, numRows);\n            addReplayFilter(this._ctx, function () {\n                var rowsLeft = numRows;\n                return function (cursor, advance, resolve) {\n                    if (--rowsLeft <= 0)\n                        advance(resolve);\n                    return rowsLeft >= 0;\n                };\n            }, true);\n            return this;\n        };\n        Collection.prototype.until = function (filterFunction, bIncludeStopEntry) {\n            addFilter(this._ctx, function (cursor, advance, resolve) {\n                if (filterFunction(cursor.value)) {\n                    advance(resolve);\n                    return bIncludeStopEntry;\n                }\n                else {\n                    return true;\n                }\n            });\n            return this;\n        };\n        Collection.prototype.first = function (cb) {\n            return this.limit(1).toArray(function (a) { return a[0]; }).then(cb);\n        };\n        Collection.prototype.last = function (cb) {\n            return this.reverse().first(cb);\n        };\n        Collection.prototype.filter = function (filterFunction) {\n            addFilter(this._ctx, function (cursor) {\n                return filterFunction(cursor.value);\n            });\n            addMatchFilter(this._ctx, filterFunction);\n            return this;\n        };\n        Collection.prototype.and = function (filter) {\n            return this.filter(filter);\n        };\n        Collection.prototype.or = function (indexName) {\n            return new this.db.WhereClause(this._ctx.table, indexName, this);\n        };\n        Collection.prototype.reverse = function () {\n            this._ctx.dir = (this._ctx.dir === \"prev\" ? \"next\" : \"prev\");\n            if (this._ondirectionchange)\n                this._ondirectionchange(this._ctx.dir);\n            return this;\n        };\n        Collection.prototype.desc = function () {\n            return this.reverse();\n        };\n        Collection.prototype.eachKey = function (cb) {\n            var ctx = this._ctx;\n            ctx.keysOnly = !ctx.isMatch;\n            return this.each(function (val, cursor) { cb(cursor.key, cursor); });\n        };\n        Collection.prototype.eachUniqueKey = function (cb) {\n            this._ctx.unique = \"unique\";\n            return this.eachKey(cb);\n        };\n        Collection.prototype.eachPrimaryKey = function (cb) {\n            var ctx = this._ctx;\n            ctx.keysOnly = !ctx.isMatch;\n            return this.each(function (val, cursor) { cb(cursor.primaryKey, cursor); });\n        };\n        Collection.prototype.keys = function (cb) {\n            var ctx = this._ctx;\n            ctx.keysOnly = !ctx.isMatch;\n            var a = [];\n            return this.each(function (item, cursor) {\n                a.push(cursor.key);\n            }).then(function () {\n                return a;\n            }).then(cb);\n        };\n        Collection.prototype.primaryKeys = function (cb) {\n            var ctx = this._ctx;\n            if (ctx.dir === 'next' && isPlainKeyRange(ctx, true) && ctx.limit > 0) {\n                return this._read(function (trans) {\n                    var index = getIndexOrStore(ctx, ctx.table.core.schema);\n                    return ctx.table.core.query({\n                        trans: trans,\n                        values: false,\n                        limit: ctx.limit,\n                        query: {\n                            index: index,\n                            range: ctx.range\n                        }\n                    });\n                }).then(function (_a) {\n                    var result = _a.result;\n                    return result;\n                }).then(cb);\n            }\n            ctx.keysOnly = !ctx.isMatch;\n            var a = [];\n            return this.each(function (item, cursor) {\n                a.push(cursor.primaryKey);\n            }).then(function () {\n                return a;\n            }).then(cb);\n        };\n        Collection.prototype.uniqueKeys = function (cb) {\n            this._ctx.unique = \"unique\";\n            return this.keys(cb);\n        };\n        Collection.prototype.firstKey = function (cb) {\n            return this.limit(1).keys(function (a) { return a[0]; }).then(cb);\n        };\n        Collection.prototype.lastKey = function (cb) {\n            return this.reverse().firstKey(cb);\n        };\n        Collection.prototype.distinct = function () {\n            var ctx = this._ctx, idx = ctx.index && ctx.table.schema.idxByName[ctx.index];\n            if (!idx || !idx.multi)\n                return this;\n            var set = {};\n            addFilter(this._ctx, function (cursor) {\n                var strKey = cursor.primaryKey.toString();\n                var found = hasOwn(set, strKey);\n                set[strKey] = true;\n                return !found;\n            });\n            return this;\n        };\n        Collection.prototype.modify = function (changes) {\n            var _this = this;\n            var ctx = this._ctx;\n            return this._write(function (trans) {\n                var modifyer;\n                if (typeof changes === 'function') {\n                    modifyer = changes;\n                }\n                else {\n                    modifyer = function (item) { return applyUpdateSpec(item, changes); };\n                }\n                var coreTable = ctx.table.core;\n                var _a = coreTable.schema.primaryKey, outbound = _a.outbound, extractKey = _a.extractKey;\n                var limit = 200;\n                var modifyChunkSize = _this.db._options.modifyChunkSize;\n                if (modifyChunkSize) {\n                    if (typeof modifyChunkSize == 'object') {\n                        limit = modifyChunkSize[coreTable.name] || modifyChunkSize['*'] || 200;\n                    }\n                    else {\n                        limit = modifyChunkSize;\n                    }\n                }\n                var totalFailures = [];\n                var successCount = 0;\n                var failedKeys = [];\n                var applyMutateResult = function (expectedCount, res) {\n                    var failures = res.failures, numFailures = res.numFailures;\n                    successCount += expectedCount - numFailures;\n                    for (var _i = 0, _a = keys(failures); _i < _a.length; _i++) {\n                        var pos = _a[_i];\n                        totalFailures.push(failures[pos]);\n                    }\n                };\n                var isUnconditionalDelete = changes === deleteCallback;\n                return _this.clone().primaryKeys().then(function (keys) {\n                    var criteria = isPlainKeyRange(ctx) &&\n                        ctx.limit === Infinity &&\n                        (typeof changes !== 'function' || isUnconditionalDelete) && {\n                        index: ctx.index,\n                        range: ctx.range\n                    };\n                    var nextChunk = function (offset) {\n                        var count = Math.min(limit, keys.length - offset);\n                        var keysInChunk = keys.slice(offset, offset + count);\n                        return (isUnconditionalDelete ? Promise.resolve([]) : coreTable.getMany({\n                            trans: trans,\n                            keys: keysInChunk,\n                            cache: \"immutable\"\n                        })).then(function (values) {\n                            var addValues = [];\n                            var putValues = [];\n                            var putKeys = outbound ? [] : null;\n                            var deleteKeys = isUnconditionalDelete ? keysInChunk : [];\n                            if (!isUnconditionalDelete)\n                                for (var i = 0; i < count; ++i) {\n                                    var origValue = values[i];\n                                    var ctx_1 = {\n                                        value: deepClone(origValue),\n                                        primKey: keys[offset + i]\n                                    };\n                                    if (modifyer.call(ctx_1, ctx_1.value, ctx_1) !== false) {\n                                        if (ctx_1.value == null) {\n                                            deleteKeys.push(keys[offset + i]);\n                                        }\n                                        else if (!outbound && cmp(extractKey(origValue), extractKey(ctx_1.value)) !== 0) {\n                                            deleteKeys.push(keys[offset + i]);\n                                            addValues.push(ctx_1.value);\n                                        }\n                                        else {\n                                            putValues.push(ctx_1.value);\n                                            if (outbound)\n                                                putKeys.push(keys[offset + i]);\n                                        }\n                                    }\n                                }\n                            return Promise.resolve(addValues.length > 0 &&\n                                coreTable.mutate({ trans: trans, type: 'add', values: addValues })\n                                    .then(function (res) {\n                                    for (var pos in res.failures) {\n                                        deleteKeys.splice(parseInt(pos), 1);\n                                    }\n                                    applyMutateResult(addValues.length, res);\n                                })).then(function () { return (putValues.length > 0 || (criteria && typeof changes === 'object')) &&\n                                coreTable.mutate({\n                                    trans: trans,\n                                    type: 'put',\n                                    keys: putKeys,\n                                    values: putValues,\n                                    criteria: criteria,\n                                    changeSpec: typeof changes !== 'function'\n                                        && changes,\n                                    isAdditionalChunk: offset > 0\n                                }).then(function (res) { return applyMutateResult(putValues.length, res); }); }).then(function () { return (deleteKeys.length > 0 || (criteria && isUnconditionalDelete)) &&\n                                coreTable.mutate({\n                                    trans: trans,\n                                    type: 'delete',\n                                    keys: deleteKeys,\n                                    criteria: criteria,\n                                    isAdditionalChunk: offset > 0\n                                }).then(function (res) { return builtInDeletionTrigger(ctx.table, deleteKeys, res); })\n                                    .then(function (res) { return applyMutateResult(deleteKeys.length, res); }); }).then(function () {\n                                return keys.length > offset + count && nextChunk(offset + limit);\n                            });\n                        });\n                    };\n                    return nextChunk(0).then(function () {\n                        if (totalFailures.length > 0)\n                            throw new ModifyError(\"Error modifying one or more objects\", totalFailures, successCount, failedKeys);\n                        return keys.length;\n                    });\n                });\n            });\n        };\n        Collection.prototype.delete = function () {\n            var ctx = this._ctx, range = ctx.range;\n            if (isPlainKeyRange(ctx) &&\n                !ctx.table.schema.yProps &&\n                (ctx.isPrimKey || range.type === 3 ))\n             {\n                return this._write(function (trans) {\n                    var primaryKey = ctx.table.core.schema.primaryKey;\n                    var coreRange = range;\n                    return ctx.table.core.count({ trans: trans, query: { index: primaryKey, range: coreRange } }).then(function (count) {\n                        return ctx.table.core.mutate({ trans: trans, type: 'deleteRange', range: coreRange })\n                            .then(function (_a) {\n                            var failures = _a.failures, numFailures = _a.numFailures;\n                            if (numFailures)\n                                throw new ModifyError(\"Could not delete some values\", Object.keys(failures).map(function (pos) { return failures[pos]; }), count - numFailures);\n                            return count - numFailures;\n                        });\n                    });\n                });\n            }\n            return this.modify(deleteCallback);\n        };\n        return Collection;\n    }());\n    var deleteCallback = function (value, ctx) { return ctx.value = null; };\n\n    function createCollectionConstructor(db) {\n        return makeClassConstructor(Collection.prototype, function Collection(whereClause, keyRangeGenerator) {\n            this.db = db;\n            var keyRange = AnyRange, error = null;\n            if (keyRangeGenerator)\n                try {\n                    keyRange = keyRangeGenerator();\n                }\n                catch (ex) {\n                    error = ex;\n                }\n            var whereCtx = whereClause._ctx;\n            var table = whereCtx.table;\n            var readingHook = table.hook.reading.fire;\n            this._ctx = {\n                table: table,\n                index: whereCtx.index,\n                isPrimKey: (!whereCtx.index || (table.schema.primKey.keyPath && whereCtx.index === table.schema.primKey.name)),\n                range: keyRange,\n                keysOnly: false,\n                dir: \"next\",\n                unique: \"\",\n                algorithm: null,\n                filter: null,\n                replayFilter: null,\n                justLimit: true,\n                isMatch: null,\n                offset: 0,\n                limit: Infinity,\n                error: error,\n                or: whereCtx.or,\n                valueMapper: readingHook !== mirror ? readingHook : null\n            };\n        });\n    }\n\n    function simpleCompare(a, b) {\n        return a < b ? -1 : a === b ? 0 : 1;\n    }\n    function simpleCompareReverse(a, b) {\n        return a > b ? -1 : a === b ? 0 : 1;\n    }\n\n    function fail(collectionOrWhereClause, err, T) {\n        var collection = collectionOrWhereClause instanceof WhereClause ?\n            new collectionOrWhereClause.Collection(collectionOrWhereClause) :\n            collectionOrWhereClause;\n        collection._ctx.error = T ? new T(err) : new TypeError(err);\n        return collection;\n    }\n    function emptyCollection(whereClause) {\n        return new whereClause.Collection(whereClause, function () { return rangeEqual(\"\"); }).limit(0);\n    }\n    function upperFactory(dir) {\n        return dir === \"next\" ?\n            function (s) { return s.toUpperCase(); } :\n            function (s) { return s.toLowerCase(); };\n    }\n    function lowerFactory(dir) {\n        return dir === \"next\" ?\n            function (s) { return s.toLowerCase(); } :\n            function (s) { return s.toUpperCase(); };\n    }\n    function nextCasing(key, lowerKey, upperNeedle, lowerNeedle, cmp, dir) {\n        var length = Math.min(key.length, lowerNeedle.length);\n        var llp = -1;\n        for (var i = 0; i < length; ++i) {\n            var lwrKeyChar = lowerKey[i];\n            if (lwrKeyChar !== lowerNeedle[i]) {\n                if (cmp(key[i], upperNeedle[i]) < 0)\n                    return key.substr(0, i) + upperNeedle[i] + upperNeedle.substr(i + 1);\n                if (cmp(key[i], lowerNeedle[i]) < 0)\n                    return key.substr(0, i) + lowerNeedle[i] + upperNeedle.substr(i + 1);\n                if (llp >= 0)\n                    return key.substr(0, llp) + lowerKey[llp] + upperNeedle.substr(llp + 1);\n                return null;\n            }\n            if (cmp(key[i], lwrKeyChar) < 0)\n                llp = i;\n        }\n        if (length < lowerNeedle.length && dir === \"next\")\n            return key + upperNeedle.substr(key.length);\n        if (length < key.length && dir === \"prev\")\n            return key.substr(0, upperNeedle.length);\n        return (llp < 0 ? null : key.substr(0, llp) + lowerNeedle[llp] + upperNeedle.substr(llp + 1));\n    }\n    function addIgnoreCaseAlgorithm(whereClause, match, needles, suffix) {\n        var upper, lower, compare, upperNeedles, lowerNeedles, direction, nextKeySuffix, needlesLen = needles.length;\n        if (!needles.every(function (s) { return typeof s === 'string'; })) {\n            return fail(whereClause, STRING_EXPECTED);\n        }\n        function initDirection(dir) {\n            upper = upperFactory(dir);\n            lower = lowerFactory(dir);\n            compare = (dir === \"next\" ? simpleCompare : simpleCompareReverse);\n            var needleBounds = needles.map(function (needle) {\n                return { lower: lower(needle), upper: upper(needle) };\n            }).sort(function (a, b) {\n                return compare(a.lower, b.lower);\n            });\n            upperNeedles = needleBounds.map(function (nb) { return nb.upper; });\n            lowerNeedles = needleBounds.map(function (nb) { return nb.lower; });\n            direction = dir;\n            nextKeySuffix = (dir === \"next\" ? \"\" : suffix);\n        }\n        initDirection(\"next\");\n        var c = new whereClause.Collection(whereClause, function () { return createRange(upperNeedles[0], lowerNeedles[needlesLen - 1] + suffix); });\n        c._ondirectionchange = function (direction) {\n            initDirection(direction);\n        };\n        var firstPossibleNeedle = 0;\n        c._addAlgorithm(function (cursor, advance, resolve) {\n            var key = cursor.key;\n            if (typeof key !== 'string')\n                return false;\n            var lowerKey = lower(key);\n            if (match(lowerKey, lowerNeedles, firstPossibleNeedle)) {\n                return true;\n            }\n            else {\n                var lowestPossibleCasing = null;\n                for (var i = firstPossibleNeedle; i < needlesLen; ++i) {\n                    var casing = nextCasing(key, lowerKey, upperNeedles[i], lowerNeedles[i], compare, direction);\n                    if (casing === null && lowestPossibleCasing === null)\n                        firstPossibleNeedle = i + 1;\n                    else if (lowestPossibleCasing === null || compare(lowestPossibleCasing, casing) > 0) {\n                        lowestPossibleCasing = casing;\n                    }\n                }\n                if (lowestPossibleCasing !== null) {\n                    advance(function () { cursor.continue(lowestPossibleCasing + nextKeySuffix); });\n                }\n                else {\n                    advance(resolve);\n                }\n                return false;\n            }\n        });\n        return c;\n    }\n    function createRange(lower, upper, lowerOpen, upperOpen) {\n        return {\n            type: 2 ,\n            lower: lower,\n            upper: upper,\n            lowerOpen: lowerOpen,\n            upperOpen: upperOpen\n        };\n    }\n    function rangeEqual(value) {\n        return {\n            type: 1 ,\n            lower: value,\n            upper: value\n        };\n    }\n\n    var WhereClause =  (function () {\n        function WhereClause() {\n        }\n        Object.defineProperty(WhereClause.prototype, \"Collection\", {\n            get: function () {\n                return this._ctx.table.db.Collection;\n            },\n            enumerable: false,\n            configurable: true\n        });\n        WhereClause.prototype.between = function (lower, upper, includeLower, includeUpper) {\n            includeLower = includeLower !== false;\n            includeUpper = includeUpper === true;\n            try {\n                if ((this._cmp(lower, upper) > 0) ||\n                    (this._cmp(lower, upper) === 0 && (includeLower || includeUpper) && !(includeLower && includeUpper)))\n                    return emptyCollection(this);\n                return new this.Collection(this, function () { return createRange(lower, upper, !includeLower, !includeUpper); });\n            }\n            catch (e) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n        };\n        WhereClause.prototype.equals = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return rangeEqual(value); });\n        };\n        WhereClause.prototype.above = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(value, undefined, true); });\n        };\n        WhereClause.prototype.aboveOrEqual = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(value, undefined, false); });\n        };\n        WhereClause.prototype.below = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(undefined, value, false, true); });\n        };\n        WhereClause.prototype.belowOrEqual = function (value) {\n            if (value == null)\n                return fail(this, INVALID_KEY_ARGUMENT);\n            return new this.Collection(this, function () { return createRange(undefined, value); });\n        };\n        WhereClause.prototype.startsWith = function (str) {\n            if (typeof str !== 'string')\n                return fail(this, STRING_EXPECTED);\n            return this.between(str, str + maxString, true, true);\n        };\n        WhereClause.prototype.startsWithIgnoreCase = function (str) {\n            if (str === \"\")\n                return this.startsWith(str);\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return x.indexOf(a[0]) === 0; }, [str], maxString);\n        };\n        WhereClause.prototype.equalsIgnoreCase = function (str) {\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return x === a[0]; }, [str], \"\");\n        };\n        WhereClause.prototype.anyOfIgnoreCase = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (set.length === 0)\n                return emptyCollection(this);\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return a.indexOf(x) !== -1; }, set, \"\");\n        };\n        WhereClause.prototype.startsWithAnyOfIgnoreCase = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (set.length === 0)\n                return emptyCollection(this);\n            return addIgnoreCaseAlgorithm(this, function (x, a) { return a.some(function (n) { return x.indexOf(n) === 0; }); }, set, maxString);\n        };\n        WhereClause.prototype.anyOf = function () {\n            var _this = this;\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            var compare = this._cmp;\n            try {\n                set.sort(compare);\n            }\n            catch (e) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n            if (set.length === 0)\n                return emptyCollection(this);\n            var c = new this.Collection(this, function () { return createRange(set[0], set[set.length - 1]); });\n            c._ondirectionchange = function (direction) {\n                compare = (direction === \"next\" ?\n                    _this._ascending :\n                    _this._descending);\n                set.sort(compare);\n            };\n            var i = 0;\n            c._addAlgorithm(function (cursor, advance, resolve) {\n                var key = cursor.key;\n                while (compare(key, set[i]) > 0) {\n                    ++i;\n                    if (i === set.length) {\n                        advance(resolve);\n                        return false;\n                    }\n                }\n                if (compare(key, set[i]) === 0) {\n                    return true;\n                }\n                else {\n                    advance(function () { cursor.continue(set[i]); });\n                    return false;\n                }\n            });\n            return c;\n        };\n        WhereClause.prototype.notEqual = function (value) {\n            return this.inAnyRange([[minKey, value], [value, this.db._maxKey]], { includeLowers: false, includeUppers: false });\n        };\n        WhereClause.prototype.noneOf = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (set.length === 0)\n                return new this.Collection(this);\n            try {\n                set.sort(this._ascending);\n            }\n            catch (e) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n            var ranges = set.reduce(function (res, val) { return res ?\n                res.concat([[res[res.length - 1][1], val]]) :\n                [[minKey, val]]; }, null);\n            ranges.push([set[set.length - 1], this.db._maxKey]);\n            return this.inAnyRange(ranges, { includeLowers: false, includeUppers: false });\n        };\n        WhereClause.prototype.inAnyRange = function (ranges, options) {\n            var _this = this;\n            var cmp = this._cmp, ascending = this._ascending, descending = this._descending, min = this._min, max = this._max;\n            if (ranges.length === 0)\n                return emptyCollection(this);\n            if (!ranges.every(function (range) {\n                return range[0] !== undefined &&\n                    range[1] !== undefined &&\n                    ascending(range[0], range[1]) <= 0;\n            })) {\n                return fail(this, \"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower\", exceptions.InvalidArgument);\n            }\n            var includeLowers = !options || options.includeLowers !== false;\n            var includeUppers = options && options.includeUppers === true;\n            function addRange(ranges, newRange) {\n                var i = 0, l = ranges.length;\n                for (; i < l; ++i) {\n                    var range = ranges[i];\n                    if (cmp(newRange[0], range[1]) < 0 && cmp(newRange[1], range[0]) > 0) {\n                        range[0] = min(range[0], newRange[0]);\n                        range[1] = max(range[1], newRange[1]);\n                        break;\n                    }\n                }\n                if (i === l)\n                    ranges.push(newRange);\n                return ranges;\n            }\n            var sortDirection = ascending;\n            function rangeSorter(a, b) { return sortDirection(a[0], b[0]); }\n            var set;\n            try {\n                set = ranges.reduce(addRange, []);\n                set.sort(rangeSorter);\n            }\n            catch (ex) {\n                return fail(this, INVALID_KEY_ARGUMENT);\n            }\n            var rangePos = 0;\n            var keyIsBeyondCurrentEntry = includeUppers ?\n                function (key) { return ascending(key, set[rangePos][1]) > 0; } :\n                function (key) { return ascending(key, set[rangePos][1]) >= 0; };\n            var keyIsBeforeCurrentEntry = includeLowers ?\n                function (key) { return descending(key, set[rangePos][0]) > 0; } :\n                function (key) { return descending(key, set[rangePos][0]) >= 0; };\n            function keyWithinCurrentRange(key) {\n                return !keyIsBeyondCurrentEntry(key) && !keyIsBeforeCurrentEntry(key);\n            }\n            var checkKey = keyIsBeyondCurrentEntry;\n            var c = new this.Collection(this, function () { return createRange(set[0][0], set[set.length - 1][1], !includeLowers, !includeUppers); });\n            c._ondirectionchange = function (direction) {\n                if (direction === \"next\") {\n                    checkKey = keyIsBeyondCurrentEntry;\n                    sortDirection = ascending;\n                }\n                else {\n                    checkKey = keyIsBeforeCurrentEntry;\n                    sortDirection = descending;\n                }\n                set.sort(rangeSorter);\n            };\n            c._addAlgorithm(function (cursor, advance, resolve) {\n                var key = cursor.key;\n                while (checkKey(key)) {\n                    ++rangePos;\n                    if (rangePos === set.length) {\n                        advance(resolve);\n                        return false;\n                    }\n                }\n                if (keyWithinCurrentRange(key)) {\n                    return true;\n                }\n                else if (_this._cmp(key, set[rangePos][1]) === 0 || _this._cmp(key, set[rangePos][0]) === 0) {\n                    return false;\n                }\n                else {\n                    advance(function () {\n                        if (sortDirection === ascending)\n                            cursor.continue(set[rangePos][0]);\n                        else\n                            cursor.continue(set[rangePos][1]);\n                    });\n                    return false;\n                }\n            });\n            return c;\n        };\n        WhereClause.prototype.startsWithAnyOf = function () {\n            var set = getArrayOf.apply(NO_CHAR_ARRAY, arguments);\n            if (!set.every(function (s) { return typeof s === 'string'; })) {\n                return fail(this, \"startsWithAnyOf() only works with strings\");\n            }\n            if (set.length === 0)\n                return emptyCollection(this);\n            return this.inAnyRange(set.map(function (str) { return [str, str + maxString]; }));\n        };\n        return WhereClause;\n    }());\n\n    function createWhereClauseConstructor(db) {\n        return makeClassConstructor(WhereClause.prototype, function WhereClause(table, index, orCollection) {\n            this.db = db;\n            this._ctx = {\n                table: table,\n                index: index === \":id\" ? null : index,\n                or: orCollection\n            };\n            this._cmp = this._ascending = cmp;\n            this._descending = function (a, b) { return cmp(b, a); };\n            this._max = function (a, b) { return cmp(a, b) > 0 ? a : b; };\n            this._min = function (a, b) { return cmp(a, b) < 0 ? a : b; };\n            this._IDBKeyRange = db._deps.IDBKeyRange;\n            if (!this._IDBKeyRange)\n                throw new exceptions.MissingAPI();\n        });\n    }\n\n    function eventRejectHandler(reject) {\n        return wrap(function (event) {\n            preventDefault(event);\n            reject(event.target.error);\n            return false;\n        });\n    }\n    function preventDefault(event) {\n        if (event.stopPropagation)\n            event.stopPropagation();\n        if (event.preventDefault)\n            event.preventDefault();\n    }\n\n    var DEXIE_STORAGE_MUTATED_EVENT_NAME = 'storagemutated';\n    var STORAGE_MUTATED_DOM_EVENT_NAME = 'x-storagemutated-1';\n    var globalEvents = Events(null, DEXIE_STORAGE_MUTATED_EVENT_NAME);\n\n    var Transaction =  (function () {\n        function Transaction() {\n        }\n        Transaction.prototype._lock = function () {\n            assert(!PSD.global);\n            ++this._reculock;\n            if (this._reculock === 1 && !PSD.global)\n                PSD.lockOwnerFor = this;\n            return this;\n        };\n        Transaction.prototype._unlock = function () {\n            assert(!PSD.global);\n            if (--this._reculock === 0) {\n                if (!PSD.global)\n                    PSD.lockOwnerFor = null;\n                while (this._blockedFuncs.length > 0 && !this._locked()) {\n                    var fnAndPSD = this._blockedFuncs.shift();\n                    try {\n                        usePSD(fnAndPSD[1], fnAndPSD[0]);\n                    }\n                    catch (e) { }\n                }\n            }\n            return this;\n        };\n        Transaction.prototype._locked = function () {\n            return this._reculock && PSD.lockOwnerFor !== this;\n        };\n        Transaction.prototype.create = function (idbtrans) {\n            var _this = this;\n            if (!this.mode)\n                return this;\n            var idbdb = this.db.idbdb;\n            var dbOpenError = this.db._state.dbOpenError;\n            assert(!this.idbtrans);\n            if (!idbtrans && !idbdb) {\n                switch (dbOpenError && dbOpenError.name) {\n                    case \"DatabaseClosedError\":\n                        throw new exceptions.DatabaseClosed(dbOpenError);\n                    case \"MissingAPIError\":\n                        throw new exceptions.MissingAPI(dbOpenError.message, dbOpenError);\n                    default:\n                        throw new exceptions.OpenFailed(dbOpenError);\n                }\n            }\n            if (!this.active)\n                throw new exceptions.TransactionInactive();\n            assert(this._completion._state === null);\n            idbtrans = this.idbtrans = idbtrans ||\n                (this.db.core\n                    ? this.db.core.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability })\n                    : idbdb.transaction(this.storeNames, this.mode, { durability: this.chromeTransactionDurability }));\n            idbtrans.onerror = wrap(function (ev) {\n                preventDefault(ev);\n                _this._reject(idbtrans.error);\n            });\n            idbtrans.onabort = wrap(function (ev) {\n                preventDefault(ev);\n                _this.active && _this._reject(new exceptions.Abort(idbtrans.error));\n                _this.active = false;\n                _this.on(\"abort\").fire(ev);\n            });\n            idbtrans.oncomplete = wrap(function () {\n                _this.active = false;\n                _this._resolve();\n                if ('mutatedParts' in idbtrans) {\n                    globalEvents.storagemutated.fire(idbtrans[\"mutatedParts\"]);\n                }\n            });\n            return this;\n        };\n        Transaction.prototype._promise = function (mode, fn, bWriteLock) {\n            var _this = this;\n            if (mode === 'readwrite' && this.mode !== 'readwrite')\n                return rejection(new exceptions.ReadOnly(\"Transaction is readonly\"));\n            if (!this.active)\n                return rejection(new exceptions.TransactionInactive());\n            if (this._locked()) {\n                return new DexiePromise(function (resolve, reject) {\n                    _this._blockedFuncs.push([function () {\n                            _this._promise(mode, fn, bWriteLock).then(resolve, reject);\n                        }, PSD]);\n                });\n            }\n            else if (bWriteLock) {\n                return newScope(function () {\n                    var p = new DexiePromise(function (resolve, reject) {\n                        _this._lock();\n                        var rv = fn(resolve, reject, _this);\n                        if (rv && rv.then)\n                            rv.then(resolve, reject);\n                    });\n                    p.finally(function () { return _this._unlock(); });\n                    p._lib = true;\n                    return p;\n                });\n            }\n            else {\n                var p = new DexiePromise(function (resolve, reject) {\n                    var rv = fn(resolve, reject, _this);\n                    if (rv && rv.then)\n                        rv.then(resolve, reject);\n                });\n                p._lib = true;\n                return p;\n            }\n        };\n        Transaction.prototype._root = function () {\n            return this.parent ? this.parent._root() : this;\n        };\n        Transaction.prototype.waitFor = function (promiseLike) {\n            var root = this._root();\n            var promise = DexiePromise.resolve(promiseLike);\n            if (root._waitingFor) {\n                root._waitingFor = root._waitingFor.then(function () { return promise; });\n            }\n            else {\n                root._waitingFor = promise;\n                root._waitingQueue = [];\n                var store = root.idbtrans.objectStore(root.storeNames[0]);\n                (function spin() {\n                    ++root._spinCount;\n                    while (root._waitingQueue.length)\n                        (root._waitingQueue.shift())();\n                    if (root._waitingFor)\n                        store.get(-Infinity).onsuccess = spin;\n                }());\n            }\n            var currentWaitPromise = root._waitingFor;\n            return new DexiePromise(function (resolve, reject) {\n                promise.then(function (res) { return root._waitingQueue.push(wrap(resolve.bind(null, res))); }, function (err) { return root._waitingQueue.push(wrap(reject.bind(null, err))); }).finally(function () {\n                    if (root._waitingFor === currentWaitPromise) {\n                        root._waitingFor = null;\n                    }\n                });\n            });\n        };\n        Transaction.prototype.abort = function () {\n            if (this.active) {\n                this.active = false;\n                if (this.idbtrans)\n                    this.idbtrans.abort();\n                this._reject(new exceptions.Abort());\n            }\n        };\n        Transaction.prototype.table = function (tableName) {\n            var memoizedTables = (this._memoizedTables || (this._memoizedTables = {}));\n            if (hasOwn(memoizedTables, tableName))\n                return memoizedTables[tableName];\n            var tableSchema = this.schema[tableName];\n            if (!tableSchema) {\n                throw new exceptions.NotFound(\"Table \" + tableName + \" not part of transaction\");\n            }\n            var transactionBoundTable = new this.db.Table(tableName, tableSchema, this);\n            transactionBoundTable.core = this.db.core.table(tableName);\n            memoizedTables[tableName] = transactionBoundTable;\n            return transactionBoundTable;\n        };\n        return Transaction;\n    }());\n\n    function createTransactionConstructor(db) {\n        return makeClassConstructor(Transaction.prototype, function Transaction(mode, storeNames, dbschema, chromeTransactionDurability, parent) {\n            var _this = this;\n            if (mode !== 'readonly')\n                storeNames.forEach(function (storeName) {\n                    var _a;\n                    var yProps = (_a = dbschema[storeName]) === null || _a === void 0 ? void 0 : _a.yProps;\n                    if (yProps)\n                        storeNames = storeNames.concat(yProps.map(function (p) { return p.updatesTable; }));\n                });\n            this.db = db;\n            this.mode = mode;\n            this.storeNames = storeNames;\n            this.schema = dbschema;\n            this.chromeTransactionDurability = chromeTransactionDurability;\n            this.idbtrans = null;\n            this.on = Events(this, \"complete\", \"error\", \"abort\");\n            this.parent = parent || null;\n            this.active = true;\n            this._reculock = 0;\n            this._blockedFuncs = [];\n            this._resolve = null;\n            this._reject = null;\n            this._waitingFor = null;\n            this._waitingQueue = null;\n            this._spinCount = 0;\n            this._completion = new DexiePromise(function (resolve, reject) {\n                _this._resolve = resolve;\n                _this._reject = reject;\n            });\n            this._completion.then(function () {\n                _this.active = false;\n                _this.on.complete.fire();\n            }, function (e) {\n                var wasActive = _this.active;\n                _this.active = false;\n                _this.on.error.fire(e);\n                _this.parent ?\n                    _this.parent._reject(e) :\n                    wasActive && _this.idbtrans && _this.idbtrans.abort();\n                return rejection(e);\n            });\n        });\n    }\n\n    function createIndexSpec(name, keyPath, unique, multi, auto, compound, isPrimKey, type) {\n        return {\n            name: name,\n            keyPath: keyPath,\n            unique: unique,\n            multi: multi,\n            auto: auto,\n            compound: compound,\n            src: (unique && !isPrimKey ? '&' : '') + (multi ? '*' : '') + (auto ? \"++\" : \"\") + nameFromKeyPath(keyPath),\n            type: type\n        };\n    }\n    function nameFromKeyPath(keyPath) {\n        return typeof keyPath === 'string' ?\n            keyPath :\n            keyPath ? ('[' + [].join.call(keyPath, '+') + ']') : \"\";\n    }\n\n    function createTableSchema(name, primKey, indexes) {\n        return {\n            name: name,\n            primKey: primKey,\n            indexes: indexes,\n            mappedClass: null,\n            idxByName: arrayToObject(indexes, function (index) { return [index.name, index]; }),\n        };\n    }\n\n    function safariMultiStoreFix(storeNames) {\n        return storeNames.length === 1 ? storeNames[0] : storeNames;\n    }\n    var getMaxKey = function (IdbKeyRange) {\n        try {\n            IdbKeyRange.only([[]]);\n            getMaxKey = function () { return [[]]; };\n            return [[]];\n        }\n        catch (e) {\n            getMaxKey = function () { return maxString; };\n            return maxString;\n        }\n    };\n\n    function getKeyExtractor(keyPath) {\n        if (keyPath == null) {\n            return function () { return undefined; };\n        }\n        else if (typeof keyPath === 'string') {\n            return getSinglePathKeyExtractor(keyPath);\n        }\n        else {\n            return function (obj) { return getByKeyPath(obj, keyPath); };\n        }\n    }\n    function getSinglePathKeyExtractor(keyPath) {\n        var split = keyPath.split('.');\n        if (split.length === 1) {\n            return function (obj) { return obj[keyPath]; };\n        }\n        else {\n            return function (obj) { return getByKeyPath(obj, keyPath); };\n        }\n    }\n\n    function arrayify(arrayLike) {\n        return [].slice.call(arrayLike);\n    }\n    var _id_counter = 0;\n    function getKeyPathAlias(keyPath) {\n        return keyPath == null ?\n            \":id\" :\n            typeof keyPath === 'string' ?\n                keyPath :\n                \"[\".concat(keyPath.join('+'), \"]\");\n    }\n    function createDBCore(db, IdbKeyRange, tmpTrans) {\n        function extractSchema(db, trans) {\n            var tables = arrayify(db.objectStoreNames);\n            return {\n                schema: {\n                    name: db.name,\n                    tables: tables.map(function (table) { return trans.objectStore(table); }).map(function (store) {\n                        var keyPath = store.keyPath, autoIncrement = store.autoIncrement;\n                        var compound = isArray(keyPath);\n                        var outbound = keyPath == null;\n                        var indexByKeyPath = {};\n                        var result = {\n                            name: store.name,\n                            primaryKey: {\n                                name: null,\n                                isPrimaryKey: true,\n                                outbound: outbound,\n                                compound: compound,\n                                keyPath: keyPath,\n                                autoIncrement: autoIncrement,\n                                unique: true,\n                                extractKey: getKeyExtractor(keyPath)\n                            },\n                            indexes: arrayify(store.indexNames).map(function (indexName) { return store.index(indexName); })\n                                .map(function (index) {\n                                var name = index.name, unique = index.unique, multiEntry = index.multiEntry, keyPath = index.keyPath;\n                                var compound = isArray(keyPath);\n                                var result = {\n                                    name: name,\n                                    compound: compound,\n                                    keyPath: keyPath,\n                                    unique: unique,\n                                    multiEntry: multiEntry,\n                                    extractKey: getKeyExtractor(keyPath)\n                                };\n                                indexByKeyPath[getKeyPathAlias(keyPath)] = result;\n                                return result;\n                            }),\n                            getIndexByKeyPath: function (keyPath) { return indexByKeyPath[getKeyPathAlias(keyPath)]; }\n                        };\n                        indexByKeyPath[\":id\"] = result.primaryKey;\n                        if (keyPath != null) {\n                            indexByKeyPath[getKeyPathAlias(keyPath)] = result.primaryKey;\n                        }\n                        return result;\n                    })\n                },\n                hasGetAll: tables.length > 0 && ('getAll' in trans.objectStore(tables[0])) &&\n                    !(typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n                        !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n                        [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604)\n            };\n        }\n        function makeIDBKeyRange(range) {\n            if (range.type === 3 )\n                return null;\n            if (range.type === 4 )\n                throw new Error(\"Cannot convert never type to IDBKeyRange\");\n            var lower = range.lower, upper = range.upper, lowerOpen = range.lowerOpen, upperOpen = range.upperOpen;\n            var idbRange = lower === undefined ?\n                upper === undefined ?\n                    null :\n                    IdbKeyRange.upperBound(upper, !!upperOpen) :\n                upper === undefined ?\n                    IdbKeyRange.lowerBound(lower, !!lowerOpen) :\n                    IdbKeyRange.bound(lower, upper, !!lowerOpen, !!upperOpen);\n            return idbRange;\n        }\n        function createDbCoreTable(tableSchema) {\n            var tableName = tableSchema.name;\n            function mutate(_a) {\n                var trans = _a.trans, type = _a.type, keys = _a.keys, values = _a.values, range = _a.range;\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var store = trans.objectStore(tableName);\n                    var outbound = store.keyPath == null;\n                    var isAddOrPut = type === \"put\" || type === \"add\";\n                    if (!isAddOrPut && type !== 'delete' && type !== 'deleteRange')\n                        throw new Error(\"Invalid operation type: \" + type);\n                    var length = (keys || values || { length: 1 }).length;\n                    if (keys && values && keys.length !== values.length) {\n                        throw new Error(\"Given keys array must have same length as given values array.\");\n                    }\n                    if (length === 0)\n                        return resolve({ numFailures: 0, failures: {}, results: [], lastResult: undefined });\n                    var req;\n                    var reqs = [];\n                    var failures = [];\n                    var numFailures = 0;\n                    var errorHandler = function (event) {\n                        ++numFailures;\n                        preventDefault(event);\n                    };\n                    if (type === 'deleteRange') {\n                        if (range.type === 4 )\n                            return resolve({ numFailures: numFailures, failures: failures, results: [], lastResult: undefined });\n                        if (range.type === 3 )\n                            reqs.push(req = store.clear());\n                        else\n                            reqs.push(req = store.delete(makeIDBKeyRange(range)));\n                    }\n                    else {\n                        var _a = isAddOrPut ?\n                            outbound ?\n                                [values, keys] :\n                                [values, null] :\n                            [keys, null], args1 = _a[0], args2 = _a[1];\n                        if (isAddOrPut) {\n                            for (var i = 0; i < length; ++i) {\n                                reqs.push(req = (args2 && args2[i] !== undefined ?\n                                    store[type](args1[i], args2[i]) :\n                                    store[type](args1[i])));\n                                req.onerror = errorHandler;\n                            }\n                        }\n                        else {\n                            for (var i = 0; i < length; ++i) {\n                                reqs.push(req = store[type](args1[i]));\n                                req.onerror = errorHandler;\n                            }\n                        }\n                    }\n                    var done = function (event) {\n                        var lastResult = event.target.result;\n                        reqs.forEach(function (req, i) { return req.error != null && (failures[i] = req.error); });\n                        resolve({\n                            numFailures: numFailures,\n                            failures: failures,\n                            results: type === \"delete\" ? keys : reqs.map(function (req) { return req.result; }),\n                            lastResult: lastResult\n                        });\n                    };\n                    req.onerror = function (event) {\n                        errorHandler(event);\n                        done(event);\n                    };\n                    req.onsuccess = done;\n                });\n            }\n            function openCursor(_a) {\n                var trans = _a.trans, values = _a.values, query = _a.query, reverse = _a.reverse, unique = _a.unique;\n                return new Promise(function (resolve, reject) {\n                    resolve = wrap(resolve);\n                    var index = query.index, range = query.range;\n                    var store = trans.objectStore(tableName);\n                    var source = index.isPrimaryKey ?\n                        store :\n                        store.index(index.name);\n                    var direction = reverse ?\n                        unique ?\n                            \"prevunique\" :\n                            \"prev\" :\n                        unique ?\n                            \"nextunique\" :\n                            \"next\";\n                    var req = values || !('openKeyCursor' in source) ?\n                        source.openCursor(makeIDBKeyRange(range), direction) :\n                        source.openKeyCursor(makeIDBKeyRange(range), direction);\n                    req.onerror = eventRejectHandler(reject);\n                    req.onsuccess = wrap(function (ev) {\n                        var cursor = req.result;\n                        if (!cursor) {\n                            resolve(null);\n                            return;\n                        }\n                        cursor.___id = ++_id_counter;\n                        cursor.done = false;\n                        var _cursorContinue = cursor.continue.bind(cursor);\n                        var _cursorContinuePrimaryKey = cursor.continuePrimaryKey;\n                        if (_cursorContinuePrimaryKey)\n                            _cursorContinuePrimaryKey = _cursorContinuePrimaryKey.bind(cursor);\n                        var _cursorAdvance = cursor.advance.bind(cursor);\n                        var doThrowCursorIsNotStarted = function () { throw new Error(\"Cursor not started\"); };\n                        var doThrowCursorIsStopped = function () { throw new Error(\"Cursor not stopped\"); };\n                        cursor.trans = trans;\n                        cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsNotStarted;\n                        cursor.fail = wrap(reject);\n                        cursor.next = function () {\n                            var _this = this;\n                            var gotOne = 1;\n                            return this.start(function () { return gotOne-- ? _this.continue() : _this.stop(); }).then(function () { return _this; });\n                        };\n                        cursor.start = function (callback) {\n                            var iterationPromise = new Promise(function (resolveIteration, rejectIteration) {\n                                resolveIteration = wrap(resolveIteration);\n                                req.onerror = eventRejectHandler(rejectIteration);\n                                cursor.fail = rejectIteration;\n                                cursor.stop = function (value) {\n                                    cursor.stop = cursor.continue = cursor.continuePrimaryKey = cursor.advance = doThrowCursorIsStopped;\n                                    resolveIteration(value);\n                                };\n                            });\n                            var guardedCallback = function () {\n                                if (req.result) {\n                                    try {\n                                        callback();\n                                    }\n                                    catch (err) {\n                                        cursor.fail(err);\n                                    }\n                                }\n                                else {\n                                    cursor.done = true;\n                                    cursor.start = function () { throw new Error(\"Cursor behind last entry\"); };\n                                    cursor.stop();\n                                }\n                            };\n                            req.onsuccess = wrap(function (ev) {\n                                req.onsuccess = guardedCallback;\n                                guardedCallback();\n                            });\n                            cursor.continue = _cursorContinue;\n                            cursor.continuePrimaryKey = _cursorContinuePrimaryKey;\n                            cursor.advance = _cursorAdvance;\n                            guardedCallback();\n                            return iterationPromise;\n                        };\n                        resolve(cursor);\n                    }, reject);\n                });\n            }\n            function query(hasGetAll) {\n                return function (request) {\n                    return new Promise(function (resolve, reject) {\n                        resolve = wrap(resolve);\n                        var trans = request.trans, values = request.values, limit = request.limit, query = request.query;\n                        var nonInfinitLimit = limit === Infinity ? undefined : limit;\n                        var index = query.index, range = query.range;\n                        var store = trans.objectStore(tableName);\n                        var source = index.isPrimaryKey ? store : store.index(index.name);\n                        var idbKeyRange = makeIDBKeyRange(range);\n                        if (limit === 0)\n                            return resolve({ result: [] });\n                        if (hasGetAll) {\n                            var req = values ?\n                                source.getAll(idbKeyRange, nonInfinitLimit) :\n                                source.getAllKeys(idbKeyRange, nonInfinitLimit);\n                            req.onsuccess = function (event) { return resolve({ result: event.target.result }); };\n                            req.onerror = eventRejectHandler(reject);\n                        }\n                        else {\n                            var count_1 = 0;\n                            var req_1 = values || !('openKeyCursor' in source) ?\n                                source.openCursor(idbKeyRange) :\n                                source.openKeyCursor(idbKeyRange);\n                            var result_1 = [];\n                            req_1.onsuccess = function (event) {\n                                var cursor = req_1.result;\n                                if (!cursor)\n                                    return resolve({ result: result_1 });\n                                result_1.push(values ? cursor.value : cursor.primaryKey);\n                                if (++count_1 === limit)\n                                    return resolve({ result: result_1 });\n                                cursor.continue();\n                            };\n                            req_1.onerror = eventRejectHandler(reject);\n                        }\n                    });\n                };\n            }\n            return {\n                name: tableName,\n                schema: tableSchema,\n                mutate: mutate,\n                getMany: function (_a) {\n                    var trans = _a.trans, keys = _a.keys;\n                    return new Promise(function (resolve, reject) {\n                        resolve = wrap(resolve);\n                        var store = trans.objectStore(tableName);\n                        var length = keys.length;\n                        var result = new Array(length);\n                        var keyCount = 0;\n                        var callbackCount = 0;\n                        var req;\n                        var successHandler = function (event) {\n                            var req = event.target;\n                            if ((result[req._pos] = req.result) != null)\n                                ;\n                            if (++callbackCount === keyCount)\n                                resolve(result);\n                        };\n                        var errorHandler = eventRejectHandler(reject);\n                        for (var i = 0; i < length; ++i) {\n                            var key = keys[i];\n                            if (key != null) {\n                                req = store.get(keys[i]);\n                                req._pos = i;\n                                req.onsuccess = successHandler;\n                                req.onerror = errorHandler;\n                                ++keyCount;\n                            }\n                        }\n                        if (keyCount === 0)\n                            resolve(result);\n                    });\n                },\n                get: function (_a) {\n                    var trans = _a.trans, key = _a.key;\n                    return new Promise(function (resolve, reject) {\n                        resolve = wrap(resolve);\n                        var store = trans.objectStore(tableName);\n                        var req = store.get(key);\n                        req.onsuccess = function (event) { return resolve(event.target.result); };\n                        req.onerror = eventRejectHandler(reject);\n                    });\n                },\n                query: query(hasGetAll),\n                openCursor: openCursor,\n                count: function (_a) {\n                    var query = _a.query, trans = _a.trans;\n                    var index = query.index, range = query.range;\n                    return new Promise(function (resolve, reject) {\n                        var store = trans.objectStore(tableName);\n                        var source = index.isPrimaryKey ? store : store.index(index.name);\n                        var idbKeyRange = makeIDBKeyRange(range);\n                        var req = idbKeyRange ? source.count(idbKeyRange) : source.count();\n                        req.onsuccess = wrap(function (ev) { return resolve(ev.target.result); });\n                        req.onerror = eventRejectHandler(reject);\n                    });\n                }\n            };\n        }\n        var _a = extractSchema(db, tmpTrans), schema = _a.schema, hasGetAll = _a.hasGetAll;\n        var tables = schema.tables.map(function (tableSchema) { return createDbCoreTable(tableSchema); });\n        var tableMap = {};\n        tables.forEach(function (table) { return tableMap[table.name] = table; });\n        return {\n            stack: \"dbcore\",\n            transaction: db.transaction.bind(db),\n            table: function (name) {\n                var result = tableMap[name];\n                if (!result)\n                    throw new Error(\"Table '\".concat(name, \"' not found\"));\n                return tableMap[name];\n            },\n            MIN_KEY: -Infinity,\n            MAX_KEY: getMaxKey(IdbKeyRange),\n            schema: schema\n        };\n    }\n\n    function createMiddlewareStack(stackImpl, middlewares) {\n        return middlewares.reduce(function (down, _a) {\n            var create = _a.create;\n            return (__assign(__assign({}, down), create(down)));\n        }, stackImpl);\n    }\n    function createMiddlewareStacks(middlewares, idbdb, _a, tmpTrans) {\n        var IDBKeyRange = _a.IDBKeyRange; _a.indexedDB;\n        var dbcore = createMiddlewareStack(createDBCore(idbdb, IDBKeyRange, tmpTrans), middlewares.dbcore);\n        return {\n            dbcore: dbcore\n        };\n    }\n    function generateMiddlewareStacks(db, tmpTrans) {\n        var idbdb = tmpTrans.db;\n        var stacks = createMiddlewareStacks(db._middlewares, idbdb, db._deps, tmpTrans);\n        db.core = stacks.dbcore;\n        db.tables.forEach(function (table) {\n            var tableName = table.name;\n            if (db.core.schema.tables.some(function (tbl) { return tbl.name === tableName; })) {\n                table.core = db.core.table(tableName);\n                if (db[tableName] instanceof db.Table) {\n                    db[tableName].core = table.core;\n                }\n            }\n        });\n    }\n\n    function setApiOnPlace(db, objs, tableNames, dbschema) {\n        tableNames.forEach(function (tableName) {\n            var schema = dbschema[tableName];\n            objs.forEach(function (obj) {\n                var propDesc = getPropertyDescriptor(obj, tableName);\n                if (!propDesc || (\"value\" in propDesc && propDesc.value === undefined)) {\n                    if (obj === db.Transaction.prototype || obj instanceof db.Transaction) {\n                        setProp(obj, tableName, {\n                            get: function () { return this.table(tableName); },\n                            set: function (value) {\n                                defineProperty(this, tableName, { value: value, writable: true, configurable: true, enumerable: true });\n                            }\n                        });\n                    }\n                    else {\n                        obj[tableName] = new db.Table(tableName, schema);\n                    }\n                }\n            });\n        });\n    }\n    function removeTablesApi(db, objs) {\n        objs.forEach(function (obj) {\n            for (var key in obj) {\n                if (obj[key] instanceof db.Table)\n                    delete obj[key];\n            }\n        });\n    }\n    function lowerVersionFirst(a, b) {\n        return a._cfg.version - b._cfg.version;\n    }\n    function runUpgraders(db, oldVersion, idbUpgradeTrans, reject) {\n        var globalSchema = db._dbSchema;\n        if (idbUpgradeTrans.objectStoreNames.contains('$meta') && !globalSchema.$meta) {\n            globalSchema.$meta = createTableSchema(\"$meta\", parseIndexSyntax(\"\")[0], []);\n            db._storeNames.push('$meta');\n        }\n        var trans = db._createTransaction('readwrite', db._storeNames, globalSchema);\n        trans.create(idbUpgradeTrans);\n        trans._completion.catch(reject);\n        var rejectTransaction = trans._reject.bind(trans);\n        var transless = PSD.transless || PSD;\n        newScope(function () {\n            PSD.trans = trans;\n            PSD.transless = transless;\n            if (oldVersion === 0) {\n                keys(globalSchema).forEach(function (tableName) {\n                    createTable(idbUpgradeTrans, tableName, globalSchema[tableName].primKey, globalSchema[tableName].indexes);\n                });\n                generateMiddlewareStacks(db, idbUpgradeTrans);\n                DexiePromise.follow(function () { return db.on.populate.fire(trans); }).catch(rejectTransaction);\n            }\n            else {\n                generateMiddlewareStacks(db, idbUpgradeTrans);\n                return getExistingVersion(db, trans, oldVersion)\n                    .then(function (oldVersion) { return updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans); })\n                    .catch(rejectTransaction);\n            }\n        });\n    }\n    function patchCurrentVersion(db, idbUpgradeTrans) {\n        createMissingTables(db._dbSchema, idbUpgradeTrans);\n        if (idbUpgradeTrans.db.version % 10 === 0 && !idbUpgradeTrans.objectStoreNames.contains('$meta')) {\n            idbUpgradeTrans.db.createObjectStore('$meta').add(Math.ceil((idbUpgradeTrans.db.version / 10) - 1), 'version');\n        }\n        var globalSchema = buildGlobalSchema(db, db.idbdb, idbUpgradeTrans);\n        adjustToExistingIndexNames(db, db._dbSchema, idbUpgradeTrans);\n        var diff = getSchemaDiff(globalSchema, db._dbSchema);\n        var _loop_1 = function (tableChange) {\n            if (tableChange.change.length || tableChange.recreate) {\n                console.warn(\"Unable to patch indexes of table \".concat(tableChange.name, \" because it has changes on the type of index or primary key.\"));\n                return { value: void 0 };\n            }\n            var store = idbUpgradeTrans.objectStore(tableChange.name);\n            tableChange.add.forEach(function (idx) {\n                if (debug)\n                    console.debug(\"Dexie upgrade patch: Creating missing index \".concat(tableChange.name, \".\").concat(idx.src));\n                addIndex(store, idx);\n            });\n        };\n        for (var _i = 0, _a = diff.change; _i < _a.length; _i++) {\n            var tableChange = _a[_i];\n            var state_1 = _loop_1(tableChange);\n            if (typeof state_1 === \"object\")\n                return state_1.value;\n        }\n    }\n    function getExistingVersion(db, trans, oldVersion) {\n        if (trans.storeNames.includes('$meta')) {\n            return trans.table('$meta').get('version').then(function (metaVersion) {\n                return metaVersion != null ? metaVersion : oldVersion;\n            });\n        }\n        else {\n            return DexiePromise.resolve(oldVersion);\n        }\n    }\n    function updateTablesAndIndexes(db, oldVersion, trans, idbUpgradeTrans) {\n        var queue = [];\n        var versions = db._versions;\n        var globalSchema = db._dbSchema = buildGlobalSchema(db, db.idbdb, idbUpgradeTrans);\n        var versToRun = versions.filter(function (v) { return v._cfg.version >= oldVersion; });\n        if (versToRun.length === 0) {\n            return DexiePromise.resolve();\n        }\n        versToRun.forEach(function (version) {\n            queue.push(function () {\n                var oldSchema = globalSchema;\n                var newSchema = version._cfg.dbschema;\n                adjustToExistingIndexNames(db, oldSchema, idbUpgradeTrans);\n                adjustToExistingIndexNames(db, newSchema, idbUpgradeTrans);\n                globalSchema = db._dbSchema = newSchema;\n                var diff = getSchemaDiff(oldSchema, newSchema);\n                diff.add.forEach(function (tuple) {\n                    createTable(idbUpgradeTrans, tuple[0], tuple[1].primKey, tuple[1].indexes);\n                });\n                diff.change.forEach(function (change) {\n                    if (change.recreate) {\n                        throw new exceptions.Upgrade(\"Not yet support for changing primary key\");\n                    }\n                    else {\n                        var store_1 = idbUpgradeTrans.objectStore(change.name);\n                        change.add.forEach(function (idx) { return addIndex(store_1, idx); });\n                        change.change.forEach(function (idx) {\n                            store_1.deleteIndex(idx.name);\n                            addIndex(store_1, idx);\n                        });\n                        change.del.forEach(function (idxName) { return store_1.deleteIndex(idxName); });\n                    }\n                });\n                var contentUpgrade = version._cfg.contentUpgrade;\n                if (contentUpgrade && version._cfg.version > oldVersion) {\n                    generateMiddlewareStacks(db, idbUpgradeTrans);\n                    trans._memoizedTables = {};\n                    var upgradeSchema_1 = shallowClone(newSchema);\n                    diff.del.forEach(function (table) {\n                        upgradeSchema_1[table] = oldSchema[table];\n                    });\n                    removeTablesApi(db, [db.Transaction.prototype]);\n                    setApiOnPlace(db, [db.Transaction.prototype], keys(upgradeSchema_1), upgradeSchema_1);\n                    trans.schema = upgradeSchema_1;\n                    var contentUpgradeIsAsync_1 = isAsyncFunction(contentUpgrade);\n                    if (contentUpgradeIsAsync_1) {\n                        incrementExpectedAwaits();\n                    }\n                    var returnValue_1;\n                    var promiseFollowed = DexiePromise.follow(function () {\n                        returnValue_1 = contentUpgrade(trans);\n                        if (returnValue_1) {\n                            if (contentUpgradeIsAsync_1) {\n                                var decrementor = decrementExpectedAwaits.bind(null, null);\n                                returnValue_1.then(decrementor, decrementor);\n                            }\n                        }\n                    });\n                    return (returnValue_1 && typeof returnValue_1.then === 'function' ?\n                        DexiePromise.resolve(returnValue_1) : promiseFollowed.then(function () { return returnValue_1; }));\n                }\n            });\n            queue.push(function (idbtrans) {\n                var newSchema = version._cfg.dbschema;\n                deleteRemovedTables(newSchema, idbtrans);\n                removeTablesApi(db, [db.Transaction.prototype]);\n                setApiOnPlace(db, [db.Transaction.prototype], db._storeNames, db._dbSchema);\n                trans.schema = db._dbSchema;\n            });\n            queue.push(function (idbtrans) {\n                if (db.idbdb.objectStoreNames.contains('$meta')) {\n                    if (Math.ceil(db.idbdb.version / 10) === version._cfg.version) {\n                        db.idbdb.deleteObjectStore('$meta');\n                        delete db._dbSchema.$meta;\n                        db._storeNames = db._storeNames.filter(function (name) { return name !== '$meta'; });\n                    }\n                    else {\n                        idbtrans.objectStore('$meta').put(version._cfg.version, 'version');\n                    }\n                }\n            });\n        });\n        function runQueue() {\n            return queue.length ? DexiePromise.resolve(queue.shift()(trans.idbtrans)).then(runQueue) :\n                DexiePromise.resolve();\n        }\n        return runQueue().then(function () {\n            createMissingTables(globalSchema, idbUpgradeTrans);\n        });\n    }\n    function getSchemaDiff(oldSchema, newSchema) {\n        var diff = {\n            del: [],\n            add: [],\n            change: []\n        };\n        var table;\n        for (table in oldSchema) {\n            if (!newSchema[table])\n                diff.del.push(table);\n        }\n        for (table in newSchema) {\n            var oldDef = oldSchema[table], newDef = newSchema[table];\n            if (!oldDef) {\n                diff.add.push([table, newDef]);\n            }\n            else {\n                var change = {\n                    name: table,\n                    def: newDef,\n                    recreate: false,\n                    del: [],\n                    add: [],\n                    change: []\n                };\n                if ((\n                '' + (oldDef.primKey.keyPath || '')) !== ('' + (newDef.primKey.keyPath || '')) ||\n                    (oldDef.primKey.auto !== newDef.primKey.auto)) {\n                    change.recreate = true;\n                    diff.change.push(change);\n                }\n                else {\n                    var oldIndexes = oldDef.idxByName;\n                    var newIndexes = newDef.idxByName;\n                    var idxName = void 0;\n                    for (idxName in oldIndexes) {\n                        if (!newIndexes[idxName])\n                            change.del.push(idxName);\n                    }\n                    for (idxName in newIndexes) {\n                        var oldIdx = oldIndexes[idxName], newIdx = newIndexes[idxName];\n                        if (!oldIdx)\n                            change.add.push(newIdx);\n                        else if (oldIdx.src !== newIdx.src)\n                            change.change.push(newIdx);\n                    }\n                    if (change.del.length > 0 || change.add.length > 0 || change.change.length > 0) {\n                        diff.change.push(change);\n                    }\n                }\n            }\n        }\n        return diff;\n    }\n    function createTable(idbtrans, tableName, primKey, indexes) {\n        var store = idbtrans.db.createObjectStore(tableName, primKey.keyPath ?\n            { keyPath: primKey.keyPath, autoIncrement: primKey.auto } :\n            { autoIncrement: primKey.auto });\n        indexes.forEach(function (idx) { return addIndex(store, idx); });\n        return store;\n    }\n    function createMissingTables(newSchema, idbtrans) {\n        keys(newSchema).forEach(function (tableName) {\n            if (!idbtrans.db.objectStoreNames.contains(tableName)) {\n                if (debug)\n                    console.debug('Dexie: Creating missing table', tableName);\n                createTable(idbtrans, tableName, newSchema[tableName].primKey, newSchema[tableName].indexes);\n            }\n        });\n    }\n    function deleteRemovedTables(newSchema, idbtrans) {\n        [].slice.call(idbtrans.db.objectStoreNames).forEach(function (storeName) {\n            return newSchema[storeName] == null && idbtrans.db.deleteObjectStore(storeName);\n        });\n    }\n    function addIndex(store, idx) {\n        store.createIndex(idx.name, idx.keyPath, { unique: idx.unique, multiEntry: idx.multi });\n    }\n    function buildGlobalSchema(db, idbdb, tmpTrans) {\n        var globalSchema = {};\n        var dbStoreNames = slice(idbdb.objectStoreNames, 0);\n        dbStoreNames.forEach(function (storeName) {\n            var store = tmpTrans.objectStore(storeName);\n            var keyPath = store.keyPath;\n            var primKey = createIndexSpec(nameFromKeyPath(keyPath), keyPath || \"\", true, false, !!store.autoIncrement, keyPath && typeof keyPath !== \"string\", true);\n            var indexes = [];\n            for (var j = 0; j < store.indexNames.length; ++j) {\n                var idbindex = store.index(store.indexNames[j]);\n                keyPath = idbindex.keyPath;\n                var index = createIndexSpec(idbindex.name, keyPath, !!idbindex.unique, !!idbindex.multiEntry, false, keyPath && typeof keyPath !== \"string\", false);\n                indexes.push(index);\n            }\n            globalSchema[storeName] = createTableSchema(storeName, primKey, indexes);\n        });\n        return globalSchema;\n    }\n    function readGlobalSchema(db, idbdb, tmpTrans) {\n        db.verno = idbdb.version / 10;\n        var globalSchema = db._dbSchema = buildGlobalSchema(db, idbdb, tmpTrans);\n        db._storeNames = slice(idbdb.objectStoreNames, 0);\n        setApiOnPlace(db, [db._allTables], keys(globalSchema), globalSchema);\n    }\n    function verifyInstalledSchema(db, tmpTrans) {\n        var installedSchema = buildGlobalSchema(db, db.idbdb, tmpTrans);\n        var diff = getSchemaDiff(installedSchema, db._dbSchema);\n        return !(diff.add.length || diff.change.some(function (ch) { return ch.add.length || ch.change.length; }));\n    }\n    function adjustToExistingIndexNames(db, schema, idbtrans) {\n        var storeNames = idbtrans.db.objectStoreNames;\n        for (var i = 0; i < storeNames.length; ++i) {\n            var storeName = storeNames[i];\n            var store = idbtrans.objectStore(storeName);\n            db._hasGetAll = 'getAll' in store;\n            for (var j = 0; j < store.indexNames.length; ++j) {\n                var indexName = store.indexNames[j];\n                var keyPath = store.index(indexName).keyPath;\n                var dexieName = typeof keyPath === 'string' ? keyPath : \"[\" + slice(keyPath).join('+') + \"]\";\n                if (schema[storeName]) {\n                    var indexSpec = schema[storeName].idxByName[dexieName];\n                    if (indexSpec) {\n                        indexSpec.name = indexName;\n                        delete schema[storeName].idxByName[dexieName];\n                        schema[storeName].idxByName[indexName] = indexSpec;\n                    }\n                }\n            }\n        }\n        if (typeof navigator !== 'undefined' && /Safari/.test(navigator.userAgent) &&\n            !/(Chrome\\/|Edge\\/)/.test(navigator.userAgent) &&\n            _global.WorkerGlobalScope && _global instanceof _global.WorkerGlobalScope &&\n            [].concat(navigator.userAgent.match(/Safari\\/(\\d*)/))[1] < 604) {\n            db._hasGetAll = false;\n        }\n    }\n    function parseIndexSyntax(primKeyAndIndexes) {\n        return primKeyAndIndexes.split(',').map(function (index, indexNum) {\n            var _a;\n            var typeSplit = index.split(':');\n            var type = (_a = typeSplit[1]) === null || _a === void 0 ? void 0 : _a.trim();\n            index = typeSplit[0].trim();\n            var name = index.replace(/([&*]|\\+\\+)/g, \"\");\n            var keyPath = /^\\[/.test(name) ? name.match(/^\\[(.*)\\]$/)[1].split('+') : name;\n            return createIndexSpec(name, keyPath || null, /\\&/.test(index), /\\*/.test(index), /\\+\\+/.test(index), isArray(keyPath), indexNum === 0, type);\n        });\n    }\n\n    var Version =  (function () {\n        function Version() {\n        }\n        Version.prototype._createTableSchema = function (name, primKey, indexes) {\n            return createTableSchema(name, primKey, indexes);\n        };\n        Version.prototype._parseIndexSyntax = function (primKeyAndIndexes) {\n            return parseIndexSyntax(primKeyAndIndexes);\n        };\n        Version.prototype._parseStoresSpec = function (stores, outSchema) {\n            var _this = this;\n            keys(stores).forEach(function (tableName) {\n                if (stores[tableName] !== null) {\n                    var indexes = _this._parseIndexSyntax(stores[tableName]);\n                    var primKey = indexes.shift();\n                    if (!primKey) {\n                        throw new exceptions.Schema('Invalid schema for table ' + tableName + ': ' + stores[tableName]);\n                    }\n                    primKey.unique = true;\n                    if (primKey.multi)\n                        throw new exceptions.Schema('Primary key cannot be multiEntry*');\n                    indexes.forEach(function (idx) {\n                        if (idx.auto)\n                            throw new exceptions.Schema('Only primary key can be marked as autoIncrement (++)');\n                        if (!idx.keyPath)\n                            throw new exceptions.Schema('Index must have a name and cannot be an empty string');\n                    });\n                    var tblSchema = _this._createTableSchema(tableName, primKey, indexes);\n                    outSchema[tableName] = tblSchema;\n                }\n            });\n        };\n        Version.prototype.stores = function (stores) {\n            var db = this.db;\n            this._cfg.storesSource = this._cfg.storesSource\n                ? extend(this._cfg.storesSource, stores)\n                : stores;\n            var versions = db._versions;\n            var storesSpec = {};\n            var dbschema = {};\n            versions.forEach(function (version) {\n                extend(storesSpec, version._cfg.storesSource);\n                dbschema = version._cfg.dbschema = {};\n                version._parseStoresSpec(storesSpec, dbschema);\n            });\n            db._dbSchema = dbschema;\n            removeTablesApi(db, [db._allTables, db, db.Transaction.prototype]);\n            setApiOnPlace(db, [db._allTables, db, db.Transaction.prototype, this._cfg.tables], keys(dbschema), dbschema);\n            db._storeNames = keys(dbschema);\n            return this;\n        };\n        Version.prototype.upgrade = function (upgradeFunction) {\n            this._cfg.contentUpgrade = promisableChain(this._cfg.contentUpgrade || nop, upgradeFunction);\n            return this;\n        };\n        return Version;\n    }());\n\n    function createVersionConstructor(db) {\n        return makeClassConstructor(Version.prototype, function Version(versionNumber) {\n            this.db = db;\n            this._cfg = {\n                version: versionNumber,\n                storesSource: null,\n                dbschema: {},\n                tables: {},\n                contentUpgrade: null\n            };\n        });\n    }\n\n    function getDbNamesTable(indexedDB, IDBKeyRange) {\n        var dbNamesDB = indexedDB[\"_dbNamesDB\"];\n        if (!dbNamesDB) {\n            dbNamesDB = indexedDB[\"_dbNamesDB\"] = new Dexie$1(DBNAMES_DB, {\n                addons: [],\n                indexedDB: indexedDB,\n                IDBKeyRange: IDBKeyRange,\n            });\n            dbNamesDB.version(1).stores({ dbnames: \"name\" });\n        }\n        return dbNamesDB.table(\"dbnames\");\n    }\n    function hasDatabasesNative(indexedDB) {\n        return indexedDB && typeof indexedDB.databases === \"function\";\n    }\n    function getDatabaseNames(_a) {\n        var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n        return hasDatabasesNative(indexedDB)\n            ? Promise.resolve(indexedDB.databases()).then(function (infos) {\n                return infos\n                    .map(function (info) { return info.name; })\n                    .filter(function (name) { return name !== DBNAMES_DB; });\n            })\n            : getDbNamesTable(indexedDB, IDBKeyRange).toCollection().primaryKeys();\n    }\n    function _onDatabaseCreated(_a, name) {\n        var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n        !hasDatabasesNative(indexedDB) &&\n            name !== DBNAMES_DB &&\n            getDbNamesTable(indexedDB, IDBKeyRange).put({ name: name }).catch(nop);\n    }\n    function _onDatabaseDeleted(_a, name) {\n        var indexedDB = _a.indexedDB, IDBKeyRange = _a.IDBKeyRange;\n        !hasDatabasesNative(indexedDB) &&\n            name !== DBNAMES_DB &&\n            getDbNamesTable(indexedDB, IDBKeyRange).delete(name).catch(nop);\n    }\n\n    function vip(fn) {\n        return newScope(function () {\n            PSD.letThrough = true;\n            return fn();\n        });\n    }\n\n    function idbReady() {\n        var isSafari = !navigator.userAgentData &&\n            /Safari\\//.test(navigator.userAgent) &&\n            !/Chrom(e|ium)\\//.test(navigator.userAgent);\n        if (!isSafari || !indexedDB.databases)\n            return Promise.resolve();\n        var intervalId;\n        return new Promise(function (resolve) {\n            var tryIdb = function () { return indexedDB.databases().finally(resolve); };\n            intervalId = setInterval(tryIdb, 100);\n            tryIdb();\n        }).finally(function () { return clearInterval(intervalId); });\n    }\n\n    var _a;\n    function isEmptyRange(node) {\n        return !(\"from\" in node);\n    }\n    var RangeSet = function (fromOrTree, to) {\n        if (this) {\n            extend(this, arguments.length ? { d: 1, from: fromOrTree, to: arguments.length > 1 ? to : fromOrTree } : { d: 0 });\n        }\n        else {\n            var rv = new RangeSet();\n            if (fromOrTree && (\"d\" in fromOrTree)) {\n                extend(rv, fromOrTree);\n            }\n            return rv;\n        }\n    };\n    props(RangeSet.prototype, (_a = {\n            add: function (rangeSet) {\n                mergeRanges(this, rangeSet);\n                return this;\n            },\n            addKey: function (key) {\n                addRange(this, key, key);\n                return this;\n            },\n            addKeys: function (keys) {\n                var _this = this;\n                keys.forEach(function (key) { return addRange(_this, key, key); });\n                return this;\n            },\n            hasKey: function (key) {\n                var node = getRangeSetIterator(this).next(key).value;\n                return node && cmp(node.from, key) <= 0 && cmp(node.to, key) >= 0;\n            }\n        },\n        _a[iteratorSymbol] = function () {\n            return getRangeSetIterator(this);\n        },\n        _a));\n    function addRange(target, from, to) {\n        var diff = cmp(from, to);\n        if (isNaN(diff))\n            return;\n        if (diff > 0)\n            throw RangeError();\n        if (isEmptyRange(target))\n            return extend(target, { from: from, to: to, d: 1 });\n        var left = target.l;\n        var right = target.r;\n        if (cmp(to, target.from) < 0) {\n            left\n                ? addRange(left, from, to)\n                : (target.l = { from: from, to: to, d: 1, l: null, r: null });\n            return rebalance(target);\n        }\n        if (cmp(from, target.to) > 0) {\n            right\n                ? addRange(right, from, to)\n                : (target.r = { from: from, to: to, d: 1, l: null, r: null });\n            return rebalance(target);\n        }\n        if (cmp(from, target.from) < 0) {\n            target.from = from;\n            target.l = null;\n            target.d = right ? right.d + 1 : 1;\n        }\n        if (cmp(to, target.to) > 0) {\n            target.to = to;\n            target.r = null;\n            target.d = target.l ? target.l.d + 1 : 1;\n        }\n        var rightWasCutOff = !target.r;\n        if (left && !target.l) {\n            mergeRanges(target, left);\n        }\n        if (right && rightWasCutOff) {\n            mergeRanges(target, right);\n        }\n    }\n    function mergeRanges(target, newSet) {\n        function _addRangeSet(target, _a) {\n            var from = _a.from, to = _a.to, l = _a.l, r = _a.r;\n            addRange(target, from, to);\n            if (l)\n                _addRangeSet(target, l);\n            if (r)\n                _addRangeSet(target, r);\n        }\n        if (!isEmptyRange(newSet))\n            _addRangeSet(target, newSet);\n    }\n    function rangesOverlap(rangeSet1, rangeSet2) {\n        var i1 = getRangeSetIterator(rangeSet2);\n        var nextResult1 = i1.next();\n        if (nextResult1.done)\n            return false;\n        var a = nextResult1.value;\n        var i2 = getRangeSetIterator(rangeSet1);\n        var nextResult2 = i2.next(a.from);\n        var b = nextResult2.value;\n        while (!nextResult1.done && !nextResult2.done) {\n            if (cmp(b.from, a.to) <= 0 && cmp(b.to, a.from) >= 0)\n                return true;\n            cmp(a.from, b.from) < 0\n                ? (a = (nextResult1 = i1.next(b.from)).value)\n                : (b = (nextResult2 = i2.next(a.from)).value);\n        }\n        return false;\n    }\n    function getRangeSetIterator(node) {\n        var state = isEmptyRange(node) ? null : { s: 0, n: node };\n        return {\n            next: function (key) {\n                var keyProvided = arguments.length > 0;\n                while (state) {\n                    switch (state.s) {\n                        case 0:\n                            state.s = 1;\n                            if (keyProvided) {\n                                while (state.n.l && cmp(key, state.n.from) < 0)\n                                    state = { up: state, n: state.n.l, s: 1 };\n                            }\n                            else {\n                                while (state.n.l)\n                                    state = { up: state, n: state.n.l, s: 1 };\n                            }\n                        case 1:\n                            state.s = 2;\n                            if (!keyProvided || cmp(key, state.n.to) <= 0)\n                                return { value: state.n, done: false };\n                        case 2:\n                            if (state.n.r) {\n                                state.s = 3;\n                                state = { up: state, n: state.n.r, s: 0 };\n                                continue;\n                            }\n                        case 3:\n                            state = state.up;\n                    }\n                }\n                return { done: true };\n            },\n        };\n    }\n    function rebalance(target) {\n        var _a, _b;\n        var diff = (((_a = target.r) === null || _a === void 0 ? void 0 : _a.d) || 0) - (((_b = target.l) === null || _b === void 0 ? void 0 : _b.d) || 0);\n        var r = diff > 1 ? \"r\" : diff < -1 ? \"l\" : \"\";\n        if (r) {\n            var l = r === \"r\" ? \"l\" : \"r\";\n            var rootClone = __assign({}, target);\n            var oldRootRight = target[r];\n            target.from = oldRootRight.from;\n            target.to = oldRootRight.to;\n            target[r] = oldRootRight[r];\n            rootClone[r] = oldRootRight[l];\n            target[l] = rootClone;\n            rootClone.d = computeDepth(rootClone);\n        }\n        target.d = computeDepth(target);\n    }\n    function computeDepth(_a) {\n        var r = _a.r, l = _a.l;\n        return (r ? (l ? Math.max(r.d, l.d) : r.d) : l ? l.d : 0) + 1;\n    }\n\n    function extendObservabilitySet(target, newSet) {\n        keys(newSet).forEach(function (part) {\n            if (target[part])\n                mergeRanges(target[part], newSet[part]);\n            else\n                target[part] = cloneSimpleObjectTree(newSet[part]);\n        });\n        return target;\n    }\n\n    function obsSetsOverlap(os1, os2) {\n        return os1.all || os2.all || Object.keys(os1).some(function (key) { return os2[key] && rangesOverlap(os2[key], os1[key]); });\n    }\n\n    var cache = {};\n\n    var unsignaledParts = {};\n    var isTaskEnqueued = false;\n    function signalSubscribersLazily(part, optimistic) {\n        extendObservabilitySet(unsignaledParts, part);\n        if (!isTaskEnqueued) {\n            isTaskEnqueued = true;\n            setTimeout(function () {\n                isTaskEnqueued = false;\n                var parts = unsignaledParts;\n                unsignaledParts = {};\n                signalSubscribersNow(parts, false);\n            }, 0);\n        }\n    }\n    function signalSubscribersNow(updatedParts, deleteAffectedCacheEntries) {\n        if (deleteAffectedCacheEntries === void 0) { deleteAffectedCacheEntries = false; }\n        var queriesToSignal = new Set();\n        if (updatedParts.all) {\n            for (var _i = 0, _a = Object.values(cache); _i < _a.length; _i++) {\n                var tblCache = _a[_i];\n                collectTableSubscribers(tblCache, updatedParts, queriesToSignal, deleteAffectedCacheEntries);\n            }\n        }\n        else {\n            for (var key in updatedParts) {\n                var parts = /^idb\\:\\/\\/(.*)\\/(.*)\\//.exec(key);\n                if (parts) {\n                    var dbName = parts[1], tableName = parts[2];\n                    var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n                    if (tblCache)\n                        collectTableSubscribers(tblCache, updatedParts, queriesToSignal, deleteAffectedCacheEntries);\n                }\n            }\n        }\n        queriesToSignal.forEach(function (requery) { return requery(); });\n    }\n    function collectTableSubscribers(tblCache, updatedParts, outQueriesToSignal, deleteAffectedCacheEntries) {\n        var updatedEntryLists = [];\n        for (var _i = 0, _a = Object.entries(tblCache.queries.query); _i < _a.length; _i++) {\n            var _b = _a[_i], indexName = _b[0], entries = _b[1];\n            var filteredEntries = [];\n            for (var _c = 0, entries_1 = entries; _c < entries_1.length; _c++) {\n                var entry = entries_1[_c];\n                if (obsSetsOverlap(updatedParts, entry.obsSet)) {\n                    entry.subscribers.forEach(function (requery) { return outQueriesToSignal.add(requery); });\n                }\n                else if (deleteAffectedCacheEntries) {\n                    filteredEntries.push(entry);\n                }\n            }\n            if (deleteAffectedCacheEntries)\n                updatedEntryLists.push([indexName, filteredEntries]);\n        }\n        if (deleteAffectedCacheEntries) {\n            for (var _d = 0, updatedEntryLists_1 = updatedEntryLists; _d < updatedEntryLists_1.length; _d++) {\n                var _e = updatedEntryLists_1[_d], indexName = _e[0], filteredEntries = _e[1];\n                tblCache.queries.query[indexName] = filteredEntries;\n            }\n        }\n    }\n\n    function dexieOpen(db) {\n        var state = db._state;\n        var indexedDB = db._deps.indexedDB;\n        if (state.isBeingOpened || db.idbdb)\n            return state.dbReadyPromise.then(function () { return state.dbOpenError ?\n                rejection(state.dbOpenError) :\n                db; });\n        state.isBeingOpened = true;\n        state.dbOpenError = null;\n        state.openComplete = false;\n        var openCanceller = state.openCanceller;\n        var nativeVerToOpen = Math.round(db.verno * 10);\n        var schemaPatchMode = false;\n        function throwIfCancelled() {\n            if (state.openCanceller !== openCanceller)\n                throw new exceptions.DatabaseClosed('db.open() was cancelled');\n        }\n        var resolveDbReady = state.dbReadyResolve,\n        upgradeTransaction = null, wasCreated = false;\n        var tryOpenDB = function () { return new DexiePromise(function (resolve, reject) {\n            throwIfCancelled();\n            if (!indexedDB)\n                throw new exceptions.MissingAPI();\n            var dbName = db.name;\n            var req = state.autoSchema || !nativeVerToOpen ?\n                indexedDB.open(dbName) :\n                indexedDB.open(dbName, nativeVerToOpen);\n            if (!req)\n                throw new exceptions.MissingAPI();\n            req.onerror = eventRejectHandler(reject);\n            req.onblocked = wrap(db._fireOnBlocked);\n            req.onupgradeneeded = wrap(function (e) {\n                upgradeTransaction = req.transaction;\n                if (state.autoSchema && !db._options.allowEmptyDB) {\n                    req.onerror = preventDefault;\n                    upgradeTransaction.abort();\n                    req.result.close();\n                    var delreq = indexedDB.deleteDatabase(dbName);\n                    delreq.onsuccess = delreq.onerror = wrap(function () {\n                        reject(new exceptions.NoSuchDatabase(\"Database \".concat(dbName, \" doesnt exist\")));\n                    });\n                }\n                else {\n                    upgradeTransaction.onerror = eventRejectHandler(reject);\n                    var oldVer = e.oldVersion > Math.pow(2, 62) ? 0 : e.oldVersion;\n                    wasCreated = oldVer < 1;\n                    db.idbdb = req.result;\n                    if (schemaPatchMode) {\n                        patchCurrentVersion(db, upgradeTransaction);\n                    }\n                    runUpgraders(db, oldVer / 10, upgradeTransaction, reject);\n                }\n            }, reject);\n            req.onsuccess = wrap(function () {\n                upgradeTransaction = null;\n                var idbdb = db.idbdb = req.result;\n                var objectStoreNames = slice(idbdb.objectStoreNames);\n                if (objectStoreNames.length > 0)\n                    try {\n                        var tmpTrans = idbdb.transaction(safariMultiStoreFix(objectStoreNames), 'readonly');\n                        if (state.autoSchema)\n                            readGlobalSchema(db, idbdb, tmpTrans);\n                        else {\n                            adjustToExistingIndexNames(db, db._dbSchema, tmpTrans);\n                            if (!verifyInstalledSchema(db, tmpTrans) && !schemaPatchMode) {\n                                console.warn(\"Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this.\");\n                                idbdb.close();\n                                nativeVerToOpen = idbdb.version + 1;\n                                schemaPatchMode = true;\n                                return resolve(tryOpenDB());\n                            }\n                        }\n                        generateMiddlewareStacks(db, tmpTrans);\n                    }\n                    catch (e) {\n                    }\n                connections.push(db);\n                idbdb.onversionchange = wrap(function (ev) {\n                    state.vcFired = true;\n                    db.on(\"versionchange\").fire(ev);\n                });\n                idbdb.onclose = wrap(function () {\n                    db.close({ disableAutoOpen: false });\n                });\n                if (wasCreated)\n                    _onDatabaseCreated(db._deps, dbName);\n                resolve();\n            }, reject);\n        }).catch(function (err) {\n            switch (err === null || err === void 0 ? void 0 : err.name) {\n                case \"UnknownError\":\n                    if (state.PR1398_maxLoop > 0) {\n                        state.PR1398_maxLoop--;\n                        console.warn('Dexie: Workaround for Chrome UnknownError on open()');\n                        return tryOpenDB();\n                    }\n                    break;\n                case \"VersionError\":\n                    if (nativeVerToOpen > 0) {\n                        nativeVerToOpen = 0;\n                        return tryOpenDB();\n                    }\n                    break;\n            }\n            return DexiePromise.reject(err);\n        }); };\n        return DexiePromise.race([\n            openCanceller,\n            (typeof navigator === 'undefined' ? DexiePromise.resolve() : idbReady()).then(tryOpenDB)\n        ]).then(function () {\n            throwIfCancelled();\n            state.onReadyBeingFired = [];\n            return DexiePromise.resolve(vip(function () { return db.on.ready.fire(db.vip); })).then(function fireRemainders() {\n                if (state.onReadyBeingFired.length > 0) {\n                    var remainders_1 = state.onReadyBeingFired.reduce(promisableChain, nop);\n                    state.onReadyBeingFired = [];\n                    return DexiePromise.resolve(vip(function () { return remainders_1(db.vip); })).then(fireRemainders);\n                }\n            });\n        }).finally(function () {\n            if (state.openCanceller === openCanceller) {\n                state.onReadyBeingFired = null;\n                state.isBeingOpened = false;\n            }\n        }).catch(function (err) {\n            state.dbOpenError = err;\n            try {\n                upgradeTransaction && upgradeTransaction.abort();\n            }\n            catch (_a) { }\n            if (openCanceller === state.openCanceller) {\n                db._close();\n            }\n            return rejection(err);\n        }).finally(function () {\n            state.openComplete = true;\n            resolveDbReady();\n        }).then(function () {\n            if (wasCreated) {\n                var everything_1 = {};\n                db.tables.forEach(function (table) {\n                    table.schema.indexes.forEach(function (idx) {\n                        if (idx.name)\n                            everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/\").concat(idx.name)] = new RangeSet(-Infinity, [[[]]]);\n                    });\n                    everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/\")] = everything_1[\"idb://\".concat(db.name, \"/\").concat(table.name, \"/:dels\")] = new RangeSet(-Infinity, [[[]]]);\n                });\n                globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME).fire(everything_1);\n                signalSubscribersNow(everything_1, true);\n            }\n            return db;\n        });\n    }\n\n    function awaitIterator(iterator) {\n        var callNext = function (result) { return iterator.next(result); }, doThrow = function (error) { return iterator.throw(error); }, onSuccess = step(callNext), onError = step(doThrow);\n        function step(getNext) {\n            return function (val) {\n                var next = getNext(val), value = next.value;\n                return next.done ? value :\n                    (!value || typeof value.then !== 'function' ?\n                        isArray(value) ? Promise.all(value).then(onSuccess, onError) : onSuccess(value) :\n                        value.then(onSuccess, onError));\n            };\n        }\n        return step(callNext)();\n    }\n\n    function extractTransactionArgs(mode, _tableArgs_, scopeFunc) {\n        var i = arguments.length;\n        if (i < 2)\n            throw new exceptions.InvalidArgument(\"Too few arguments\");\n        var args = new Array(i - 1);\n        while (--i)\n            args[i - 1] = arguments[i];\n        scopeFunc = args.pop();\n        var tables = flatten(args);\n        return [mode, tables, scopeFunc];\n    }\n    function enterTransactionScope(db, mode, storeNames, parentTransaction, scopeFunc) {\n        return DexiePromise.resolve().then(function () {\n            var transless = PSD.transless || PSD;\n            var trans = db._createTransaction(mode, storeNames, db._dbSchema, parentTransaction);\n            trans.explicit = true;\n            var zoneProps = {\n                trans: trans,\n                transless: transless\n            };\n            if (parentTransaction) {\n                trans.idbtrans = parentTransaction.idbtrans;\n            }\n            else {\n                try {\n                    trans.create();\n                    trans.idbtrans._explicit = true;\n                    db._state.PR1398_maxLoop = 3;\n                }\n                catch (ex) {\n                    if (ex.name === errnames.InvalidState && db.isOpen() && --db._state.PR1398_maxLoop > 0) {\n                        console.warn('Dexie: Need to reopen db');\n                        db.close({ disableAutoOpen: false });\n                        return db.open().then(function () { return enterTransactionScope(db, mode, storeNames, null, scopeFunc); });\n                    }\n                    return rejection(ex);\n                }\n            }\n            var scopeFuncIsAsync = isAsyncFunction(scopeFunc);\n            if (scopeFuncIsAsync) {\n                incrementExpectedAwaits();\n            }\n            var returnValue;\n            var promiseFollowed = DexiePromise.follow(function () {\n                returnValue = scopeFunc.call(trans, trans);\n                if (returnValue) {\n                    if (scopeFuncIsAsync) {\n                        var decrementor = decrementExpectedAwaits.bind(null, null);\n                        returnValue.then(decrementor, decrementor);\n                    }\n                    else if (typeof returnValue.next === 'function' && typeof returnValue.throw === 'function') {\n                        returnValue = awaitIterator(returnValue);\n                    }\n                }\n            }, zoneProps);\n            return (returnValue && typeof returnValue.then === 'function' ?\n                DexiePromise.resolve(returnValue).then(function (x) { return trans.active ?\n                    x\n                    : rejection(new exceptions.PrematureCommit(\"Transaction committed too early. See http://bit.ly/2kdckMn\")); })\n                : promiseFollowed.then(function () { return returnValue; })).then(function (x) {\n                if (parentTransaction)\n                    trans._resolve();\n                return trans._completion.then(function () { return x; });\n            }).catch(function (e) {\n                trans._reject(e);\n                return rejection(e);\n            });\n        });\n    }\n\n    function pad(a, value, count) {\n        var result = isArray(a) ? a.slice() : [a];\n        for (var i = 0; i < count; ++i)\n            result.push(value);\n        return result;\n    }\n    function createVirtualIndexMiddleware(down) {\n        return __assign(__assign({}, down), { table: function (tableName) {\n                var table = down.table(tableName);\n                var schema = table.schema;\n                var indexLookup = {};\n                var allVirtualIndexes = [];\n                function addVirtualIndexes(keyPath, keyTail, lowLevelIndex) {\n                    var keyPathAlias = getKeyPathAlias(keyPath);\n                    var indexList = (indexLookup[keyPathAlias] = indexLookup[keyPathAlias] || []);\n                    var keyLength = keyPath == null ? 0 : typeof keyPath === 'string' ? 1 : keyPath.length;\n                    var isVirtual = keyTail > 0;\n                    var virtualIndex = __assign(__assign({}, lowLevelIndex), { name: isVirtual\n                            ? \"\".concat(keyPathAlias, \"(virtual-from:\").concat(lowLevelIndex.name, \")\")\n                            : lowLevelIndex.name, lowLevelIndex: lowLevelIndex, isVirtual: isVirtual, keyTail: keyTail, keyLength: keyLength, extractKey: getKeyExtractor(keyPath), unique: !isVirtual && lowLevelIndex.unique });\n                    indexList.push(virtualIndex);\n                    if (!virtualIndex.isPrimaryKey) {\n                        allVirtualIndexes.push(virtualIndex);\n                    }\n                    if (keyLength > 1) {\n                        var virtualKeyPath = keyLength === 2 ?\n                            keyPath[0] :\n                            keyPath.slice(0, keyLength - 1);\n                        addVirtualIndexes(virtualKeyPath, keyTail + 1, lowLevelIndex);\n                    }\n                    indexList.sort(function (a, b) { return a.keyTail - b.keyTail; });\n                    return virtualIndex;\n                }\n                var primaryKey = addVirtualIndexes(schema.primaryKey.keyPath, 0, schema.primaryKey);\n                indexLookup[\":id\"] = [primaryKey];\n                for (var _i = 0, _a = schema.indexes; _i < _a.length; _i++) {\n                    var index = _a[_i];\n                    addVirtualIndexes(index.keyPath, 0, index);\n                }\n                function findBestIndex(keyPath) {\n                    var result = indexLookup[getKeyPathAlias(keyPath)];\n                    return result && result[0];\n                }\n                function translateRange(range, keyTail) {\n                    return {\n                        type: range.type === 1  ?\n                            2  :\n                            range.type,\n                        lower: pad(range.lower, range.lowerOpen ? down.MAX_KEY : down.MIN_KEY, keyTail),\n                        lowerOpen: true,\n                        upper: pad(range.upper, range.upperOpen ? down.MIN_KEY : down.MAX_KEY, keyTail),\n                        upperOpen: true\n                    };\n                }\n                function translateRequest(req) {\n                    var index = req.query.index;\n                    return index.isVirtual ? __assign(__assign({}, req), { query: {\n                            index: index.lowLevelIndex,\n                            range: translateRange(req.query.range, index.keyTail)\n                        } }) : req;\n                }\n                var result = __assign(__assign({}, table), { schema: __assign(__assign({}, schema), { primaryKey: primaryKey, indexes: allVirtualIndexes, getIndexByKeyPath: findBestIndex }), count: function (req) {\n                        return table.count(translateRequest(req));\n                    }, query: function (req) {\n                        return table.query(translateRequest(req));\n                    }, openCursor: function (req) {\n                        var _a = req.query.index, keyTail = _a.keyTail, isVirtual = _a.isVirtual, keyLength = _a.keyLength;\n                        if (!isVirtual)\n                            return table.openCursor(req);\n                        function createVirtualCursor(cursor) {\n                            function _continue(key) {\n                                key != null ?\n                                    cursor.continue(pad(key, req.reverse ? down.MAX_KEY : down.MIN_KEY, keyTail)) :\n                                    req.unique ?\n                                        cursor.continue(cursor.key.slice(0, keyLength)\n                                            .concat(req.reverse\n                                            ? down.MIN_KEY\n                                            : down.MAX_KEY, keyTail)) :\n                                        cursor.continue();\n                            }\n                            var virtualCursor = Object.create(cursor, {\n                                continue: { value: _continue },\n                                continuePrimaryKey: {\n                                    value: function (key, primaryKey) {\n                                        cursor.continuePrimaryKey(pad(key, down.MAX_KEY, keyTail), primaryKey);\n                                    }\n                                },\n                                primaryKey: {\n                                    get: function () {\n                                        return cursor.primaryKey;\n                                    }\n                                },\n                                key: {\n                                    get: function () {\n                                        var key = cursor.key;\n                                        return keyLength === 1 ?\n                                            key[0] :\n                                            key.slice(0, keyLength);\n                                    }\n                                },\n                                value: {\n                                    get: function () {\n                                        return cursor.value;\n                                    }\n                                }\n                            });\n                            return virtualCursor;\n                        }\n                        return table.openCursor(translateRequest(req))\n                            .then(function (cursor) { return cursor && createVirtualCursor(cursor); });\n                    } });\n                return result;\n            } });\n    }\n    var virtualIndexMiddleware = {\n        stack: \"dbcore\",\n        name: \"VirtualIndexMiddleware\",\n        level: 1,\n        create: createVirtualIndexMiddleware\n    };\n\n    function getObjectDiff(a, b, rv, prfx) {\n        rv = rv || {};\n        prfx = prfx || '';\n        keys(a).forEach(function (prop) {\n            if (!hasOwn(b, prop)) {\n                rv[prfx + prop] = undefined;\n            }\n            else {\n                var ap = a[prop], bp = b[prop];\n                if (typeof ap === 'object' && typeof bp === 'object' && ap && bp) {\n                    var apTypeName = toStringTag(ap);\n                    var bpTypeName = toStringTag(bp);\n                    if (apTypeName !== bpTypeName) {\n                        rv[prfx + prop] = b[prop];\n                    }\n                    else if (apTypeName === 'Object') {\n                        getObjectDiff(ap, bp, rv, prfx + prop + '.');\n                    }\n                    else if (ap !== bp) {\n                        rv[prfx + prop] = b[prop];\n                    }\n                }\n                else if (ap !== bp)\n                    rv[prfx + prop] = b[prop];\n            }\n        });\n        keys(b).forEach(function (prop) {\n            if (!hasOwn(a, prop)) {\n                rv[prfx + prop] = b[prop];\n            }\n        });\n        return rv;\n    }\n\n    function getEffectiveKeys(primaryKey, req) {\n        if (req.type === 'delete')\n            return req.keys;\n        return req.keys || req.values.map(primaryKey.extractKey);\n    }\n\n    var hooksMiddleware = {\n        stack: \"dbcore\",\n        name: \"HooksMiddleware\",\n        level: 2,\n        create: function (downCore) { return (__assign(__assign({}, downCore), { table: function (tableName) {\n                var downTable = downCore.table(tableName);\n                var primaryKey = downTable.schema.primaryKey;\n                var tableMiddleware = __assign(__assign({}, downTable), { mutate: function (req) {\n                        var dxTrans = PSD.trans;\n                        var _a = dxTrans.table(tableName).hook, deleting = _a.deleting, creating = _a.creating, updating = _a.updating;\n                        switch (req.type) {\n                            case 'add':\n                                if (creating.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                            case 'put':\n                                if (creating.fire === nop && updating.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                            case 'delete':\n                                if (deleting.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return addPutOrDelete(req); }, true);\n                            case 'deleteRange':\n                                if (deleting.fire === nop)\n                                    break;\n                                return dxTrans._promise('readwrite', function () { return deleteRange(req); }, true);\n                        }\n                        return downTable.mutate(req);\n                        function addPutOrDelete(req) {\n                            var dxTrans = PSD.trans;\n                            var keys = req.keys || getEffectiveKeys(primaryKey, req);\n                            if (!keys)\n                                throw new Error(\"Keys missing\");\n                            req = req.type === 'add' || req.type === 'put' ? __assign(__assign({}, req), { keys: keys }) : __assign({}, req);\n                            if (req.type !== 'delete')\n                                req.values = __spreadArray([], req.values, true);\n                            if (req.keys)\n                                req.keys = __spreadArray([], req.keys, true);\n                            return getExistingValues(downTable, req, keys).then(function (existingValues) {\n                                var contexts = keys.map(function (key, i) {\n                                    var existingValue = existingValues[i];\n                                    var ctx = { onerror: null, onsuccess: null };\n                                    if (req.type === 'delete') {\n                                        deleting.fire.call(ctx, key, existingValue, dxTrans);\n                                    }\n                                    else if (req.type === 'add' || existingValue === undefined) {\n                                        var generatedPrimaryKey = creating.fire.call(ctx, key, req.values[i], dxTrans);\n                                        if (key == null && generatedPrimaryKey != null) {\n                                            key = generatedPrimaryKey;\n                                            req.keys[i] = key;\n                                            if (!primaryKey.outbound) {\n                                                setByKeyPath(req.values[i], primaryKey.keyPath, key);\n                                            }\n                                        }\n                                    }\n                                    else {\n                                        var objectDiff = getObjectDiff(existingValue, req.values[i]);\n                                        var additionalChanges_1 = updating.fire.call(ctx, objectDiff, key, existingValue, dxTrans);\n                                        if (additionalChanges_1) {\n                                            var requestedValue_1 = req.values[i];\n                                            Object.keys(additionalChanges_1).forEach(function (keyPath) {\n                                                if (hasOwn(requestedValue_1, keyPath)) {\n                                                    requestedValue_1[keyPath] = additionalChanges_1[keyPath];\n                                                }\n                                                else {\n                                                    setByKeyPath(requestedValue_1, keyPath, additionalChanges_1[keyPath]);\n                                                }\n                                            });\n                                        }\n                                    }\n                                    return ctx;\n                                });\n                                return downTable.mutate(req).then(function (_a) {\n                                    var failures = _a.failures, results = _a.results, numFailures = _a.numFailures, lastResult = _a.lastResult;\n                                    for (var i = 0; i < keys.length; ++i) {\n                                        var primKey = results ? results[i] : keys[i];\n                                        var ctx = contexts[i];\n                                        if (primKey == null) {\n                                            ctx.onerror && ctx.onerror(failures[i]);\n                                        }\n                                        else {\n                                            ctx.onsuccess && ctx.onsuccess(req.type === 'put' && existingValues[i] ?\n                                                req.values[i] :\n                                                primKey\n                                            );\n                                        }\n                                    }\n                                    return { failures: failures, results: results, numFailures: numFailures, lastResult: lastResult };\n                                }).catch(function (error) {\n                                    contexts.forEach(function (ctx) { return ctx.onerror && ctx.onerror(error); });\n                                    return Promise.reject(error);\n                                });\n                            });\n                        }\n                        function deleteRange(req) {\n                            return deleteNextChunk(req.trans, req.range, 10000);\n                        }\n                        function deleteNextChunk(trans, range, limit) {\n                            return downTable.query({ trans: trans, values: false, query: { index: primaryKey, range: range }, limit: limit })\n                                .then(function (_a) {\n                                var result = _a.result;\n                                return addPutOrDelete({ type: 'delete', keys: result, trans: trans }).then(function (res) {\n                                    if (res.numFailures > 0)\n                                        return Promise.reject(res.failures[0]);\n                                    if (result.length < limit) {\n                                        return { failures: [], numFailures: 0, lastResult: undefined };\n                                    }\n                                    else {\n                                        return deleteNextChunk(trans, __assign(__assign({}, range), { lower: result[result.length - 1], lowerOpen: true }), limit);\n                                    }\n                                });\n                            });\n                        }\n                    } });\n                return tableMiddleware;\n            } })); }\n    };\n    function getExistingValues(table, req, effectiveKeys) {\n        return req.type === \"add\"\n            ? Promise.resolve([])\n            : table.getMany({ trans: req.trans, keys: effectiveKeys, cache: \"immutable\" });\n    }\n\n    function getFromTransactionCache(keys, cache, clone) {\n        try {\n            if (!cache)\n                return null;\n            if (cache.keys.length < keys.length)\n                return null;\n            var result = [];\n            for (var i = 0, j = 0; i < cache.keys.length && j < keys.length; ++i) {\n                if (cmp(cache.keys[i], keys[j]) !== 0)\n                    continue;\n                result.push(clone ? deepClone(cache.values[i]) : cache.values[i]);\n                ++j;\n            }\n            return result.length === keys.length ? result : null;\n        }\n        catch (_a) {\n            return null;\n        }\n    }\n    var cacheExistingValuesMiddleware = {\n        stack: \"dbcore\",\n        level: -1,\n        create: function (core) {\n            return {\n                table: function (tableName) {\n                    var table = core.table(tableName);\n                    return __assign(__assign({}, table), { getMany: function (req) {\n                            if (!req.cache) {\n                                return table.getMany(req);\n                            }\n                            var cachedResult = getFromTransactionCache(req.keys, req.trans[\"_cache\"], req.cache === \"clone\");\n                            if (cachedResult) {\n                                return DexiePromise.resolve(cachedResult);\n                            }\n                            return table.getMany(req).then(function (res) {\n                                req.trans[\"_cache\"] = {\n                                    keys: req.keys,\n                                    values: req.cache === \"clone\" ? deepClone(res) : res,\n                                };\n                                return res;\n                            });\n                        }, mutate: function (req) {\n                            if (req.type !== \"add\")\n                                req.trans[\"_cache\"] = null;\n                            return table.mutate(req);\n                        } });\n                },\n            };\n        },\n    };\n\n    function isCachableContext(ctx, table) {\n        return (ctx.trans.mode === 'readonly' &&\n            !!ctx.subscr &&\n            !ctx.trans.explicit &&\n            ctx.trans.db._options.cache !== 'disabled' &&\n            !table.schema.primaryKey.outbound);\n    }\n\n    function isCachableRequest(type, req) {\n        switch (type) {\n            case 'query':\n                return req.values && !req.unique;\n            case 'get':\n                return false;\n            case 'getMany':\n                return false;\n            case 'count':\n                return false;\n            case 'openCursor':\n                return false;\n        }\n    }\n\n    var observabilityMiddleware = {\n        stack: \"dbcore\",\n        level: 0,\n        name: \"Observability\",\n        create: function (core) {\n            var dbName = core.schema.name;\n            var FULL_RANGE = new RangeSet(core.MIN_KEY, core.MAX_KEY);\n            return __assign(__assign({}, core), { transaction: function (stores, mode, options) {\n                    if (PSD.subscr && mode !== 'readonly') {\n                        throw new exceptions.ReadOnly(\"Readwrite transaction in liveQuery context. Querier source: \".concat(PSD.querier));\n                    }\n                    return core.transaction(stores, mode, options);\n                }, table: function (tableName) {\n                    var table = core.table(tableName);\n                    var schema = table.schema;\n                    var primaryKey = schema.primaryKey, indexes = schema.indexes;\n                    var extractKey = primaryKey.extractKey, outbound = primaryKey.outbound;\n                    var indexesWithAutoIncPK = primaryKey.autoIncrement && indexes.filter(function (index) { return index.compound && index.keyPath.includes(primaryKey.keyPath); });\n                    var tableClone = __assign(__assign({}, table), { mutate: function (req) {\n                            var _a, _b;\n                            var trans = req.trans;\n                            var mutatedParts = req.mutatedParts || (req.mutatedParts = {});\n                            var getRangeSet = function (indexName) {\n                                var part = \"idb://\".concat(dbName, \"/\").concat(tableName, \"/\").concat(indexName);\n                                return (mutatedParts[part] ||\n                                    (mutatedParts[part] = new RangeSet()));\n                            };\n                            var pkRangeSet = getRangeSet(\"\");\n                            var delsRangeSet = getRangeSet(\":dels\");\n                            var type = req.type;\n                            var _c = req.type === \"deleteRange\"\n                                ? [req.range]\n                                : req.type === \"delete\"\n                                    ? [req.keys]\n                                    : req.values.length < 50\n                                        ? [getEffectiveKeys(primaryKey, req).filter(function (id) { return id; }), req.values]\n                                        : [], keys = _c[0], newObjs = _c[1];\n                            var oldCache = req.trans[\"_cache\"];\n                            if (isArray(keys)) {\n                                pkRangeSet.addKeys(keys);\n                                var oldObjs = type === 'delete' || keys.length === newObjs.length ? getFromTransactionCache(keys, oldCache) : null;\n                                if (!oldObjs) {\n                                    delsRangeSet.addKeys(keys);\n                                }\n                                if (oldObjs || newObjs) {\n                                    trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs);\n                                }\n                            }\n                            else if (keys) {\n                                var range = {\n                                    from: (_a = keys.lower) !== null && _a !== void 0 ? _a : core.MIN_KEY,\n                                    to: (_b = keys.upper) !== null && _b !== void 0 ? _b : core.MAX_KEY\n                                };\n                                delsRangeSet.add(range);\n                                pkRangeSet.add(range);\n                            }\n                            else {\n                                pkRangeSet.add(FULL_RANGE);\n                                delsRangeSet.add(FULL_RANGE);\n                                schema.indexes.forEach(function (idx) { return getRangeSet(idx.name).add(FULL_RANGE); });\n                            }\n                            return table.mutate(req).then(function (res) {\n                                if (keys && (req.type === 'add' || req.type === 'put')) {\n                                    pkRangeSet.addKeys(res.results);\n                                    if (indexesWithAutoIncPK) {\n                                        indexesWithAutoIncPK.forEach(function (idx) {\n                                            var idxVals = req.values.map(function (v) { return idx.extractKey(v); });\n                                            var pkPos = idx.keyPath.findIndex(function (prop) { return prop === primaryKey.keyPath; });\n                                            for (var i = 0, len = res.results.length; i < len; ++i) {\n                                                idxVals[i][pkPos] = res.results[i];\n                                            }\n                                            getRangeSet(idx.name).addKeys(idxVals);\n                                        });\n                                    }\n                                }\n                                trans.mutatedParts = extendObservabilitySet(trans.mutatedParts || {}, mutatedParts);\n                                return res;\n                            });\n                        } });\n                    var getRange = function (_a) {\n                        var _b, _c;\n                        var _d = _a.query, index = _d.index, range = _d.range;\n                        return [\n                            index,\n                            new RangeSet((_b = range.lower) !== null && _b !== void 0 ? _b : core.MIN_KEY, (_c = range.upper) !== null && _c !== void 0 ? _c : core.MAX_KEY),\n                        ];\n                    };\n                    var readSubscribers = {\n                        get: function (req) { return [primaryKey, new RangeSet(req.key)]; },\n                        getMany: function (req) { return [primaryKey, new RangeSet().addKeys(req.keys)]; },\n                        count: getRange,\n                        query: getRange,\n                        openCursor: getRange,\n                    };\n                    keys(readSubscribers).forEach(function (method) {\n                        tableClone[method] = function (req) {\n                            var subscr = PSD.subscr;\n                            var isLiveQuery = !!subscr;\n                            var cachable = isCachableContext(PSD, table) && isCachableRequest(method, req);\n                            var obsSet = cachable\n                                ? req.obsSet = {}\n                                : subscr;\n                            if (isLiveQuery) {\n                                var getRangeSet = function (indexName) {\n                                    var part = \"idb://\".concat(dbName, \"/\").concat(tableName, \"/\").concat(indexName);\n                                    return (obsSet[part] ||\n                                        (obsSet[part] = new RangeSet()));\n                                };\n                                var pkRangeSet_1 = getRangeSet(\"\");\n                                var delsRangeSet_1 = getRangeSet(\":dels\");\n                                var _a = readSubscribers[method](req), queriedIndex = _a[0], queriedRanges = _a[1];\n                                if (method === 'query' && queriedIndex.isPrimaryKey && !req.values) {\n                                    delsRangeSet_1.add(queriedRanges);\n                                }\n                                else {\n                                    getRangeSet(queriedIndex.name || \"\").add(queriedRanges);\n                                }\n                                if (!queriedIndex.isPrimaryKey) {\n                                    if (method === \"count\") {\n                                        delsRangeSet_1.add(FULL_RANGE);\n                                    }\n                                    else {\n                                        var keysPromise_1 = method === \"query\" &&\n                                            outbound &&\n                                            req.values &&\n                                            table.query(__assign(__assign({}, req), { values: false }));\n                                        return table[method].apply(this, arguments).then(function (res) {\n                                            if (method === \"query\") {\n                                                if (outbound && req.values) {\n                                                    return keysPromise_1.then(function (_a) {\n                                                        var resultingKeys = _a.result;\n                                                        pkRangeSet_1.addKeys(resultingKeys);\n                                                        return res;\n                                                    });\n                                                }\n                                                var pKeys = req.values\n                                                    ? res.result.map(extractKey)\n                                                    : res.result;\n                                                if (req.values) {\n                                                    pkRangeSet_1.addKeys(pKeys);\n                                                }\n                                                else {\n                                                    delsRangeSet_1.addKeys(pKeys);\n                                                }\n                                            }\n                                            else if (method === \"openCursor\") {\n                                                var cursor_1 = res;\n                                                var wantValues_1 = req.values;\n                                                return (cursor_1 &&\n                                                    Object.create(cursor_1, {\n                                                        key: {\n                                                            get: function () {\n                                                                delsRangeSet_1.addKey(cursor_1.primaryKey);\n                                                                return cursor_1.key;\n                                                            },\n                                                        },\n                                                        primaryKey: {\n                                                            get: function () {\n                                                                var pkey = cursor_1.primaryKey;\n                                                                delsRangeSet_1.addKey(pkey);\n                                                                return pkey;\n                                                            },\n                                                        },\n                                                        value: {\n                                                            get: function () {\n                                                                wantValues_1 && pkRangeSet_1.addKey(cursor_1.primaryKey);\n                                                                return cursor_1.value;\n                                                            },\n                                                        },\n                                                    }));\n                                            }\n                                            return res;\n                                        });\n                                    }\n                                }\n                            }\n                            return table[method].apply(this, arguments);\n                        };\n                    });\n                    return tableClone;\n                } });\n        },\n    };\n    function trackAffectedIndexes(getRangeSet, schema, oldObjs, newObjs) {\n        function addAffectedIndex(ix) {\n            var rangeSet = getRangeSet(ix.name || \"\");\n            function extractKey(obj) {\n                return obj != null ? ix.extractKey(obj) : null;\n            }\n            var addKeyOrKeys = function (key) { return ix.multiEntry && isArray(key)\n                ? key.forEach(function (key) { return rangeSet.addKey(key); })\n                : rangeSet.addKey(key); };\n            (oldObjs || newObjs).forEach(function (_, i) {\n                var oldKey = oldObjs && extractKey(oldObjs[i]);\n                var newKey = newObjs && extractKey(newObjs[i]);\n                if (cmp(oldKey, newKey) !== 0) {\n                    if (oldKey != null)\n                        addKeyOrKeys(oldKey);\n                    if (newKey != null)\n                        addKeyOrKeys(newKey);\n                }\n            });\n        }\n        schema.indexes.forEach(addAffectedIndex);\n    }\n\n    function adjustOptimisticFromFailures(tblCache, req, res) {\n        if (res.numFailures === 0)\n            return req;\n        if (req.type === 'deleteRange') {\n            return null;\n        }\n        var numBulkOps = req.keys\n            ? req.keys.length\n            : 'values' in req && req.values\n                ? req.values.length\n                : 1;\n        if (res.numFailures === numBulkOps) {\n            return null;\n        }\n        var clone = __assign({}, req);\n        if (isArray(clone.keys)) {\n            clone.keys = clone.keys.filter(function (_, i) { return !(i in res.failures); });\n        }\n        if ('values' in clone && isArray(clone.values)) {\n            clone.values = clone.values.filter(function (_, i) { return !(i in res.failures); });\n        }\n        return clone;\n    }\n\n    function isAboveLower(key, range) {\n        return range.lower === undefined\n            ? true\n            : range.lowerOpen\n                ? cmp(key, range.lower) > 0\n                : cmp(key, range.lower) >= 0;\n    }\n    function isBelowUpper(key, range) {\n        return range.upper === undefined\n            ? true\n            : range.upperOpen\n                ? cmp(key, range.upper) < 0\n                : cmp(key, range.upper) <= 0;\n    }\n    function isWithinRange(key, range) {\n        return isAboveLower(key, range) && isBelowUpper(key, range);\n    }\n\n    function applyOptimisticOps(result, req, ops, table, cacheEntry, immutable) {\n        if (!ops || ops.length === 0)\n            return result;\n        var index = req.query.index;\n        var multiEntry = index.multiEntry;\n        var queryRange = req.query.range;\n        var primaryKey = table.schema.primaryKey;\n        var extractPrimKey = primaryKey.extractKey;\n        var extractIndex = index.extractKey;\n        var extractLowLevelIndex = (index.lowLevelIndex || index).extractKey;\n        var finalResult = ops.reduce(function (result, op) {\n            var modifedResult = result;\n            var includedValues = [];\n            if (op.type === 'add' || op.type === 'put') {\n                var includedPKs = new RangeSet();\n                for (var i = op.values.length - 1; i >= 0; --i) {\n                    var value = op.values[i];\n                    var pk = extractPrimKey(value);\n                    if (includedPKs.hasKey(pk))\n                        continue;\n                    var key = extractIndex(value);\n                    if (multiEntry && isArray(key)\n                        ? key.some(function (k) { return isWithinRange(k, queryRange); })\n                        : isWithinRange(key, queryRange)) {\n                        includedPKs.addKey(pk);\n                        includedValues.push(value);\n                    }\n                }\n            }\n            switch (op.type) {\n                case 'add': {\n                    var existingKeys_1 = new RangeSet().addKeys(req.values ? result.map(function (v) { return extractPrimKey(v); }) : result);\n                    modifedResult = result.concat(req.values\n                        ? includedValues.filter(function (v) {\n                            var key = extractPrimKey(v);\n                            if (existingKeys_1.hasKey(key))\n                                return false;\n                            existingKeys_1.addKey(key);\n                            return true;\n                        })\n                        : includedValues\n                            .map(function (v) { return extractPrimKey(v); })\n                            .filter(function (k) {\n                            if (existingKeys_1.hasKey(k))\n                                return false;\n                            existingKeys_1.addKey(k);\n                            return true;\n                        }));\n                    break;\n                }\n                case 'put': {\n                    var keySet_1 = new RangeSet().addKeys(op.values.map(function (v) { return extractPrimKey(v); }));\n                    modifedResult = result\n                        .filter(\n                    function (item) { return !keySet_1.hasKey(req.values ? extractPrimKey(item) : item); })\n                        .concat(\n                    req.values\n                        ? includedValues\n                        : includedValues.map(function (v) { return extractPrimKey(v); }));\n                    break;\n                }\n                case 'delete':\n                    var keysToDelete_1 = new RangeSet().addKeys(op.keys);\n                    modifedResult = result.filter(function (item) {\n                        return !keysToDelete_1.hasKey(req.values ? extractPrimKey(item) : item);\n                    });\n                    break;\n                case 'deleteRange':\n                    var range_1 = op.range;\n                    modifedResult = result.filter(function (item) { return !isWithinRange(extractPrimKey(item), range_1); });\n                    break;\n            }\n            return modifedResult;\n        }, result);\n        if (finalResult === result)\n            return result;\n        finalResult.sort(function (a, b) {\n            return cmp(extractLowLevelIndex(a), extractLowLevelIndex(b)) ||\n                cmp(extractPrimKey(a), extractPrimKey(b));\n        });\n        if (req.limit && req.limit < Infinity) {\n            if (finalResult.length > req.limit) {\n                finalResult.length = req.limit;\n            }\n            else if (result.length === req.limit && finalResult.length < req.limit) {\n                cacheEntry.dirty = true;\n            }\n        }\n        return immutable ? Object.freeze(finalResult) : finalResult;\n    }\n\n    function areRangesEqual(r1, r2) {\n        return (cmp(r1.lower, r2.lower) === 0 &&\n            cmp(r1.upper, r2.upper) === 0 &&\n            !!r1.lowerOpen === !!r2.lowerOpen &&\n            !!r1.upperOpen === !!r2.upperOpen);\n    }\n\n    function compareLowers(lower1, lower2, lowerOpen1, lowerOpen2) {\n        if (lower1 === undefined)\n            return lower2 !== undefined ? -1 : 0;\n        if (lower2 === undefined)\n            return 1;\n        var c = cmp(lower1, lower2);\n        if (c === 0) {\n            if (lowerOpen1 && lowerOpen2)\n                return 0;\n            if (lowerOpen1)\n                return 1;\n            if (lowerOpen2)\n                return -1;\n        }\n        return c;\n    }\n    function compareUppers(upper1, upper2, upperOpen1, upperOpen2) {\n        if (upper1 === undefined)\n            return upper2 !== undefined ? 1 : 0;\n        if (upper2 === undefined)\n            return -1;\n        var c = cmp(upper1, upper2);\n        if (c === 0) {\n            if (upperOpen1 && upperOpen2)\n                return 0;\n            if (upperOpen1)\n                return -1;\n            if (upperOpen2)\n                return 1;\n        }\n        return c;\n    }\n    function isSuperRange(r1, r2) {\n        return (compareLowers(r1.lower, r2.lower, r1.lowerOpen, r2.lowerOpen) <= 0 &&\n            compareUppers(r1.upper, r2.upper, r1.upperOpen, r2.upperOpen) >= 0);\n    }\n\n    function findCompatibleQuery(dbName, tableName, type, req) {\n        var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n        if (!tblCache)\n            return [];\n        var queries = tblCache.queries[type];\n        if (!queries)\n            return [null, false, tblCache, null];\n        var indexName = req.query ? req.query.index.name : null;\n        var entries = queries[indexName || ''];\n        if (!entries)\n            return [null, false, tblCache, null];\n        switch (type) {\n            case 'query':\n                var equalEntry = entries.find(function (entry) {\n                    return entry.req.limit === req.limit &&\n                        entry.req.values === req.values &&\n                        areRangesEqual(entry.req.query.range, req.query.range);\n                });\n                if (equalEntry)\n                    return [\n                        equalEntry,\n                        true,\n                        tblCache,\n                        entries,\n                    ];\n                var superEntry = entries.find(function (entry) {\n                    var limit = 'limit' in entry.req ? entry.req.limit : Infinity;\n                    return (limit >= req.limit &&\n                        (req.values ? entry.req.values : true) &&\n                        isSuperRange(entry.req.query.range, req.query.range));\n                });\n                return [superEntry, false, tblCache, entries];\n            case 'count':\n                var countQuery = entries.find(function (entry) {\n                    return areRangesEqual(entry.req.query.range, req.query.range);\n                });\n                return [countQuery, !!countQuery, tblCache, entries];\n        }\n    }\n\n    function subscribeToCacheEntry(cacheEntry, container, requery, signal) {\n        cacheEntry.subscribers.add(requery);\n        signal.addEventListener(\"abort\", function () {\n            cacheEntry.subscribers.delete(requery);\n            if (cacheEntry.subscribers.size === 0) {\n                enqueForDeletion(cacheEntry, container);\n            }\n        });\n    }\n    function enqueForDeletion(cacheEntry, container) {\n        setTimeout(function () {\n            if (cacheEntry.subscribers.size === 0) {\n                delArrayItem(container, cacheEntry);\n            }\n        }, 3000);\n    }\n\n    var cacheMiddleware = {\n        stack: 'dbcore',\n        level: 0,\n        name: 'Cache',\n        create: function (core) {\n            var dbName = core.schema.name;\n            var coreMW = __assign(__assign({}, core), { transaction: function (stores, mode, options) {\n                    var idbtrans = core.transaction(stores, mode, options);\n                    if (mode === 'readwrite') {\n                        var ac_1 = new AbortController();\n                        var signal = ac_1.signal;\n                        var endTransaction = function (wasCommitted) { return function () {\n                            ac_1.abort();\n                            if (mode === 'readwrite') {\n                                var affectedSubscribers_1 = new Set();\n                                for (var _i = 0, stores_1 = stores; _i < stores_1.length; _i++) {\n                                    var storeName = stores_1[_i];\n                                    var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(storeName)];\n                                    if (tblCache) {\n                                        var table = core.table(storeName);\n                                        var ops = tblCache.optimisticOps.filter(function (op) { return op.trans === idbtrans; });\n                                        if (idbtrans._explicit && wasCommitted && idbtrans.mutatedParts) {\n                                            for (var _a = 0, _b = Object.values(tblCache.queries.query); _a < _b.length; _a++) {\n                                                var entries = _b[_a];\n                                                for (var _c = 0, _d = entries.slice(); _c < _d.length; _c++) {\n                                                    var entry = _d[_c];\n                                                    if (obsSetsOverlap(entry.obsSet, idbtrans.mutatedParts)) {\n                                                        delArrayItem(entries, entry);\n                                                        entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                    }\n                                                }\n                                            }\n                                        }\n                                        else if (ops.length > 0) {\n                                            tblCache.optimisticOps = tblCache.optimisticOps.filter(function (op) { return op.trans !== idbtrans; });\n                                            for (var _e = 0, _f = Object.values(tblCache.queries.query); _e < _f.length; _e++) {\n                                                var entries = _f[_e];\n                                                for (var _g = 0, _h = entries.slice(); _g < _h.length; _g++) {\n                                                    var entry = _h[_g];\n                                                    if (entry.res != null &&\n                                                        idbtrans.mutatedParts\n    ) {\n                                                        if (wasCommitted && !entry.dirty) {\n                                                            var freezeResults = Object.isFrozen(entry.res);\n                                                            var modRes = applyOptimisticOps(entry.res, entry.req, ops, table, entry, freezeResults);\n                                                            if (entry.dirty) {\n                                                                delArrayItem(entries, entry);\n                                                                entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                            }\n                                                            else if (modRes !== entry.res) {\n                                                                entry.res = modRes;\n                                                                entry.promise = DexiePromise.resolve({ result: modRes });\n                                                            }\n                                                        }\n                                                        else {\n                                                            if (entry.dirty) {\n                                                                delArrayItem(entries, entry);\n                                                            }\n                                                            entry.subscribers.forEach(function (requery) { return affectedSubscribers_1.add(requery); });\n                                                        }\n                                                    }\n                                                }\n                                            }\n                                        }\n                                    }\n                                }\n                                affectedSubscribers_1.forEach(function (requery) { return requery(); });\n                            }\n                        }; };\n                        idbtrans.addEventListener('abort', endTransaction(false), {\n                            signal: signal,\n                        });\n                        idbtrans.addEventListener('error', endTransaction(false), {\n                            signal: signal,\n                        });\n                        idbtrans.addEventListener('complete', endTransaction(true), {\n                            signal: signal,\n                        });\n                    }\n                    return idbtrans;\n                }, table: function (tableName) {\n                    var downTable = core.table(tableName);\n                    var primKey = downTable.schema.primaryKey;\n                    var tableMW = __assign(__assign({}, downTable), { mutate: function (req) {\n                            var trans = PSD.trans;\n                            if (primKey.outbound ||\n                                trans.db._options.cache === 'disabled' ||\n                                trans.explicit ||\n                                trans.idbtrans.mode !== 'readwrite'\n                            ) {\n                                return downTable.mutate(req);\n                            }\n                            var tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)];\n                            if (!tblCache)\n                                return downTable.mutate(req);\n                            var promise = downTable.mutate(req);\n                            if ((req.type === 'add' || req.type === 'put') && (req.values.length >= 50 || getEffectiveKeys(primKey, req).some(function (key) { return key == null; }))) {\n                                promise.then(function (res) {\n                                    var reqWithResolvedKeys = __assign(__assign({}, req), { values: req.values.map(function (value, i) {\n                                            var _a;\n                                            if (res.failures[i])\n                                                return value;\n                                            var valueWithKey = ((_a = primKey.keyPath) === null || _a === void 0 ? void 0 : _a.includes('.'))\n                                                ? deepClone(value)\n                                                : __assign({}, value);\n                                            setByKeyPath(valueWithKey, primKey.keyPath, res.results[i]);\n                                            return valueWithKey;\n                                        }) });\n                                    var adjustedReq = adjustOptimisticFromFailures(tblCache, reqWithResolvedKeys, res);\n                                    tblCache.optimisticOps.push(adjustedReq);\n                                    queueMicrotask(function () { return req.mutatedParts && signalSubscribersLazily(req.mutatedParts); });\n                                });\n                            }\n                            else {\n                                tblCache.optimisticOps.push(req);\n                                req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                                promise.then(function (res) {\n                                    if (res.numFailures > 0) {\n                                        delArrayItem(tblCache.optimisticOps, req);\n                                        var adjustedReq = adjustOptimisticFromFailures(tblCache, req, res);\n                                        if (adjustedReq) {\n                                            tblCache.optimisticOps.push(adjustedReq);\n                                        }\n                                        req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                                    }\n                                });\n                                promise.catch(function () {\n                                    delArrayItem(tblCache.optimisticOps, req);\n                                    req.mutatedParts && signalSubscribersLazily(req.mutatedParts);\n                                });\n                            }\n                            return promise;\n                        }, query: function (req) {\n                            var _a;\n                            if (!isCachableContext(PSD, downTable) || !isCachableRequest(\"query\", req))\n                                return downTable.query(req);\n                            var freezeResults = ((_a = PSD.trans) === null || _a === void 0 ? void 0 : _a.db._options.cache) === 'immutable';\n                            var _b = PSD, requery = _b.requery, signal = _b.signal;\n                            var _c = findCompatibleQuery(dbName, tableName, 'query', req), cacheEntry = _c[0], exactMatch = _c[1], tblCache = _c[2], container = _c[3];\n                            if (cacheEntry && exactMatch) {\n                                cacheEntry.obsSet = req.obsSet;\n                            }\n                            else {\n                                var promise = downTable.query(req).then(function (res) {\n                                    var result = res.result;\n                                    if (cacheEntry)\n                                        cacheEntry.res = result;\n                                    if (freezeResults) {\n                                        for (var i = 0, l = result.length; i < l; ++i) {\n                                            Object.freeze(result[i]);\n                                        }\n                                        Object.freeze(result);\n                                    }\n                                    else {\n                                        res.result = deepClone(result);\n                                    }\n                                    return res;\n                                }).catch(function (error) {\n                                    if (container && cacheEntry)\n                                        delArrayItem(container, cacheEntry);\n                                    return Promise.reject(error);\n                                });\n                                cacheEntry = {\n                                    obsSet: req.obsSet,\n                                    promise: promise,\n                                    subscribers: new Set(),\n                                    type: 'query',\n                                    req: req,\n                                    dirty: false,\n                                };\n                                if (container) {\n                                    container.push(cacheEntry);\n                                }\n                                else {\n                                    container = [cacheEntry];\n                                    if (!tblCache) {\n                                        tblCache = cache[\"idb://\".concat(dbName, \"/\").concat(tableName)] = {\n                                            queries: {\n                                                query: {},\n                                                count: {},\n                                            },\n                                            objs: new Map(),\n                                            optimisticOps: [],\n                                            unsignaledParts: {}\n                                        };\n                                    }\n                                    tblCache.queries.query[req.query.index.name || ''] = container;\n                                }\n                            }\n                            subscribeToCacheEntry(cacheEntry, container, requery, signal);\n                            return cacheEntry.promise.then(function (res) {\n                                return {\n                                    result: applyOptimisticOps(res.result, req, tblCache === null || tblCache === void 0 ? void 0 : tblCache.optimisticOps, downTable, cacheEntry, freezeResults),\n                                };\n                            });\n                        } });\n                    return tableMW;\n                } });\n            return coreMW;\n        },\n    };\n\n    function vipify(target, vipDb) {\n        return new Proxy(target, {\n            get: function (target, prop, receiver) {\n                if (prop === 'db')\n                    return vipDb;\n                return Reflect.get(target, prop, receiver);\n            }\n        });\n    }\n\n    var Dexie$1 =  (function () {\n        function Dexie(name, options) {\n            var _this = this;\n            this._middlewares = {};\n            this.verno = 0;\n            var deps = Dexie.dependencies;\n            this._options = options = __assign({\n                addons: Dexie.addons, autoOpen: true,\n                indexedDB: deps.indexedDB, IDBKeyRange: deps.IDBKeyRange, cache: 'cloned' }, options);\n            this._deps = {\n                indexedDB: options.indexedDB,\n                IDBKeyRange: options.IDBKeyRange\n            };\n            var addons = options.addons;\n            this._dbSchema = {};\n            this._versions = [];\n            this._storeNames = [];\n            this._allTables = {};\n            this.idbdb = null;\n            this._novip = this;\n            var state = {\n                dbOpenError: null,\n                isBeingOpened: false,\n                onReadyBeingFired: null,\n                openComplete: false,\n                dbReadyResolve: nop,\n                dbReadyPromise: null,\n                cancelOpen: nop,\n                openCanceller: null,\n                autoSchema: true,\n                PR1398_maxLoop: 3,\n                autoOpen: options.autoOpen,\n            };\n            state.dbReadyPromise = new DexiePromise(function (resolve) {\n                state.dbReadyResolve = resolve;\n            });\n            state.openCanceller = new DexiePromise(function (_, reject) {\n                state.cancelOpen = reject;\n            });\n            this._state = state;\n            this.name = name;\n            this.on = Events(this, \"populate\", \"blocked\", \"versionchange\", \"close\", { ready: [promisableChain, nop] });\n            this.once = function (event, callback) {\n                var fn = function () {\n                    var args = [];\n                    for (var _i = 0; _i < arguments.length; _i++) {\n                        args[_i] = arguments[_i];\n                    }\n                    _this.on(event).unsubscribe(fn);\n                    callback.apply(_this, args);\n                };\n                return _this.on(event, fn);\n            };\n            this.on.ready.subscribe = override(this.on.ready.subscribe, function (subscribe) {\n                return function (subscriber, bSticky) {\n                    Dexie.vip(function () {\n                        var state = _this._state;\n                        if (state.openComplete) {\n                            if (!state.dbOpenError)\n                                DexiePromise.resolve().then(subscriber);\n                            if (bSticky)\n                                subscribe(subscriber);\n                        }\n                        else if (state.onReadyBeingFired) {\n                            state.onReadyBeingFired.push(subscriber);\n                            if (bSticky)\n                                subscribe(subscriber);\n                        }\n                        else {\n                            subscribe(subscriber);\n                            var db_1 = _this;\n                            if (!bSticky)\n                                subscribe(function unsubscribe() {\n                                    db_1.on.ready.unsubscribe(subscriber);\n                                    db_1.on.ready.unsubscribe(unsubscribe);\n                                });\n                        }\n                    });\n                };\n            });\n            this.Collection = createCollectionConstructor(this);\n            this.Table = createTableConstructor(this);\n            this.Transaction = createTransactionConstructor(this);\n            this.Version = createVersionConstructor(this);\n            this.WhereClause = createWhereClauseConstructor(this);\n            this.on(\"versionchange\", function (ev) {\n                if (ev.newVersion > 0)\n                    console.warn(\"Another connection wants to upgrade database '\".concat(_this.name, \"'. Closing db now to resume the upgrade.\"));\n                else\n                    console.warn(\"Another connection wants to delete database '\".concat(_this.name, \"'. Closing db now to resume the delete request.\"));\n                _this.close({ disableAutoOpen: false });\n            });\n            this.on(\"blocked\", function (ev) {\n                if (!ev.newVersion || ev.newVersion < ev.oldVersion)\n                    console.warn(\"Dexie.delete('\".concat(_this.name, \"') was blocked\"));\n                else\n                    console.warn(\"Upgrade '\".concat(_this.name, \"' blocked by other connection holding version \").concat(ev.oldVersion / 10));\n            });\n            this._maxKey = getMaxKey(options.IDBKeyRange);\n            this._createTransaction = function (mode, storeNames, dbschema, parentTransaction) { return new _this.Transaction(mode, storeNames, dbschema, _this._options.chromeTransactionDurability, parentTransaction); };\n            this._fireOnBlocked = function (ev) {\n                _this.on(\"blocked\").fire(ev);\n                connections\n                    .filter(function (c) { return c.name === _this.name && c !== _this && !c._state.vcFired; })\n                    .map(function (c) { return c.on(\"versionchange\").fire(ev); });\n            };\n            this.use(cacheExistingValuesMiddleware);\n            this.use(cacheMiddleware);\n            this.use(observabilityMiddleware);\n            this.use(virtualIndexMiddleware);\n            this.use(hooksMiddleware);\n            var vipDB = new Proxy(this, {\n                get: function (_, prop, receiver) {\n                    if (prop === '_vip')\n                        return true;\n                    if (prop === 'table')\n                        return function (tableName) { return vipify(_this.table(tableName), vipDB); };\n                    var rv = Reflect.get(_, prop, receiver);\n                    if (rv instanceof Table)\n                        return vipify(rv, vipDB);\n                    if (prop === 'tables')\n                        return rv.map(function (t) { return vipify(t, vipDB); });\n                    if (prop === '_createTransaction')\n                        return function () {\n                            var tx = rv.apply(this, arguments);\n                            return vipify(tx, vipDB);\n                        };\n                    return rv;\n                }\n            });\n            this.vip = vipDB;\n            addons.forEach(function (addon) { return addon(_this); });\n        }\n        Dexie.prototype.version = function (versionNumber) {\n            if (isNaN(versionNumber) || versionNumber < 0.1)\n                throw new exceptions.Type(\"Given version is not a positive number\");\n            versionNumber = Math.round(versionNumber * 10) / 10;\n            if (this.idbdb || this._state.isBeingOpened)\n                throw new exceptions.Schema(\"Cannot add version when database is open\");\n            this.verno = Math.max(this.verno, versionNumber);\n            var versions = this._versions;\n            var versionInstance = versions.filter(function (v) { return v._cfg.version === versionNumber; })[0];\n            if (versionInstance)\n                return versionInstance;\n            versionInstance = new this.Version(versionNumber);\n            versions.push(versionInstance);\n            versions.sort(lowerVersionFirst);\n            versionInstance.stores({});\n            this._state.autoSchema = false;\n            return versionInstance;\n        };\n        Dexie.prototype._whenReady = function (fn) {\n            var _this = this;\n            return (this.idbdb && (this._state.openComplete || PSD.letThrough || this._vip)) ? fn() : new DexiePromise(function (resolve, reject) {\n                if (_this._state.openComplete) {\n                    return reject(new exceptions.DatabaseClosed(_this._state.dbOpenError));\n                }\n                if (!_this._state.isBeingOpened) {\n                    if (!_this._state.autoOpen) {\n                        reject(new exceptions.DatabaseClosed());\n                        return;\n                    }\n                    _this.open().catch(nop);\n                }\n                _this._state.dbReadyPromise.then(resolve, reject);\n            }).then(fn);\n        };\n        Dexie.prototype.use = function (_a) {\n            var stack = _a.stack, create = _a.create, level = _a.level, name = _a.name;\n            if (name)\n                this.unuse({ stack: stack, name: name });\n            var middlewares = this._middlewares[stack] || (this._middlewares[stack] = []);\n            middlewares.push({ stack: stack, create: create, level: level == null ? 10 : level, name: name });\n            middlewares.sort(function (a, b) { return a.level - b.level; });\n            return this;\n        };\n        Dexie.prototype.unuse = function (_a) {\n            var stack = _a.stack, name = _a.name, create = _a.create;\n            if (stack && this._middlewares[stack]) {\n                this._middlewares[stack] = this._middlewares[stack].filter(function (mw) {\n                    return create ? mw.create !== create :\n                        name ? mw.name !== name :\n                            false;\n                });\n            }\n            return this;\n        };\n        Dexie.prototype.open = function () {\n            var _this = this;\n            return usePSD(globalPSD,\n            function () { return dexieOpen(_this); });\n        };\n        Dexie.prototype._close = function () {\n            this.on.close.fire(new CustomEvent('close'));\n            var state = this._state;\n            var idx = connections.indexOf(this);\n            if (idx >= 0)\n                connections.splice(idx, 1);\n            if (this.idbdb) {\n                try {\n                    this.idbdb.close();\n                }\n                catch (e) { }\n                this.idbdb = null;\n            }\n            if (!state.isBeingOpened) {\n                state.dbReadyPromise = new DexiePromise(function (resolve) {\n                    state.dbReadyResolve = resolve;\n                });\n                state.openCanceller = new DexiePromise(function (_, reject) {\n                    state.cancelOpen = reject;\n                });\n            }\n        };\n        Dexie.prototype.close = function (_a) {\n            var _b = _a === void 0 ? { disableAutoOpen: true } : _a, disableAutoOpen = _b.disableAutoOpen;\n            var state = this._state;\n            if (disableAutoOpen) {\n                if (state.isBeingOpened) {\n                    state.cancelOpen(new exceptions.DatabaseClosed());\n                }\n                this._close();\n                state.autoOpen = false;\n                state.dbOpenError = new exceptions.DatabaseClosed();\n            }\n            else {\n                this._close();\n                state.autoOpen = this._options.autoOpen ||\n                    state.isBeingOpened;\n                state.openComplete = false;\n                state.dbOpenError = null;\n            }\n        };\n        Dexie.prototype.delete = function (closeOptions) {\n            var _this = this;\n            if (closeOptions === void 0) { closeOptions = { disableAutoOpen: true }; }\n            var hasInvalidArguments = arguments.length > 0 && typeof arguments[0] !== 'object';\n            var state = this._state;\n            return new DexiePromise(function (resolve, reject) {\n                var doDelete = function () {\n                    _this.close(closeOptions);\n                    var req = _this._deps.indexedDB.deleteDatabase(_this.name);\n                    req.onsuccess = wrap(function () {\n                        _onDatabaseDeleted(_this._deps, _this.name);\n                        resolve();\n                    });\n                    req.onerror = eventRejectHandler(reject);\n                    req.onblocked = _this._fireOnBlocked;\n                };\n                if (hasInvalidArguments)\n                    throw new exceptions.InvalidArgument(\"Invalid closeOptions argument to db.delete()\");\n                if (state.isBeingOpened) {\n                    state.dbReadyPromise.then(doDelete);\n                }\n                else {\n                    doDelete();\n                }\n            });\n        };\n        Dexie.prototype.backendDB = function () {\n            return this.idbdb;\n        };\n        Dexie.prototype.isOpen = function () {\n            return this.idbdb !== null;\n        };\n        Dexie.prototype.hasBeenClosed = function () {\n            var dbOpenError = this._state.dbOpenError;\n            return dbOpenError && (dbOpenError.name === 'DatabaseClosed');\n        };\n        Dexie.prototype.hasFailed = function () {\n            return this._state.dbOpenError !== null;\n        };\n        Dexie.prototype.dynamicallyOpened = function () {\n            return this._state.autoSchema;\n        };\n        Object.defineProperty(Dexie.prototype, \"tables\", {\n            get: function () {\n                var _this = this;\n                return keys(this._allTables).map(function (name) { return _this._allTables[name]; });\n            },\n            enumerable: false,\n            configurable: true\n        });\n        Dexie.prototype.transaction = function () {\n            var args = extractTransactionArgs.apply(this, arguments);\n            return this._transaction.apply(this, args);\n        };\n        Dexie.prototype._transaction = function (mode, tables, scopeFunc) {\n            var _this = this;\n            var parentTransaction = PSD.trans;\n            if (!parentTransaction || parentTransaction.db !== this || mode.indexOf('!') !== -1)\n                parentTransaction = null;\n            var onlyIfCompatible = mode.indexOf('?') !== -1;\n            mode = mode.replace('!', '').replace('?', '');\n            var idbMode, storeNames;\n            try {\n                storeNames = tables.map(function (table) {\n                    var storeName = table instanceof _this.Table ? table.name : table;\n                    if (typeof storeName !== 'string')\n                        throw new TypeError(\"Invalid table argument to Dexie.transaction(). Only Table or String are allowed\");\n                    return storeName;\n                });\n                if (mode == \"r\" || mode === READONLY)\n                    idbMode = READONLY;\n                else if (mode == \"rw\" || mode == READWRITE)\n                    idbMode = READWRITE;\n                else\n                    throw new exceptions.InvalidArgument(\"Invalid transaction mode: \" + mode);\n                if (parentTransaction) {\n                    if (parentTransaction.mode === READONLY && idbMode === READWRITE) {\n                        if (onlyIfCompatible) {\n                            parentTransaction = null;\n                        }\n                        else\n                            throw new exceptions.SubTransaction(\"Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY\");\n                    }\n                    if (parentTransaction) {\n                        storeNames.forEach(function (storeName) {\n                            if (parentTransaction && parentTransaction.storeNames.indexOf(storeName) === -1) {\n                                if (onlyIfCompatible) {\n                                    parentTransaction = null;\n                                }\n                                else\n                                    throw new exceptions.SubTransaction(\"Table \" + storeName +\n                                        \" not included in parent transaction.\");\n                            }\n                        });\n                    }\n                    if (onlyIfCompatible && parentTransaction && !parentTransaction.active) {\n                        parentTransaction = null;\n                    }\n                }\n            }\n            catch (e) {\n                return parentTransaction ?\n                    parentTransaction._promise(null, function (_, reject) { reject(e); }) :\n                    rejection(e);\n            }\n            var enterTransaction = enterTransactionScope.bind(null, this, idbMode, storeNames, parentTransaction, scopeFunc);\n            return (parentTransaction ?\n                parentTransaction._promise(idbMode, enterTransaction, \"lock\") :\n                PSD.trans ?\n                    usePSD(PSD.transless, function () { return _this._whenReady(enterTransaction); }) :\n                    this._whenReady(enterTransaction));\n        };\n        Dexie.prototype.table = function (tableName) {\n            if (!hasOwn(this._allTables, tableName)) {\n                throw new exceptions.InvalidTable(\"Table \".concat(tableName, \" does not exist\"));\n            }\n            return this._allTables[tableName];\n        };\n        return Dexie;\n    }());\n\n    var symbolObservable = typeof Symbol !== \"undefined\" && \"observable\" in Symbol\n        ? Symbol.observable\n        : \"@@observable\";\n    var Observable =  (function () {\n        function Observable(subscribe) {\n            this._subscribe = subscribe;\n        }\n        Observable.prototype.subscribe = function (x, error, complete) {\n            return this._subscribe(!x || typeof x === \"function\" ? { next: x, error: error, complete: complete } : x);\n        };\n        Observable.prototype[symbolObservable] = function () {\n            return this;\n        };\n        return Observable;\n    }());\n\n    var domDeps;\n    try {\n        domDeps = {\n            indexedDB: _global.indexedDB || _global.mozIndexedDB || _global.webkitIndexedDB || _global.msIndexedDB,\n            IDBKeyRange: _global.IDBKeyRange || _global.webkitIDBKeyRange\n        };\n    }\n    catch (e) {\n        domDeps = { indexedDB: null, IDBKeyRange: null };\n    }\n\n    function liveQuery(querier) {\n        var hasValue = false;\n        var currentValue;\n        var observable = new Observable(function (observer) {\n            var scopeFuncIsAsync = isAsyncFunction(querier);\n            function execute(ctx) {\n                var wasRootExec = beginMicroTickScope();\n                try {\n                    if (scopeFuncIsAsync) {\n                        incrementExpectedAwaits();\n                    }\n                    var rv = newScope(querier, ctx);\n                    if (scopeFuncIsAsync) {\n                        rv = rv.finally(decrementExpectedAwaits);\n                    }\n                    return rv;\n                }\n                finally {\n                    wasRootExec && endMicroTickScope();\n                }\n            }\n            var closed = false;\n            var abortController;\n            var accumMuts = {};\n            var currentObs = {};\n            var subscription = {\n                get closed() {\n                    return closed;\n                },\n                unsubscribe: function () {\n                    if (closed)\n                        return;\n                    closed = true;\n                    if (abortController)\n                        abortController.abort();\n                    if (startedListening)\n                        globalEvents.storagemutated.unsubscribe(mutationListener);\n                },\n            };\n            observer.start && observer.start(subscription);\n            var startedListening = false;\n            var doQuery = function () { return execInGlobalContext(_doQuery); };\n            function shouldNotify() {\n                return obsSetsOverlap(currentObs, accumMuts);\n            }\n            var mutationListener = function (parts) {\n                extendObservabilitySet(accumMuts, parts);\n                if (shouldNotify()) {\n                    doQuery();\n                }\n            };\n            var _doQuery = function () {\n                if (closed ||\n                    !domDeps.indexedDB)\n                 {\n                    return;\n                }\n                accumMuts = {};\n                var subscr = {};\n                if (abortController)\n                    abortController.abort();\n                abortController = new AbortController();\n                var ctx = {\n                    subscr: subscr,\n                    signal: abortController.signal,\n                    requery: doQuery,\n                    querier: querier,\n                    trans: null\n                };\n                var ret = execute(ctx);\n                Promise.resolve(ret).then(function (result) {\n                    hasValue = true;\n                    currentValue = result;\n                    if (closed || ctx.signal.aborted) {\n                        return;\n                    }\n                    accumMuts = {};\n                    currentObs = subscr;\n                    if (!objectIsEmpty(currentObs) && !startedListening) {\n                        globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, mutationListener);\n                        startedListening = true;\n                    }\n                    execInGlobalContext(function () { return !closed && observer.next && observer.next(result); });\n                }, function (err) {\n                    hasValue = false;\n                    if (!['DatabaseClosedError', 'AbortError'].includes(err === null || err === void 0 ? void 0 : err.name)) {\n                        if (!closed)\n                            execInGlobalContext(function () {\n                                if (closed)\n                                    return;\n                                observer.error && observer.error(err);\n                            });\n                    }\n                });\n            };\n            setTimeout(doQuery, 0);\n            return subscription;\n        });\n        observable.hasValue = function () { return hasValue; };\n        observable.getValue = function () { return currentValue; };\n        return observable;\n    }\n\n    var Dexie = Dexie$1;\n    props(Dexie, __assign(__assign({}, fullNameExceptions), {\n        delete: function (databaseName) {\n            var db = new Dexie(databaseName, { addons: [] });\n            return db.delete();\n        },\n        exists: function (name) {\n            return new Dexie(name, { addons: [] }).open().then(function (db) {\n                db.close();\n                return true;\n            }).catch('NoSuchDatabaseError', function () { return false; });\n        },\n        getDatabaseNames: function (cb) {\n            try {\n                return getDatabaseNames(Dexie.dependencies).then(cb);\n            }\n            catch (_a) {\n                return rejection(new exceptions.MissingAPI());\n            }\n        },\n        defineClass: function () {\n            function Class(content) {\n                extend(this, content);\n            }\n            return Class;\n        }, ignoreTransaction: function (scopeFunc) {\n            return PSD.trans ?\n                usePSD(PSD.transless, scopeFunc) :\n                scopeFunc();\n        }, vip: vip, async: function (generatorFn) {\n            return function () {\n                try {\n                    var rv = awaitIterator(generatorFn.apply(this, arguments));\n                    if (!rv || typeof rv.then !== 'function')\n                        return DexiePromise.resolve(rv);\n                    return rv;\n                }\n                catch (e) {\n                    return rejection(e);\n                }\n            };\n        }, spawn: function (generatorFn, args, thiz) {\n            try {\n                var rv = awaitIterator(generatorFn.apply(thiz, args || []));\n                if (!rv || typeof rv.then !== 'function')\n                    return DexiePromise.resolve(rv);\n                return rv;\n            }\n            catch (e) {\n                return rejection(e);\n            }\n        },\n        currentTransaction: {\n            get: function () { return PSD.trans || null; }\n        }, waitFor: function (promiseOrFunction, optionalTimeout) {\n            var promise = DexiePromise.resolve(typeof promiseOrFunction === 'function' ?\n                Dexie.ignoreTransaction(promiseOrFunction) :\n                promiseOrFunction)\n                .timeout(optionalTimeout || 60000);\n            return PSD.trans ?\n                PSD.trans.waitFor(promise) :\n                promise;\n        },\n        Promise: DexiePromise,\n        debug: {\n            get: function () { return debug; },\n            set: function (value) {\n                setDebug(value);\n            }\n        },\n        derive: derive, extend: extend, props: props, override: override,\n        Events: Events, on: globalEvents, liveQuery: liveQuery, extendObservabilitySet: extendObservabilitySet,\n        getByKeyPath: getByKeyPath, setByKeyPath: setByKeyPath, delByKeyPath: delByKeyPath, shallowClone: shallowClone, deepClone: deepClone, getObjectDiff: getObjectDiff, cmp: cmp, asap: asap$1,\n        minKey: minKey,\n        addons: [],\n        connections: connections,\n        errnames: errnames,\n        dependencies: domDeps, cache: cache,\n        semVer: DEXIE_VERSION, version: DEXIE_VERSION.split('.')\n            .map(function (n) { return parseInt(n); })\n            .reduce(function (p, c, i) { return p + (c / Math.pow(10, i * 2)); }) }));\n    Dexie.maxKey = getMaxKey(Dexie.dependencies.IDBKeyRange);\n\n    if (typeof dispatchEvent !== 'undefined' && typeof addEventListener !== 'undefined') {\n        globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, function (updatedParts) {\n            if (!propagatingLocally) {\n                var event_1;\n                event_1 = new CustomEvent(STORAGE_MUTATED_DOM_EVENT_NAME, {\n                    detail: updatedParts\n                });\n                propagatingLocally = true;\n                dispatchEvent(event_1);\n                propagatingLocally = false;\n            }\n        });\n        addEventListener(STORAGE_MUTATED_DOM_EVENT_NAME, function (_a) {\n            var detail = _a.detail;\n            if (!propagatingLocally) {\n                propagateLocally(detail);\n            }\n        });\n    }\n    function propagateLocally(updateParts) {\n        var wasMe = propagatingLocally;\n        try {\n            propagatingLocally = true;\n            globalEvents.storagemutated.fire(updateParts);\n            signalSubscribersNow(updateParts, true);\n        }\n        finally {\n            propagatingLocally = wasMe;\n        }\n    }\n    var propagatingLocally = false;\n\n    var bc;\n    var createBC = function () { };\n    if (typeof BroadcastChannel !== 'undefined') {\n        createBC = function () {\n            bc = new BroadcastChannel(STORAGE_MUTATED_DOM_EVENT_NAME);\n            bc.onmessage = function (ev) { return ev.data && propagateLocally(ev.data); };\n        };\n        createBC();\n        if (typeof bc.unref === 'function') {\n            bc.unref();\n        }\n        globalEvents(DEXIE_STORAGE_MUTATED_EVENT_NAME, function (changedParts) {\n            if (!propagatingLocally) {\n                bc.postMessage(changedParts);\n            }\n        });\n    }\n\n    if (typeof addEventListener !== 'undefined') {\n        addEventListener('pagehide', function (event) {\n            if (!Dexie$1.disableBfCache && event.persisted) {\n                if (debug)\n                    console.debug('Dexie: handling persisted pagehide');\n                bc === null || bc === void 0 ? void 0 : bc.close();\n                for (var _i = 0, connections_1 = connections; _i < connections_1.length; _i++) {\n                    var db = connections_1[_i];\n                    db.close({ disableAutoOpen: false });\n                }\n            }\n        });\n        addEventListener('pageshow', function (event) {\n            if (!Dexie$1.disableBfCache && event.persisted) {\n                if (debug)\n                    console.debug('Dexie: handling persisted pageshow');\n                createBC();\n                propagateLocally({ all: new RangeSet(-Infinity, [[]]) });\n            }\n        });\n    }\n\n    function add(value) {\n        return new PropModification({ add: value });\n    }\n\n    function remove(value) {\n        return new PropModification({ remove: value });\n    }\n\n    function replacePrefix(a, b) {\n        return new PropModification({ replacePrefix: [a, b] });\n    }\n\n    DexiePromise.rejectionMapper = mapError;\n    setDebug(debug);\n\n    var namedExports = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        Dexie: Dexie$1,\n        liveQuery: liveQuery,\n        Entity: Entity,\n        cmp: cmp,\n        PropModification: PropModification,\n        replacePrefix: replacePrefix,\n        add: add,\n        remove: remove,\n        'default': Dexie$1,\n        RangeSet: RangeSet,\n        mergeRanges: mergeRanges,\n        rangesOverlap: rangesOverlap\n    });\n\n    __assign(Dexie$1, namedExports, { default: Dexie$1 });\n\n    return Dexie$1;\n\n}));\n//# sourceMappingURL=dexie.js.map\n","// Making the module version consumable via require - to prohibit\n// multiple occurrancies of the same module in the same app\n// (dual package hazard, https://nodejs.org/api/packages.html#dual-package-hazard)\nimport _Dexie from \"./dist/dexie.js\";\nconst DexieSymbol = Symbol.for(\"Dexie\");\nconst Dexie = globalThis[DexieSymbol] || (globalThis[DexieSymbol] = _Dexie);\nif (_Dexie.semVer !== Dexie.semVer) {\n    throw new Error(`Two different versions of Dexie loaded in the same app: ${_Dexie.semVer} and ${Dexie.semVer}`);\n}\nconst { liveQuery, mergeRanges, rangesOverlap, RangeSet, cmp, Entity,\n    PropModification, replacePrefix, add, remove,\n    DexieYProvider } = Dexie;\nexport { liveQuery, mergeRanges, rangesOverlap, RangeSet, cmp, Dexie, Entity,\n    PropModification, replacePrefix, add, remove,\n    DexieYProvider};\n    \nexport default Dexie;\n","/**\n * IndexedDB Schema for Gigwidget using Dexie\n *\n * This schema handles local persistence for:\n * - User data and preferences\n * - Song metadata and arrangements\n * - Snapshots for version history\n * - Spaces and memberships\n * - Sessions (ephemeral but cached for reconnection)\n * - Conflicts pending resolution\n *\n * Note: Yjs document state is stored via y-indexeddb provider,\n * not in this Dexie database.\n */\nimport Dexie, {} from 'dexie';\nimport { createAnonymousUser, createSpace, generateId, } from '@gigwidget/core';\n// ============================================================================\n// Database Class\n// ============================================================================\nexport class GigwidgetDatabase extends Dexie {\n    // Tables\n    users;\n    userPreferences;\n    songs;\n    arrangements;\n    snapshots;\n    spaces;\n    memberships;\n    sessions;\n    sessionParticipants;\n    syncStates;\n    conflicts;\n    // New tables (v2)\n    customInstruments;\n    localFingerings;\n    songMetadata;\n    songSets;\n    constructor() {\n        super('gigwidget');\n        this.version(1).stores({\n            // User tables\n            users: 'id, supabaseId, createdAt',\n            userPreferences: 'userId',\n            // Song tables\n            songs: 'id, ownerId, title, artist, visibility, updatedAt, *tags, *spaceIds',\n            arrangements: 'id, songId, instrument, updatedAt',\n            snapshots: 'id, songId, arrangementId, createdAt',\n            // Space tables\n            spaces: 'id, ownerId, type, name, createdAt',\n            memberships: 'id, userId, spaceId, role',\n            // Session tables (ephemeral but useful for reconnection)\n            sessions: 'id, hostId, type, createdAt, expiresAt',\n            sessionParticipants: '[sessionId+userId], sessionId, userId',\n            // Sync tables\n            syncStates: 'userId, syncStatus',\n            conflicts: 'id, songId, arrangementId, resolved, detectedAt',\n        });\n        // Version 2: Add custom instruments, local fingerings, song metadata, and song sets\n        this.version(2).stores({\n            // Existing tables (unchanged)\n            users: 'id, supabaseId, createdAt',\n            userPreferences: 'userId',\n            songs: 'id, ownerId, title, artist, visibility, updatedAt, *tags, *spaceIds',\n            arrangements: 'id, songId, instrument, updatedAt',\n            snapshots: 'id, songId, arrangementId, createdAt',\n            spaces: 'id, ownerId, type, name, createdAt',\n            memberships: 'id, userId, spaceId, role',\n            sessions: 'id, hostId, type, createdAt, expiresAt',\n            sessionParticipants: '[sessionId+userId], sessionId, userId',\n            syncStates: 'userId, syncStatus',\n            conflicts: 'id, songId, arrangementId, resolved, detectedAt',\n            // New tables\n            customInstruments: 'id, userId, name, baseType, isPublic',\n            localFingerings: 'id, userId, chordName, instrumentId, [userId+chordName+instrumentId]',\n            songMetadata: 'songId',\n            songSets: 'id, userId, parentSetId, name, isSetlist',\n        });\n    }\n}\n// ============================================================================\n// Singleton Instance\n// ============================================================================\nlet dbInstance = null;\nexport function getDatabase() {\n    if (!dbInstance) {\n        dbInstance = new GigwidgetDatabase();\n    }\n    return dbInstance;\n}\nexport async function closeDatabase() {\n    if (dbInstance) {\n        dbInstance.close();\n        dbInstance = null;\n    }\n}\n// ============================================================================\n// Database Initialization\n// ============================================================================\n/**\n * Initialize the database and create default user if needed.\n * Called on app startup.\n */\nexport async function initializeDatabase() {\n    const db = getDatabase();\n    // Check for existing user\n    const existingUsers = await db.users.toArray();\n    if (existingUsers.length > 0) {\n        // Return first (primary) user\n        return existingUsers[0];\n    }\n    // Create anonymous user\n    const user = createAnonymousUser();\n    // Create default preferences\n    const preferences = {\n        userId: user.id,\n        autoSaveInterval: 5000, // 5 seconds\n        snapshotRetention: 10, // Last 10 snapshots\n    };\n    // Create personal space\n    const personalSpace = createSpace(user.id, 'My Library', 'personal', {\n        description: 'Your personal song library',\n    });\n    // Create membership\n    const membership = {\n        id: generateId(),\n        userId: user.id,\n        spaceId: personalSpace.id,\n        role: 'owner',\n        joinedAt: new Date(),\n    };\n    // Create initial sync state\n    const syncState = {\n        userId: user.id,\n        lastLocalUpdate: new Date(),\n        pendingChanges: 0,\n        syncStatus: 'idle',\n    };\n    // Save all in transaction\n    await db.transaction('rw', [db.users, db.userPreferences, db.spaces, db.memberships, db.syncStates], async () => {\n        await db.users.add(user);\n        await db.userPreferences.add(preferences);\n        await db.spaces.add(personalSpace);\n        await db.memberships.add(membership);\n        await db.syncStates.add(syncState);\n    });\n    return user;\n}\n//# sourceMappingURL=schema.js.map","/**\n * Repository layer for database operations\n *\n * Provides typed, reusable data access patterns for all domain entities.\n */\nimport { getDatabase } from '../schema.js';\n// ============================================================================\n// Song Repository\n// ============================================================================\nexport const SongRepository = {\n    async getById(id) {\n        return getDatabase().songs.get(id);\n    },\n    async getByOwner(ownerId) {\n        return getDatabase().songs.where({ ownerId }).toArray();\n    },\n    async getBySpace(spaceId) {\n        return getDatabase().songs.filter((s) => s.spaceIds.includes(spaceId)).toArray();\n    },\n    async getByVisibility(visibility) {\n        return getDatabase().songs.where({ visibility }).toArray();\n    },\n    async search(query) {\n        const lowerQuery = query.toLowerCase();\n        return getDatabase().songs\n            .filter((song) => song.title.toLowerCase().includes(lowerQuery) ||\n            song.artist?.toLowerCase().includes(lowerQuery) ||\n            song.tags.some((tag) => tag.toLowerCase().includes(lowerQuery)))\n            .toArray();\n    },\n    async create(song) {\n        return getDatabase().songs.add(song);\n    },\n    async update(id, updates) {\n        return getDatabase().songs.update(id, { ...updates, updatedAt: new Date() });\n    },\n    async delete(id) {\n        const db = getDatabase();\n        await db.transaction('rw', [db.songs, db.arrangements, db.snapshots], async () => {\n            await db.snapshots.where({ songId: id }).delete();\n            await db.arrangements.where({ songId: id }).delete();\n            await db.songs.delete(id);\n        });\n    },\n    async addToSpace(songId, spaceId) {\n        const song = await this.getById(songId);\n        if (song && !song.spaceIds.includes(spaceId)) {\n            await this.update(songId, { spaceIds: [...song.spaceIds, spaceId] });\n        }\n    },\n    async removeFromSpace(songId, spaceId) {\n        const song = await this.getById(songId);\n        if (song) {\n            await this.update(songId, {\n                spaceIds: song.spaceIds.filter((id) => id !== spaceId),\n            });\n        }\n    },\n};\n// ============================================================================\n// Arrangement Repository\n// ============================================================================\nexport const ArrangementRepository = {\n    async getById(id) {\n        return getDatabase().arrangements.get(id);\n    },\n    async getBySong(songId) {\n        return getDatabase().arrangements.where({ songId }).toArray();\n    },\n    async getByInstrument(instrument) {\n        return getDatabase().arrangements.where({ instrument }).toArray();\n    },\n    async create(arrangement) {\n        return getDatabase().arrangements.add(arrangement);\n    },\n    async update(id, updates) {\n        return getDatabase().arrangements.update(id, { ...updates, updatedAt: new Date() });\n    },\n    async delete(id) {\n        const db = getDatabase();\n        await db.transaction('rw', [db.arrangements, db.snapshots], async () => {\n            await db.snapshots.where({ arrangementId: id }).delete();\n            await db.arrangements.delete(id);\n        });\n    },\n};\n// ============================================================================\n// Snapshot Repository\n// ============================================================================\nexport const SnapshotRepository = {\n    async getById(id) {\n        return getDatabase().snapshots.get(id);\n    },\n    async getByArrangement(arrangementId) {\n        return getDatabase().snapshots\n            .where({ arrangementId })\n            .reverse()\n            .sortBy('createdAt');\n    },\n    async create(snapshot) {\n        return getDatabase().snapshots.add(snapshot);\n    },\n    async delete(id) {\n        await getDatabase().snapshots.delete(id);\n    },\n    async pruneForArrangement(arrangementId, maxCount = 10) {\n        const snapshots = await this.getByArrangement(arrangementId);\n        if (snapshots.length > maxCount) {\n            const toDelete = snapshots.slice(maxCount);\n            const db = getDatabase();\n            await db.snapshots.bulkDelete(toDelete.map((s) => s.id));\n        }\n    },\n};\n// ============================================================================\n// Space Repository\n// ============================================================================\nexport const SpaceRepository = {\n    async getById(id) {\n        return getDatabase().spaces.get(id);\n    },\n    async getByOwner(ownerId) {\n        return getDatabase().spaces.where({ ownerId }).toArray();\n    },\n    async getByMember(userId) {\n        const memberships = await getDatabase().memberships.where({ userId }).toArray();\n        const spaceIds = memberships.map((m) => m.spaceId);\n        if (spaceIds.length === 0)\n            return [];\n        return getDatabase().spaces.where('id').anyOf(spaceIds).toArray();\n    },\n    async create(space) {\n        return getDatabase().spaces.add(space);\n    },\n    async update(id, updates) {\n        return getDatabase().spaces.update(id, { ...updates, updatedAt: new Date() });\n    },\n    async delete(id) {\n        const db = getDatabase();\n        await db.transaction('rw', [db.spaces, db.memberships], async () => {\n            await db.memberships.where({ spaceId: id }).delete();\n            await db.spaces.delete(id);\n        });\n    },\n};\n// ============================================================================\n// Membership Repository\n// ============================================================================\nexport const MembershipRepository = {\n    async getByUser(userId) {\n        return getDatabase().memberships.where({ userId }).toArray();\n    },\n    async getBySpace(spaceId) {\n        return getDatabase().memberships.where({ spaceId }).toArray();\n    },\n    async get(userId, spaceId) {\n        return getDatabase().memberships\n            .where({ userId })\n            .filter((m) => m.spaceId === spaceId)\n            .first();\n    },\n    async create(membership) {\n        return getDatabase().memberships.add(membership);\n    },\n    async updateRole(userId, spaceId, role) {\n        const membership = await this.get(userId, spaceId);\n        if (membership) {\n            await getDatabase().memberships.update(membership.id, { role });\n        }\n    },\n    async delete(userId, spaceId) {\n        const membership = await this.get(userId, spaceId);\n        if (membership) {\n            await getDatabase().memberships.delete(membership.id);\n        }\n    },\n};\n// ============================================================================\n// Session Repository\n// ============================================================================\nexport const SessionRepository = {\n    async getById(id) {\n        return getDatabase().sessions.get(id);\n    },\n    async getByHost(hostId) {\n        return getDatabase().sessions.where({ hostId }).toArray();\n    },\n    async getActive() {\n        const now = new Date();\n        return getDatabase().sessions\n            .filter((s) => !s.expiresAt || s.expiresAt > now)\n            .toArray();\n    },\n    async create(session) {\n        return getDatabase().sessions.add(session);\n    },\n    async delete(id) {\n        const db = getDatabase();\n        await db.transaction('rw', [db.sessions, db.sessionParticipants], async () => {\n            await db.sessionParticipants.where({ sessionId: id }).delete();\n            await db.sessions.delete(id);\n        });\n    },\n    async cleanupExpired() {\n        const now = new Date();\n        const expired = await getDatabase().sessions\n            .filter((s) => s.expiresAt !== undefined && s.expiresAt <= now)\n            .toArray();\n        for (const session of expired) {\n            await this.delete(session.id);\n        }\n        return expired.length;\n    },\n};\n// ============================================================================\n// Conflict Repository\n// ============================================================================\nexport const ConflictRepository = {\n    async getById(id) {\n        return getDatabase().conflicts.get(id);\n    },\n    async getPending() {\n        return getDatabase().conflicts.filter((c) => !c.resolved).toArray();\n    },\n    async getBySong(songId) {\n        return getDatabase().conflicts.where({ songId }).toArray();\n    },\n    async create(conflict) {\n        return getDatabase().conflicts.add(conflict);\n    },\n    async resolve(id, resolution) {\n        await getDatabase().conflicts.update(id, { resolved: true, resolution });\n    },\n    async delete(id) {\n        await getDatabase().conflicts.delete(id);\n    },\n    async cleanupResolved() {\n        const resolved = await getDatabase().conflicts.filter((c) => c.resolved).toArray();\n        await getDatabase().conflicts.bulkDelete(resolved.map((c) => c.id));\n        return resolved.length;\n    },\n};\n// ============================================================================\n// Custom Instrument Repository\n// ============================================================================\nexport const CustomInstrumentRepository = {\n    async getById(id) {\n        return getDatabase().customInstruments.get(id);\n    },\n    async getByUser(userId) {\n        return getDatabase().customInstruments.where({ userId }).toArray();\n    },\n    async getPublic() {\n        return getDatabase().customInstruments.where({ isPublic: 1 }).toArray();\n    },\n    async getByBaseType(baseType) {\n        return getDatabase().customInstruments.where({ baseType }).toArray();\n    },\n    async create(instrument) {\n        return getDatabase().customInstruments.add(instrument);\n    },\n    async update(id, updates) {\n        return getDatabase().customInstruments.update(id, { ...updates, updatedAt: new Date() });\n    },\n    async delete(id) {\n        await getDatabase().customInstruments.delete(id);\n    },\n};\n// ============================================================================\n// Local Fingering Repository\n// ============================================================================\nexport const LocalFingeringRepository = {\n    async getById(id) {\n        return getDatabase().localFingerings.get(id);\n    },\n    async getByUser(userId) {\n        return getDatabase().localFingerings.where({ userId }).toArray();\n    },\n    async getByChord(userId, chordName) {\n        return getDatabase().localFingerings\n            .where({ userId })\n            .filter((f) => f.chordName === chordName)\n            .toArray();\n    },\n    async getByInstrument(userId, instrumentId) {\n        return getDatabase().localFingerings\n            .where({ userId })\n            .filter((f) => f.instrumentId === instrumentId)\n            .toArray();\n    },\n    async getDefault(userId, chordName, instrumentId) {\n        return getDatabase().localFingerings\n            .where('[userId+chordName+instrumentId]')\n            .equals([userId, chordName, instrumentId])\n            .filter((f) => f.isDefault)\n            .first();\n    },\n    async create(fingering) {\n        return getDatabase().localFingerings.add(fingering);\n    },\n    async update(id, updates) {\n        return getDatabase().localFingerings.update(id, updates);\n    },\n    async delete(id) {\n        await getDatabase().localFingerings.delete(id);\n    },\n    async clearDefaults(userId, chordName, instrumentId) {\n        const fingerings = await getDatabase().localFingerings\n            .where('[userId+chordName+instrumentId]')\n            .equals([userId, chordName, instrumentId])\n            .toArray();\n        for (const f of fingerings) {\n            if (f.isDefault) {\n                await getDatabase().localFingerings.update(f.id, { isDefault: false });\n            }\n        }\n    },\n    async setDefault(id, userId, chordName, instrumentId) {\n        // Clear existing defaults first\n        await this.clearDefaults(userId, chordName, instrumentId);\n        // Set new default\n        await getDatabase().localFingerings.update(id, { isDefault: true });\n    },\n};\n// ============================================================================\n// Song Metadata Repository\n// ============================================================================\nexport const SongMetadataRepository = {\n    async getBySong(songId) {\n        return getDatabase().songMetadata.get(songId);\n    },\n    async create(metadata) {\n        return getDatabase().songMetadata.add(metadata);\n    },\n    async update(songId, updates) {\n        return getDatabase().songMetadata.update(songId, updates);\n    },\n    async upsert(metadata) {\n        await getDatabase().songMetadata.put(metadata);\n    },\n    async delete(songId) {\n        await getDatabase().songMetadata.delete(songId);\n    },\n    async incrementPlayCount(songId) {\n        const metadata = await this.getBySong(songId);\n        if (metadata) {\n            await this.update(songId, {\n                playCount: metadata.playCount + 1,\n                lastPlayedAt: new Date(),\n            });\n        }\n        else {\n            await this.create({\n                songId,\n                notes: '',\n                playCount: 1,\n                lastPlayedAt: new Date(),\n            });\n        }\n    },\n};\n// ============================================================================\n// Song Set Repository\n// ============================================================================\nexport const SongSetRepository = {\n    async getById(id) {\n        return getDatabase().songSets.get(id);\n    },\n    async getByUser(userId) {\n        return getDatabase().songSets.where({ userId }).toArray();\n    },\n    async getRootSets(userId) {\n        return getDatabase().songSets\n            .where({ userId })\n            .filter((s) => !s.parentSetId)\n            .toArray();\n    },\n    async getChildSets(parentSetId) {\n        return getDatabase().songSets.where({ parentSetId }).toArray();\n    },\n    async getSetlists(userId) {\n        return getDatabase().songSets\n            .where({ userId })\n            .filter((s) => s.isSetlist)\n            .toArray();\n    },\n    async create(set) {\n        return getDatabase().songSets.add(set);\n    },\n    async update(id, updates) {\n        return getDatabase().songSets.update(id, { ...updates, updatedAt: new Date() });\n    },\n    async delete(id) {\n        // Also delete any child sets\n        const children = await this.getChildSets(id);\n        for (const child of children) {\n            await this.delete(child.id);\n        }\n        await getDatabase().songSets.delete(id);\n    },\n    async addSong(setId, songId) {\n        const set = await this.getById(setId);\n        if (set && !set.songIds.includes(songId)) {\n            await this.update(setId, { songIds: [...set.songIds, songId] });\n        }\n    },\n    async removeSong(setId, songId) {\n        const set = await this.getById(setId);\n        if (set) {\n            await this.update(setId, {\n                songIds: set.songIds.filter((id) => id !== songId),\n            });\n        }\n    },\n    async reorderSongs(setId, songIds) {\n        await this.update(setId, { songIds });\n    },\n    async moveSong(setId, fromIndex, toIndex) {\n        const set = await this.getById(setId);\n        if (!set)\n            return;\n        const songIds = [...set.songIds];\n        const [removed] = songIds.splice(fromIndex, 1);\n        songIds.splice(toIndex, 0, removed);\n        await this.update(setId, { songIds });\n    },\n};\n//# sourceMappingURL=index.js.map"],"names":["global","factory","module","this","extendStatics","d","b","p","__extends","__","__assign","s","i","n","__spreadArray","to","from","pack","l","ar","_global","keys","isArray","extend","obj","extension","key","getProto","_hasOwn","hasOwn","prop","props","proto","setProp","defineProperty","functionOrGetSet","options","derive","Child","Parent","getOwnPropertyDescriptor","getPropertyDescriptor","pd","_slice","slice","args","start","end","override","origFunc","overridedFactory","assert","asap$1","fn","arrayToObject","array","extractor","result","item","nameAndValue","getByKeyPath","keyPath","rv","val","period","innerObj","setByKeyPath","value","currentKeyPath","remainingKeyPath","delByKeyPath","kp","shallowClone","m","concat","flatten","a","intrinsicTypeNames","num","t","intrinsicTypes","cloneSimpleObjectTree","o","k","v","objectIsEmpty","circularRefs","deepClone","any","innerDeepClone","x","toString","toStringTag","iteratorSymbol","getIteratorOf","delArrayItem","NO_CHAR_ARRAY","getArrayOf","arrayLike","it","isAsyncFunction","dexieErrorNames","idbDomErrorNames","errorList","defaultTexts","DexieError","name","msg","getMultiErrorMessage","failures","ModifyError","successCount","failedKeys","BulkError","pos","errnames","BaseException","exceptions","fullName","msgOrInner","inner","exceptionMap","mapError","domError","message","fullNameExceptions","nop","mirror","pureFunctionChain","f1","f2","callBoth","on1","on2","hookCreatingChain","res","onsuccess","onerror","res2","hookDeletingChain","hookUpdatingChain","modifications","reverseStoppableEventChain","promisableChain","thiz","debug","setDebug","filter","INTERNAL","ZONE_ECHO_LIMIT","_a$1","globalP","nativeP","resolvedNativePromise","nativePromiseProto","resolvedGlobalPromise","nativePromiseThen","NativePromise","patchGlobalPromise","schedulePhysicalTick","physicalTick","asap","callback","microtickQueue","needsNewPhysicalTick","isOutsideMicroTick","unhandledErrors","rejectingErrors","rejectionMapper","globalPSD","PSD","numScheduledCalls","tickFinalizers","DexiePromise","psd","handleRejection","executePromiseTask","thenProp","microTaskId","totalEchoes","then","onFulfilled","onRejected","_this","possibleAwait","cleanup","decrementExpectedAwaits","resolve","reject","propagateToListener","Listener","nativeAwaitCompatibleWrap","type","handler","err","PromiseReject","onFinally","ms","handle","snapShot","zone","values","onPossibleParallellAsync","remaining","newScope","usePSD","zoneProps","run_at_end_of_this_or_next_physical_tick","possiblePromises","results","reason","failure","promise","shouldExecuteTick","beginMicroTickScope","propagateAllListeners","endMicroTickScope","ex","addPossiblyUnhandledError","listeners","len","finalizePhysicalTick","listener","cb","callListener","ret","markErrorAsHandled","e","wasRootExec","callbacks","unhandledErrs","finalizers","finalizer","wrap","errorCatcher","outerScope","switchToZone","task","taskCounter","zoneStack","zoneEchoes","zone_id_counter","a1","a2","parent","incrementExpectedAwaits","possiblePromise","rejection","zoneEnterEcho","targetZone","zoneLeaveEcho","bEnteringZone","currentZone","GlobalPromise","targetEnv","a3","outerZone","execInGlobalContext","tempTransaction","db","mode","storeNames","trans","DEXIE_VERSION","maxString","minKey","INVALID_KEY_ARGUMENT","STRING_EXPECTED","connections","DBNAMES_DB","READONLY","READWRITE","combine","filter1","filter2","AnyRange","workaroundForUndefinedPrimKey","Entity","cmp","ta","tb","compareUint8Arrays","getUint8Array","compareArrays","al","bl","tsTag","builtInDeletionTrigger","table","yProps","_","_a","updatesTable","PropModification","spec","term","subtrahend_1","prefixToReplace","applyUpdateSpec","changes","keyPaths","numKeys","anythingModified","origValue","Table","writeLocked","tableName","checkTableInTransaction","keyOrCrit","indexOrCrit","compoundIndex","ix","keyPathsInValidOrder","idxByName","equals","prevIndex","prevFilterFn","index","idx","filterFunction","thenShortcut","offset","numRows","constructor","_super","class_1","inheritedProps","propName","readHook","Class","content","auto","objToAdd","lastResult","existing","keyOrObject","objects","keysOrOptions","wantResults","numObjects","objectsToAdd","numFailures","objectsToPut","keysAndChanges","coreTable","entry","changeSpecs","offsetMap","objs","resultKeys","resultObjs","_i","_b","numEntries","mappedOffset","Events","ctx","evs","eventName","subscriber","add","chainFunction","defaultFunction","addConfiguredEvents","context","cfg","makeClassConstructor","prototype","createTableConstructor","tableSchema","isPlainKeyRange","ignoreLimitFilter","addFilter","addReplayFilter","isLimitFilter","curr","addMatchFilter","getIndexOrStore","coreSchema","openCursor","iter","coreTrans","set_1","union","cursor","advance","primaryKey","iterate","cursorPromise","valueMapper","mappedFn","c","wrappedFn","advancer","Collection","count","parts","lastPart","lastIndex","getval","order","sorter","aVal","bVal","valueMapper_1","a_1","offsetLeft","rowsLeft","bIncludeStopEntry","indexName","set","strKey","found","modifyer","outbound","extractKey","limit","modifyChunkSize","totalFailures","applyMutateResult","expectedCount","isUnconditionalDelete","deleteCallback","criteria","nextChunk","keysInChunk","addValues","putValues","putKeys","deleteKeys","ctx_1","range","coreRange","createCollectionConstructor","whereClause","keyRangeGenerator","keyRange","error","whereCtx","readingHook","simpleCompare","simpleCompareReverse","fail","collectionOrWhereClause","T","collection","WhereClause","emptyCollection","rangeEqual","upperFactory","dir","lowerFactory","nextCasing","lowerKey","upperNeedle","lowerNeedle","length","llp","lwrKeyChar","addIgnoreCaseAlgorithm","match","needles","suffix","upper","lower","compare","upperNeedles","lowerNeedles","direction","nextKeySuffix","needlesLen","initDirection","needleBounds","needle","nb","createRange","firstPossibleNeedle","lowestPossibleCasing","casing","lowerOpen","upperOpen","includeLower","includeUpper","str","ranges","ascending","descending","min","max","includeLowers","includeUppers","addRange","newRange","sortDirection","rangeSorter","rangePos","keyIsBeyondCurrentEntry","keyIsBeforeCurrentEntry","keyWithinCurrentRange","checkKey","createWhereClauseConstructor","orCollection","eventRejectHandler","event","preventDefault","DEXIE_STORAGE_MUTATED_EVENT_NAME","STORAGE_MUTATED_DOM_EVENT_NAME","globalEvents","Transaction","fnAndPSD","idbtrans","idbdb","dbOpenError","ev","bWriteLock","promiseLike","root","store","spin","currentWaitPromise","memoizedTables","transactionBoundTable","createTransactionConstructor","dbschema","chromeTransactionDurability","storeName","wasActive","createIndexSpec","unique","multi","compound","isPrimKey","nameFromKeyPath","createTableSchema","primKey","indexes","safariMultiStoreFix","getMaxKey","IdbKeyRange","getKeyExtractor","getSinglePathKeyExtractor","split","arrayify","_id_counter","getKeyPathAlias","createDBCore","tmpTrans","extractSchema","tables","autoIncrement","indexByKeyPath","multiEntry","makeIDBKeyRange","idbRange","createDbCoreTable","mutate","isAddOrPut","req","reqs","errorHandler","args1","args2","done","query","reverse","source","_cursorContinue","_cursorContinuePrimaryKey","_cursorAdvance","doThrowCursorIsNotStarted","doThrowCursorIsStopped","gotOne","iterationPromise","resolveIteration","rejectIteration","guardedCallback","hasGetAll","request","nonInfinitLimit","idbKeyRange","count_1","req_1","result_1","keyCount","callbackCount","successHandler","schema","tableMap","createMiddlewareStack","stackImpl","middlewares","down","create","createMiddlewareStacks","IDBKeyRange","dbcore","generateMiddlewareStacks","stacks","tbl","setApiOnPlace","tableNames","propDesc","removeTablesApi","lowerVersionFirst","runUpgraders","oldVersion","idbUpgradeTrans","globalSchema","parseIndexSyntax","rejectTransaction","transless","createTable","getExistingVersion","updateTablesAndIndexes","patchCurrentVersion","createMissingTables","buildGlobalSchema","adjustToExistingIndexNames","diff","getSchemaDiff","_loop_1","tableChange","addIndex","state_1","metaVersion","queue","versions","versToRun","version","oldSchema","newSchema","tuple","change","store_1","idxName","contentUpgrade","upgradeSchema_1","contentUpgradeIsAsync_1","returnValue_1","promiseFollowed","decrementor","deleteRemovedTables","runQueue","oldDef","newDef","oldIndexes","newIndexes","oldIdx","newIdx","dbStoreNames","j","idbindex","readGlobalSchema","verifyInstalledSchema","installedSchema","ch","dexieName","indexSpec","primKeyAndIndexes","indexNum","typeSplit","Version","stores","outSchema","tblSchema","storesSpec","upgradeFunction","createVersionConstructor","versionNumber","getDbNamesTable","indexedDB","dbNamesDB","Dexie$1","hasDatabasesNative","getDatabaseNames","infos","info","_onDatabaseCreated","_onDatabaseDeleted","vip","idbReady","isSafari","intervalId","tryIdb","isEmptyRange","node","RangeSet","fromOrTree","rangeSet","mergeRanges","getRangeSetIterator","target","left","right","rebalance","rightWasCutOff","newSet","_addRangeSet","r","rangesOverlap","rangeSet1","rangeSet2","i1","nextResult1","i2","nextResult2","state","keyProvided","rootClone","oldRootRight","computeDepth","extendObservabilitySet","part","obsSetsOverlap","os1","os2","cache","unsignaledParts","isTaskEnqueued","signalSubscribersLazily","optimistic","signalSubscribersNow","updatedParts","deleteAffectedCacheEntries","queriesToSignal","tblCache","collectTableSubscribers","dbName","requery","outQueriesToSignal","updatedEntryLists","entries","filteredEntries","_c","entries_1","_d","updatedEntryLists_1","_e","dexieOpen","openCanceller","nativeVerToOpen","schemaPatchMode","throwIfCancelled","resolveDbReady","upgradeTransaction","wasCreated","tryOpenDB","delreq","oldVer","objectStoreNames","fireRemainders","remainders_1","everything_1","awaitIterator","iterator","callNext","doThrow","onSuccess","step","onError","getNext","next","extractTransactionArgs","_tableArgs_","scopeFunc","enterTransactionScope","parentTransaction","scopeFuncIsAsync","returnValue","pad","createVirtualIndexMiddleware","indexLookup","allVirtualIndexes","addVirtualIndexes","keyTail","lowLevelIndex","keyPathAlias","indexList","keyLength","isVirtual","virtualIndex","virtualKeyPath","findBestIndex","translateRange","translateRequest","createVirtualCursor","_continue","virtualCursor","virtualIndexMiddleware","getObjectDiff","prfx","ap","bp","apTypeName","bpTypeName","getEffectiveKeys","hooksMiddleware","downCore","downTable","tableMiddleware","dxTrans","deleting","creating","updating","addPutOrDelete","deleteRange","getExistingValues","existingValues","contexts","existingValue","generatedPrimaryKey","objectDiff","additionalChanges_1","requestedValue_1","deleteNextChunk","effectiveKeys","getFromTransactionCache","clone","cacheExistingValuesMiddleware","core","cachedResult","isCachableContext","isCachableRequest","observabilityMiddleware","FULL_RANGE","indexesWithAutoIncPK","tableClone","mutatedParts","getRangeSet","pkRangeSet","delsRangeSet","id","newObjs","oldCache","oldObjs","trackAffectedIndexes","idxVals","pkPos","getRange","readSubscribers","method","subscr","isLiveQuery","cachable","obsSet","pkRangeSet_1","delsRangeSet_1","queriedIndex","queriedRanges","keysPromise_1","resultingKeys","pKeys","cursor_1","wantValues_1","pkey","addAffectedIndex","addKeyOrKeys","oldKey","newKey","adjustOptimisticFromFailures","numBulkOps","isAboveLower","isBelowUpper","isWithinRange","applyOptimisticOps","ops","cacheEntry","immutable","queryRange","extractPrimKey","extractIndex","extractLowLevelIndex","finalResult","op","modifedResult","includedValues","includedPKs","pk","existingKeys_1","keySet_1","keysToDelete_1","range_1","areRangesEqual","r1","r2","compareLowers","lower1","lower2","lowerOpen1","lowerOpen2","compareUppers","upper1","upper2","upperOpen1","upperOpen2","isSuperRange","findCompatibleQuery","queries","equalEntry","superEntry","countQuery","subscribeToCacheEntry","container","signal","enqueForDeletion","cacheMiddleware","coreMW","ac_1","endTransaction","wasCommitted","affectedSubscribers_1","stores_1","_f","_g","_h","freezeResults","modRes","tableMW","reqWithResolvedKeys","valueWithKey","adjustedReq","exactMatch","vipify","vipDb","receiver","Dexie","deps","addons","subscribe","bSticky","db_1","unsubscribe","vipDB","tx","addon","versionInstance","stack","level","mw","disableAutoOpen","closeOptions","hasInvalidArguments","doDelete","onlyIfCompatible","idbMode","enterTransaction","symbolObservable","Observable","complete","domDeps","liveQuery","querier","hasValue","currentValue","observable","observer","execute","closed","abortController","accumMuts","currentObs","subscription","startedListening","mutationListener","doQuery","_doQuery","shouldNotify","databaseName","generatorFn","promiseOrFunction","optionalTimeout","propagatingLocally","event_1","detail","propagateLocally","updateParts","wasMe","bc","createBC","changedParts","connections_1","remove","replacePrefix","namedExports","DexieSymbol","_Dexie","DexieYProvider","GigwidgetDatabase","dbInstance","getDatabase","initializeDatabase","existingUsers","user","createAnonymousUser","preferences","personalSpace","createSpace","membership","generateId","syncState","SongRepository","ownerId","spaceId","visibility","lowerQuery","song","tag","updates","songId","ArrangementRepository","instrument","arrangement","CustomInstrumentRepository","userId","baseType","SongSetRepository","parentSetId","children","child","setId","songIds","fromIndex","toIndex","removed"],"mappings":"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","x_google_ignoreList":[0,1]}